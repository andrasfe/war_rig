{
  "header": {
    "program_id": "DBPAUTP0",
    "file_name": "jcl/DBPAUTP0.jcl",
    "file_type": "JCL",
    "analyzed_by": "WAR_RIG",
    "analyzed_at": "2026-01-26T15:10:30.123190",
    "iteration_count": 1,
    "final_status": null
  },
  "purpose": {
    "summary": "This JCL defines a batch job that first deletes any existing output dataset AWS.M2.CARDDEMO.IMSDATA.DBPAUTP0 and then executes the IMS unload utility DFSRRC00 to unload the entire contents of the IMS database DBD DBPAUTP0 into a new sequential VB dataset. The unload uses the user exit DFSURGU0 and conditional segment activation via SBPARM ACTIV=COND. It is part of the CardDemo application for IMS data management.",
    "business_context": "Supports IMS database maintenance for the CardDemo application by providing an unload of DBPAUTP0 dataset, likely for backup, migration, or demo purposes.",
    "program_type": "BATCH",
    "citations": [
      1,
      7,
      15,
      16,
      25,
      35,
      46
    ]
  },
  "inputs": [
    {
      "name": "DBPAUTP0",
      "io_type": "IMS_SEGMENT",
      "description": "IMS database (DBD) from which all segments are unloaded unconditionally using DFSRRC00 utility",
      "copybook": null,
      "citation": [
        16
      ]
    },
    {
      "name": "DDPAUTP0",
      "io_type": "FILE_SEQUENTIAL",
      "description": "IMS authorization database library OEM.IMS.IMSP.PAUTHDB required by the unload utility",
      "copybook": null,
      "citation": [
        31
      ]
    },
    {
      "name": "DDPAUTX0",
      "io_type": "FILE_SEQUENTIAL",
      "description": "IMS authorization database index OEM.IMS.IMSP.PAUTHDBX required by the unload utility",
      "copybook": null,
      "citation": [
        32
      ]
    },
    {
      "name": "DFSCTL",
      "io_type": "PARAMETER",
      "description": "Inline control parameters for IMS utility including SBPARM ACTIV=COND for conditional segment activation",
      "copybook": null,
      "citation": [
        34,
        35
      ]
    },
    {
      "name": "STEPLIB/DFSRESLB/IMS",
      "io_type": "OTHER",
      "description": "Load libraries and IMS resource libraries (SDFSRESL, LOADLIB, PSBLIB, DBDLIB) required to execute DFSRRC00",
      "copybook": null,
      "citation": [
        18,
        19,
        20,
        21,
        22
      ]
    }
  ],
  "outputs": [
    {
      "name": "DFSURGU1",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Sequential VB dataset containing the unloaded IMS database segments from DBPAUTP0, cataloged for reuse",
      "copybook": null,
      "citation": [
        25
      ]
    },
    {
      "name": "SYSUT1 (STEPDEL)",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Existing dataset AWS.M2.CARDDEMO.IMSDATA.DBPAUTP0 targeted for deletion prior to new unload",
      "copybook": null,
      "citation": [
        9
      ]
    },
    {
      "name": "SYSPRINT",
      "io_type": "REPORT",
      "description": "Utility print output routed to SYSOUT=* for both steps",
      "copybook": null,
      "citation": [
        8,
        23
      ]
    }
  ],
  "called_programs": [],
  "calling_context": {
    "called_by": [],
    "entry_points": [],
    "linkage_section": []
  },
  "business_rules": [
    {
      "rule_id": "BR001",
      "description": "Delete existing output dataset before unload to ensure clean slate",
      "logic_summary": "IEFBR14 with DISP=(MOD,DELETE) on SYSUT1",
      "conditions": [
        "Prior run may have created the dataset"
      ],
      "citation": [
        7,
        9,
        10
      ]
    },
    {
      "rule_id": "BR002",
      "description": "Unload IMS database unconditionally with conditional segment activation",
      "logic_summary": "DFSRRC00 PARM=(ULU,DFSURGU0,DBPAUTP0) and DFSCTL SBPARM ACTIV=COND",
      "conditions": [
        "ULU for unconditional unload",
        "ACTIV=COND for segment selection"
      ],
      "citation": [
        16,
        35
      ]
    }
  ],
  "data_flow": {
    "reads_from": [
      {
        "source": "DBPAUTP0",
        "fields_used": [
          "ALL SEGMENTS"
        ],
        "citation": [
          16
        ]
      },
      {
        "source": "DDPAUTP0/DDPAUTX0",
        "fields_used": [
          "AUTHORIZATION DATA"
        ],
        "citation": [
          31,
          32
        ]
      }
    ],
    "writes_to": [
      {
        "destination": "DFSURGU1",
        "fields_written": [
          "UNLOADED SEGMENTS"
        ],
        "citation": [
          25
        ]
      }
    ],
    "transforms": [
      {
        "input_field": "IMS DB SEGMENTS",
        "output_field": "SEQUENTIAL RECORDS",
        "transformation_description": "Unconditional unload of database segments into VB sequential file format using DFSURGU0 user routine",
        "citation": [
          16
        ]
      }
    ]
  },
  "copybooks_used": [],
  "paragraphs": [
    {
      "paragraph_name": "STEPDEL",
      "summary": null,
      "purpose": "This step serves as the cleanup phase of the job, ensuring no residual output dataset from prior executions interferes with the new unload. It executes the utility program IEFBR14, which performs dataset management operations. The primary input is the DD SYSUT1 pointing to AWS.M2.CARDDEMO.IMSDATA.DBPAUTP0 with DISP=(MOD,DELETE), reading catalog information to check existence. It produces the deletion of the dataset if present, preparing for the subsequent UNLOAD step. There is no complex business logic; it unconditionally attempts deletion per JCL disposition. No validations or conditions are checked beyond standard JCL catalog access. Error handling relies on JCL defaults: if deletion fails (e.g., not found), the step completes with RC=0; abends go to job-level handling. SYSPRINT captures any messages. This step does not call other paragraphs or programs but precedes UNLOAD in job flow. Its role ensures idempotency of the unload process.",
      "called_by": [],
      "calls": [],
      "citation": [
        7,
        10
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "UNLOAD",
      "summary": null,
      "purpose": "This is the core processing step that performs the IMS database unload operation using DFSRRC00, the standard IMS utility for resource control. It consumes the IMS database DBPAUTP0 specified in PARM=(ULU,DFSURGU0,DBPAUTP0), reading all segments unconditionally (ULU) with the DFSURGU0 user routine for custom processing. Additional inputs include authorization libraries (DDPAUTP0, DDPAUTX0), control parameters (DFSCTL with SBPARM ACTIV=COND for conditional activation), and required IMS libraries via STEPLIB/DFSRESLB/IMS. It produces the output dataset DFSURGU1 as a new cataloged VB sequential file containing the unloaded segments. Business logic is driven by the utility: unconditional unload scans the database, applies conditional activation, and formats records per RECFM=VB LRECL=27990. No explicit decisions in JCL, but utility handles segment selection and errors internally. Error handling uses SYSUDUMP for dumps, RECON1-3 for recovery, and standard IMS return codes; JCL DUMMY for work/sort files avoids spills. SYSPRINT logs utility output. This step does not call subordinate paragraphs but relies on IMS internal processing. It follows STEPDEL and completes the job's primary objective of data unload.",
      "called_by": [],
      "calls": [],
      "citation": [
        15,
        45
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    }
  ],
  "error_handling": [
    {
      "condition": "Dataset deletion failure or IMS utility abend",
      "action": "Relies on JCL defaults, SYSUDUMP for diagnostics, RECON files for IMS recovery",
      "citation": [
        36,
        40,
        41,
        42
      ]
    }
  ],
  "sql_operations": [],
  "cics_operations": [],
  "open_questions": [
    {
      "question": "Exact function of DFSURGU0 user routine",
      "context": "PARM specifies it but source code not provided; assumed standard unload handler",
      "suggestion": "Review DFSURGU0 source or IMS documentation for custom logic"
    },
    {
      "question": "Specific segments unloaded under ACTIV=COND",
      "context": "SBPARM ACTIV=COND implies conditional but no details in JCL",
      "suggestion": "Check DBD DBPAUTP0 definition or DFSCTL full parms"
    }
  ]
}