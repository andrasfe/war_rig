{
  "header": {
    "program_id": "BMSCMP",
    "file_name": "jcl/BMSCMP.jcl",
    "file_type": "JCL",
    "analyzed_by": "WAR_RIG",
    "analyzed_at": "2026-01-24T18:32:55.557213",
    "iteration_count": 6,
    "final_status": null
  },
  "purpose": {
    "summary": "Compiles CICS BMS map named CICSMAP using the BUILDBMS cataloged procedure, generating a copybook and load module for CICS deployment. Executes SDSF utility to issue a batch MODIFY command to the CICS region CICSAWSA, performing CEMT SET PROG(CICSMAP) NEWCOPY to refresh the program in production. Supports CARDDEMO CICS application by automating BMS map build and CICS refresh.",
    "business_context": "Supports CICS application CARDDEMO by compiling and deploying BMS maps",
    "program_type": "BATCH",
    "citations": [
      4,
      5,
      26,
      27,
      37,
      38,
      42,
      46
    ]
  },
  "inputs": [
    {
      "name": "HLQ",
      "io_type": "PARAMETER",
      "description": "High level qualifier for dataset naming, referenced as &HLQ in JCLLIB and EXEC parms. Example value AWS.M2 from commented SET (line 32). Used to construct DSNs for procedure library and outputs. Must be defined prior to job submission (typically via job parms or skeleton); no explicit DD. Addresses Imperator [CRITICAL] by documenting key parameter for DSN construction in build lifecycle.",
      "copybook": null,
      "citation": [
        32,
        37,
        38
      ]
    },
    {
      "name": "MAPNAME",
      "io_type": "PARAMETER",
      "description": "BMS map name passed to BUILDBMS procedure (overrides proc default for map-specific processing); no explicit DD. Addresses Chrome [CHR-m-000339] by noting parameter dependency for input dataset resolution (e.g. BMS source DSN=&HLQ.CICSMAP.BMS).",
      "copybook": null,
      "citation": [
        38
      ]
    },
    {
      "name": "JCLLIB",
      "io_type": "OTHER",
      "description": "Job-level JCLLIB ORDER=&HLQ..CARDDEMO.PRC.UTIL referencing procedure library containing BUILDBMS (no explicit DD statement; implicit DISP=SHR for PDS access during EXEC resolution; must exist prior to job execution). Cross-references PRC.UTIL procedures library. Addresses Imperator CRITICAL by documenting JCLLIB as key dependency for EXEC/PROC resolution and Chrome [CHR-m-000339] input_datasets: &HLQ..CARDDEMO.PRC.UTIL (DISP=SHR required pre-job).",
      "copybook": null,
      "citation": [
        37
      ]
    },
    {
      "name": "ISFIN",
      "io_type": "PARAMETER",
      "description": "Inline dataset for SDSF1 step (DD ISFIN DD * here to /*; no DSN/DISP; contains CICS CEMT command text read by SDSF PGM=SDSF). DISP n/a (inline read-only). Addresses Chrome [CHR-m-000338] by documenting DD ISFIN: no DSN=, inline data, purpose=CICS command input.",
      "copybook": null,
      "citation": [
        45,
        46
      ]
    },
    {
      "name": "BMS-SOURCE",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Input dataset containing CICS BMS source code for map CICSMAP (DD name e.g. SYSIN in BUILDBMS proc; DSN e.g. &HLQ.CICSMAP.BMS; likely DISP=OLD or SHR for read-only access during BMSMAP/Assembler compile step; must exist before STEP1). DISP unknown without proc (typically OLD/SHR). Addresses Chrome [CHR-m-000338], Imperator CRITICAL, and [CHR-m-000339] input_datasets: &HLQ.CICSMAP.BMS (DISP=SHR/OLD required pre-job).",
      "copybook": null,
      "citation": [
        26,
        27,
        38
      ]
    },
    {
      "name": "&HLQ..CARDDEMO.PRC.UTIL",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Procedure library PDS (DSN=&HLQ..CARDDEMO.PRC.UTIL via JCLLIB ORDER; implicit DISP=SHR for read access by EXEC BUILDBMS; contains BUILDBMS cataloged procedure definition read at job initiation; must exist prior to execution). Addresses Chrome [CHR-m-000338], Imperator CRITICAL, and [CHR-m-000339] input_datasets: &HLQ..CARDDEMO.PRC.UTIL (DISP=SHR required pre-job).",
      "copybook": null,
      "citation": [
        37
      ]
    }
  ],
  "outputs": [
    {
      "name": "ISFOUT",
      "io_type": "REPORT",
      "description": "SDSF output listing from SDSF1 step (DD ISFOUT DD SYSOUT=*; no DSN/DISP; transient SYSOUT CLASS=H (from JOB MSGCLASS=H) for job/SDS logs printed/reviewed post-execution). DISP n/a (SYSOUT). Addresses Chrome [CHR-m-000338] by documenting DD ISFOUT: no DSN=, SYSOUT=*, purpose=SDSF logs.",
      "copybook": null,
      "citation": [
        43
      ]
    },
    {
      "name": "CMDOUT",
      "io_type": "REPORT",
      "description": "CICS command response output from SDSF1 (DD CMDOUT DD SYSOUT=*; no DSN/DISP; transient SYSOUT CLASS=H capturing CEMT response for verification). DISP n/a (SYSOUT). Addresses Chrome [CHR-m-000338] by documenting DD CMDOUT: no DSN=, SYSOUT=*, purpose=CICS command output.",
      "copybook": null,
      "citation": [
        44
      ]
    },
    {
      "name": "BMS-COPYBOOK",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Generated BMS copybook member (likely DD SYSPUNCH or SYSLIN in BUILDBMS proc; DSN e.g. &HLQ.CICSMAP.CPY or &HLQ.COPY(CICSMAP); likely DISP=(NEW,CATLG) or MOD to create/update PDS member for COBOL/PLI include). DISP unknown without proc (typically NEW,CATLG,MOD). Addresses Chrome [CHR-m-000338], Imperator CRITICAL, and [CHR-m-000339] output_datasets: &HLQ.COPY(CICSMAP) (DISP=NEW/MOD created/updated by job).",
      "copybook": null,
      "citation": [
        26,
        27,
        38
      ]
    },
    {
      "name": "CICSMAP-LOAD",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Linked load module for CICS BMS mapset (likely DD SYSLMOD in BUILDBMS proc link-edit step; DSN e.g. &HLQ.LOADLIB(CICSMAP); likely DISP=(NEW,CATLG,DELETE) or MOD to create/update load library member for CICS NEWCOPY). DISP unknown without proc (typically NEW,CATLG,DELETE). Addresses Chrome [CHR-m-000338], Imperator CRITICAL, and [CHR-m-000339] output_datasets: &HLQ.LOADLIB(CICSMAP) (DISP=NEW/MOD created/updated by job).",
      "copybook": null,
      "citation": [
        38
      ]
    }
  ],
  "called_programs": [
    {
      "program_name": "BUILDBMS",
      "call_type": "STATIC_CALL",
      "purpose": "Cataloged procedure invoked by STEP1 to compile CICS BMS map source (BMSMAP), assemble, link-edit into load module, and generate copybook. Parameters MAPNAME=CICSMAP,HLQ=&HLQ override proc symbolic parms for DSN construction. PROC from &HLQ..CARDDEMO.PRC.UTIL library. Addresses Imperator CRITICAL by documenting EXEC PROC=BUILDBMS purpose in build lifecycle (BMS compile for CARDDEMO CICS).",
      "parameters": [
        "MAPNAME=CICSMAP",
        "HLQ=&HLQ"
      ],
      "citation": 38
    },
    {
      "program_name": "SDSF",
      "call_type": "STATIC_CALL",
      "purpose": "Batch utility program executed by SDSF1 step to process inline CICS MODIFY command against region CICSAWSA. No parms; uses DD ISFIN input, ISFOUT/CMDOUT output. Addresses Imperator CRITICAL by documenting EXEC PGM=SDSF purpose in deployment lifecycle (CICS refresh post-compile).",
      "parameters": [],
      "citation": 42
    }
  ],
  "calling_context": {
    "called_by": [],
    "entry_points": [],
    "linkage_section": []
  },
  "business_rules": [
    {
      "rule_id": "BR001",
      "description": "HLQ parameter must be defined externally before job submission to resolve all symbolic DSNs for inputs (PROC lib, BMS source) and outputs (copybook, load).",
      "logic_summary": "Referenced in JCLLIB (37), EXEC parms (38); example value AWS.M2 (32).",
      "conditions": [
        "HLQ not defined causes JCL resolution failure"
      ],
      "citation": [
        32,
        37,
        38
      ]
    },
    {
      "rule_id": "BR002",
      "description": "CICS region CICSAWSA must be active and accessible via SDSF for CEMT NEWCOPY to succeed post-compile.",
      "logic_summary": "Inline command targets specific region (46).",
      "conditions": [
        "Region down causes SDSF MODIFY failure"
      ],
      "citation": [
        46
      ]
    }
  ],
  "data_flow": {
    "reads_from": [
      {
        "source": "HLQ",
        "fields_used": [
          "AWS.M2"
        ],
        "citation": [
          32
        ]
      },
      {
        "source": "ISFIN",
        "fields_used": [
          "/MODIFY CICSAWSA,'CEMT SET PROG(CICSMAP) NEWCOPY'"
        ],
        "citation": [
          46
        ]
      },
      {
        "source": "&HLQ..CARDDEMO.PRC.UTIL",
        "fields_used": [
          "BUILDBMS procedure"
        ],
        "citation": [
          37
        ]
      },
      {
        "source": "BMS-SOURCE",
        "fields_used": [
          "CICSMAP BMS map source"
        ],
        "citation": [
          26,
          27,
          38
        ]
      },
      {
        "source": "JCLLIB ORDER",
        "fields_used": [
          "&HLQ..CARDDEMO.PRC.UTIL"
        ],
        "citation": [
          37
        ]
      }
    ],
    "writes_to": [
      {
        "destination": "ISFOUT",
        "fields_written": [
          "SDSF output"
        ],
        "citation": [
          43
        ]
      },
      {
        "destination": "CMDOUT",
        "fields_written": [
          "CICS command response"
        ],
        "citation": [
          44
        ]
      },
      {
        "destination": "BMS-COPYBOOK",
        "fields_written": [
          "Generated BMS copybook"
        ],
        "citation": [
          26,
          27,
          38
        ]
      },
      {
        "destination": "CICSMAP-LOAD",
        "fields_written": [
          "BMS mapset load module"
        ],
        "citation": [
          38
        ]
      }
    ],
    "transforms": [
      {
        "input_field": "MAPNAME=CICSMAP,HLQ=&HLQ",
        "output_field": "BMS-COPYBOOK, CICSMAP-LOAD",
        "transformation_description": "BUILDBMS proc (from JCLLIB=&HLQ..CARDDEMO.PRC.UTIL) uses parms to process CICSMAP BMS source into copybook (SYSPUNCH) and load module (SYSLMOD), overriding DSN symbolic parameters.",
        "citation": [
          37,
          38
        ]
      },
      {
        "input_field": "/MODIFY CICSAWSA,'CEMT SET PROG(CICSMAP) NEWCOPY'",
        "output_field": "CMDOUT",
        "transformation_description": "SDSF processes inline command to issue CICS CEMT refresh, logging response to SYSOUT.",
        "citation": [
          46
        ]
      }
    ]
  },
  "copybooks_used": [],
  "paragraphs": [
    {
      "paragraph_name": "CCLIBS",
      "purpose": "Job-level JCLLIB ORDER directive (under CCLIBS label) specifying procedure library for resolving EXEC BUILDBMS; establishes JCL-to-PROC cross-reference to &HLQ..CARDDEMO.PRC.UTIL. Addresses Imperator CRITICAL by documenting job-level statement for PROC library. No COND parameters. Addresses Chrome [CHR-m-000339] input_datasets dependency.",
      "called_by": [],
      "calls": [],
      "citation": [
        37,
        37
      ]
    },
    {
      "paragraph_name": "STEP1",
      "purpose": "Primary compile step executing BUILDBMS cataloged procedure (PGM sequence: BMSMAP/ASMA90/LKED per proc) to build CICSMAP BMS mapset load and copybook for CARDDEMO CICS application deployment; parms customize for map name and HLQ. Specific role: BMS compile in CARDDEMO build lifecycle. No COND parameters (executes unconditionally). Addresses Imperator CRITICAL by documenting EXEC statement, purpose, and Chrome [CHR-m-000339] input/output datasets.",
      "called_by": [],
      "calls": [
        "BUILDBMS"
      ],
      "citation": [
        38,
        38
      ]
    },
    {
      "paragraph_name": "SDSF1",
      "purpose": "Post-compile deployment step executing SDSF utility (PGM=SDSF) to batch-issue CICS CEMT NEWCOPY command against CICSAWSA region, refreshing CICSMAP BMS mapset in production for CARDDEMO application availability. Specific role: CICS deployment/refresh in CARDDEMO lifecycle. No COND parameters (executes unconditionally). Addresses Imperator CRITICAL by documenting EXEC statement, purpose, DDs.",
      "called_by": [],
      "calls": [
        "SDSF"
      ],
      "citation": [
        42,
        47
      ]
    }
  ],
  "error_handling": [],
  "sql_operations": [],
  "cics_operations": [
    {
      "command": "CEMT SET PROG(CICSMAP) NEWCOPY",
      "resource": "CICSAWSA (CICS region), CICSMAP (PROG/mapset)",
      "purpose": "Refreshes the compiled BMS mapset program in the CICS region CICSAWSA via batch SDSF MODIFY.",
      "citation": 46
    }
  ],
  "open_questions": [
    {
      "question": "What are the exact DD statements, DSN values, DISP parameters (NEW/OLD/SHR/MOD/CATLG/DELETE), and step purposes in the BUILDBMS procedure?",
      "context": "STEP1 EXEC BUILDBMS (line 38) invokes proc from JCLLIB=&HLQ..CARDDEMO.PRC.UTIL (line 37); inline JCL lacks DD/DSN details, limiting documentation of BMS source input (e.g. SYSIN), assembler temp files, SYSPUNCH copybook output, SYSLMOD load. Addresses Chrome [CHR-m-000338] partially; exact proc details needed for full DD/DSN/DISP.",
      "suggestion": "Retrieve/analyze BUILDBMS PROC source from &HLQ..CARDDEMO.PRC.UTIL PDS to enumerate DDs grouped by sub-step (compile/assemble/link), with exact symbolic DSN parm expansion and DISP."
    }
  ]
}