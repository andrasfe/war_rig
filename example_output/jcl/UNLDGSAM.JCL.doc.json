{
  "header": {
    "program_id": "UNLDGSAM",
    "file_name": "jcl/UNLDGSAM.JCL",
    "file_type": "JCL",
    "analyzed_by": "WAR_RIG",
    "analyzed_at": "2026-02-25T15:30:18.250600",
    "iteration_count": 1,
    "final_status": null
  },
  "purpose": {
    "summary": "This JCL job executes the IMS GSAM database unload utility DFSRRC00 to unload the PAUTDB database (segments ROOT and CHILD from GSAM datasets). It allocates necessary IMS libraries, DBD libraries, and control datasets for the unload process. Standard SYSOUT datasets capture listings, dumps, and errors.",
    "business_context": "Supports unloading of the PAUTDB GSAM database in the AWS M2 CARDDEMO application, likely for backup, migration, or analysis purposes.",
    "program_type": "BATCH",
    "citations": [
      1,
      23,
      26,
      36,
      39
    ]
  },
  "inputs": [
    {
      "name": "PASFILOP",
      "io_type": "FILE_VSAM",
      "description": "PAUTDB ROOT GSAM database dataset read by the unload utility",
      "copybook": null,
      "citation": [
        36
      ]
    },
    {
      "name": "PADFILOP",
      "io_type": "FILE_VSAM",
      "description": "PAUTDB CHILD GSAM database dataset read by the unload utility",
      "copybook": null,
      "citation": [
        39
      ]
    },
    {
      "name": "DDPAUTP0",
      "io_type": "FILE_SEQUENTIAL",
      "description": "IMS PAUTHDB dataset, likely containing DBD definitions or control data for PAUTDB",
      "copybook": null,
      "citation": [
        42
      ]
    },
    {
      "name": "DDPAUTX0",
      "io_type": "FILE_SEQUENTIAL",
      "description": "IMS PAUTHDBX dataset, likely index or extended control data for PAUTDB",
      "copybook": null,
      "citation": [
        43
      ]
    },
    {
      "name": "DFSVSAMP",
      "io_type": "FILE_SEQUENTIAL",
      "description": "IMS proclib member DFSVSMDB providing VSAM macro definitions for GSAM processing",
      "copybook": null,
      "citation": [
        46
      ]
    },
    {
      "name": "STEPLIB",
      "io_type": "OTHER",
      "description": "Load libraries for IMS SDFSRESL (v151), and application AWS.M2.CARDDEMO.LOADLIB",
      "copybook": null,
      "citation": [
        28
      ]
    },
    {
      "name": "DFSRESLB",
      "io_type": "OTHER",
      "description": "Additional IMS SDFSRESL library for resource modules",
      "copybook": null,
      "citation": [
        31
      ]
    },
    {
      "name": "IMS",
      "io_type": "OTHER",
      "description": "IMS PSBLIB and DBDLIB for program specification blocks and database definitions",
      "copybook": null,
      "citation": [
        33
      ]
    },
    {
      "name": "PARM",
      "io_type": "PARAMETER",
      "description": "Execution parameters 'DLI,DBUNLDGS,DLIGSAMP,,,,,,,,,,,N' specifying DLI mode, GSAM unload function for DLIGSAMP database",
      "copybook": null,
      "citation": [
        27
      ]
    }
  ],
  "outputs": [
    {
      "name": "SYSPRINT",
      "io_type": "REPORT",
      "description": "Standard print output including unload listings and messages",
      "copybook": null,
      "citation": [
        50
      ]
    },
    {
      "name": "SYSUDUMP",
      "io_type": "REPORT",
      "description": "System dump output in case of abends",
      "copybook": null,
      "citation": [
        51
      ]
    },
    {
      "name": "IMSERR",
      "io_type": "REPORT",
      "description": "IMS error messages output",
      "copybook": null,
      "citation": [
        52
      ]
    }
  ],
  "called_programs": [],
  "calling_context": {
    "called_by": [],
    "entry_points": [],
    "linkage_section": []
  },
  "business_rules": [],
  "data_flow": {
    "reads_from": [
      {
        "source": "PASFILOP",
        "fields_used": [
          "UNKNOWN (GSAM records)"
        ],
        "citation": [
          36
        ]
      },
      {
        "source": "PADFILOP",
        "fields_used": [
          "UNKNOWN (GSAM records)"
        ],
        "citation": [
          39
        ]
      }
    ],
    "writes_to": [
      {
        "destination": "SYSPRINT",
        "fields_written": [
          "Unload listings and diagnostics"
        ],
        "citation": [
          50
        ]
      }
    ],
    "transforms": []
  },
  "copybooks_used": [],
  "paragraphs": [
    {
      "paragraph_name": "UNLDGSAM",
      "summary": null,
      "purpose": "This paragraph represents the overall JCL job definition named UNLDGSAM, which orchestrates the execution of the IMS GSAM database unload process. It consumes job parameters including class A, MSGCLASS H, REGION 0M, TIME 1440, and notification to SYSUID from lines 1-2. It includes extensive copyright, license, and descriptive comments from lines 3-25 explaining the purpose as 'EXECUTE IMS PROGRAM' for unloading. The job defines a single step STEP01 that executes PGM=DFSRRC00 with specific PARM for DLI DBUNLDGS on DLIGSAMP database (line 27). It allocates input datasets such as PASFILOP (ROOT GSAM), PADFILOP (CHILD GSAM), DDPAUTP0/ DDPAUTX0 (PAUTHDB control), and DFSVSAMP (VSAM macros), along with required libraries STEPLIB, DFSRESLB, and IMS PSBLIB/DBDLIB. Outputs are directed to SYSPRINT, SYSUDUMP, and IMSERR for reporting and diagnostics. There are no explicit business logic decisions or validations in the JCL itself; these are handled internally by DFSRRC00. Error handling relies on standard z/OS mechanisms with DUMMY DD's for IMSLOGR and IEFRDER to suppress unnecessary logs (lines 48-49), and SYSUDUMP captures abends. No subordinate paragraphs are called as this is JCL structure, but it effectively calls the IMS utility program DFSRRC00 to read GSAM inputs and produce unload output. No CICS or SQL operations are present.",
      "called_by": [],
      "calls": [],
      "citation": [
        1,
        54
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    }
  ],
  "error_handling": [
    {
      "condition": "Program abend",
      "action": "SYSUDUMP to SYSOUT and IMSERR to SYSOUT",
      "citation": [
        51
      ]
    },
    {
      "condition": "IMS log requirements",
      "action": "DUMMY allocation for IMSLOGR and IEFRDER",
      "citation": [
        48
      ]
    }
  ],
  "sql_operations": [],
  "cics_operations": [],
  "open_questions": [
    {
      "question": "What is the specific output dataset for the GSAM unload records?",
      "context": "No explicit sequential unload DD (e.g., UNLOADxx or SYSUT1) is defined; output appears limited to SYSPRINT",
      "suggestion": "Review IMS DFSRRC00 DBUNLDGS documentation for default output DD names or check job logs for actual unload destination"
    }
  ],
  "resolved_questions": [
    {
      "original_question": "Is DLIGSAMP the DBD name for PAUTDB, or a different database?",
      "original_context": "PARM specifies DLIGSAMP but datasets are PAUTDB.ROOT/CHILD.GSAM",
      "answer": "**No, DLIGSAMP is not the DBD name for PAUTDB (or any database).**\n\n### Key Findings:\n- **DLIGSAMP is a PSB name** (Program Specification Block), not a DBD (Database Definition). It is specified in the `UNLDGSAM.JCL` PARM for DFSRRC00:  \n  ```\n  //STEP01  EXEC PGM=DFSRRC00,\n  //             PARM='DLI,DBUNLDGS,DLIGSAMP,,,,,,,,,,,N'\n  ```\n  Here, DFSRRC00 (IMS GSAM unload utility) uses:\n  - `DLI`: DL/I region type.\n  - `DBUNLDGS`: Utility program (`cbl/DBUNLDGS.CBL`).\n  - `DLIGSAMP`: PSB name.\n\n- **PSB Definition** (`ims/DLIGSAMP.PSB`):  \n  ```\n  PAUTBPCB PCB TYPE=DB,DBDNAME=DBPAUTP0,PROCOPT=GOTP,KEYLEN=14\n           SENSEG NAME=PAUTSUM0,PARENT=0\n           SENSEG NAME=PAUTDTL1,PARENT=PAUTSUM0\n  PCB TYPE=GSAM,DBDNAME=PASFLDBD,PROCOPT=LS\n  PCB TYPE=GSAM,DBDNAME=PADFLDBD,PROCOPT=LS\n  PSBGEN LANG=COBOL,PSBNAME=DLIGSAMP\n  ```\n  - Accesses **DBPAUTP0** (hierarchical DBD, root=PAUTSUM0, child=PAUTDTL1).\n  - Plus two **GSAM DBDs**: **PASFLDBD** (ROOT segment) and **PADFLDBD** (CHILD segment).\n\n- **PAUTDB Context**:\n  - \"PAUTDB\" is a **logical/dataset name** for GSAM files:  \n    `AWS.M2.CARDDEMO.PAUTDB.ROOT.GSAM` → `PASFILOP` DD (maps to PASFLPCB/PASFLDBD).  \n    `AWS.M2.CARDDEMO.PAUTDB.CHILD.GSAM` → `PADFILOP` DD (maps to PADFLPCB/PADFLDBD).\n  - These are unloaded by DFSRRC00 via PSB `DLIGSAMP` + program `DBUNLDGS.CBL`.\n  - `DBUNLDGS.CBL` reads hierarchical data via `PAUTBPCB` (DBPAUTP0) and writes to GSAM PCBs (`PASFLPCB`, `PADFLPCB`).\n\n- **No DBD named DLIGSAMP or PAUTDB**:\n  - Searches for `DLIGSAMP`/`PAUTDB` in `*.dbd` files: No matches.\n  - Actual DBDs: `PASFLDBD` (GSAM ROOT), `PADFLDBD` (GSAM CHILD), `DBPAUTP0` (hierarchical PAU DB).\n\n**Summary**: `UNLDGSAM.JCL` unloads **PAUTDB GSAM datasets** (ROOT/CHILD segments via DBDs `PASFLDBD`/`PADFLDBD`) using PSB `DLIGSAMP`. PAUTDB is **not** a formal DBD—it's the dataset prefix for the GSAM-accessible version of the main PAU database (DBD=`DBPAUTP0`).\n\n**Sources**: `jcl/UNLDGSAM.JCL` (lines 26-40), `ims/DLIGSAMP.PSB` (lines 17-23), `cbl/DBUNLDGS.CBL` (PCBs/CALL 'CBLTDLI'), `cpy/PASFLPCB.CPY`/`PADFLPCB.CPY` (DBDNAME fields), skill `system-overview`.",
      "confidence": "HIGH",
      "resolved_by": "CODEWHISPER",
      "cycle_resolved": 1,
      "tool_calls_used": 18
    }
  ],
  "dead_code": [],
  "call_semantics": [],
  "flow_diagram": null
}