{
  "header": {
    "program_id": "COPAUS1C",
    "file_name": "cbl/COPAUS1C.cbl",
    "file_type": "COBOL",
    "analyzed_by": "WAR_RIG",
    "analyzed_at": "2026-01-27T02:41:03.853476",
    "iteration_count": 1,
    "final_status": null
  },
  "purpose": {
    "summary": "This CICS/IMS/BMS COBOL program provides a detail view screen for pending authorization records in the CardDemo authorization module. It reads IMS segments for authorization summary (PAUTSUM0) and details (PAUTDTL1), populates a BMS map with formatted details including dates, amounts, response codes, and fraud status, and handles user keys for enter (refresh details), PF3 (return to summary), PF5 (toggle fraud marking via linked program), and PF8 (next record). It supports fraud reporting/removal by linking to COPAUS2C and updating the IMS detail segment.",
    "business_context": "Serves the authorization inquiry process in a simulated credit card demo application, allowing operators to view, navigate, and manage (mark/remove fraud) pending authorization details for accounts.",
    "program_type": "ONLINE_CICS",
    "citations": [
      2,
      3,
      4,
      5,
      157,
      375
    ]
  },
  "inputs": [
    {
      "name": "CARDDEMO-COMMAREA",
      "io_type": "CICS_COMMAREA",
      "description": "Common commarea containing account ID (CDEMO-ACCT-ID), selected authorization key (CDEMO-CPVD-PAU-SELECTED), customer ID (CDEMO-CUST-ID), page info, and fraud data passed from/to calling programs.",
      "copybook": "COCOM01Y",
      "citation": [
        171,
        172
      ]
    },
    {
      "name": "COPAU1AI",
      "io_type": "CICS_MAP",
      "description": "Input map from BMS receive containing user-entered or selected data like account ID and authorization key.",
      "copybook": "COPAU01",
      "citation": [
        400
      ]
    },
    {
      "name": "PAUTSUM0",
      "io_type": "IMS_SEGMENT",
      "description": "IMS root segment (PENDING-AUTH-SUMMARY) for pending authorization summary, qualified by account ID.",
      "copybook": "CIPAUSMY",
      "citation": [
        439
      ]
    },
    {
      "name": "PAUTDTL1",
      "io_type": "IMS_SEGMENT",
      "description": "IMS child segment (PENDING-AUTH-DETAILS) for authorization details, qualified by authorization key under summary parent.",
      "copybook": "CIPAUDTY",
      "citation": [
        466,
        495
      ]
    }
  ],
  "outputs": [
    {
      "name": "COPAU1AO",
      "io_type": "CICS_MAP",
      "description": "Output BMS map populated with authorization details, header info, error messages, and formatted fields for screen display.",
      "copybook": "COPAU01",
      "citation": [
        382,
        390
      ]
    },
    {
      "name": "PAUTDTL1",
      "io_type": "IMS_SEGMENT",
      "description": "Updated IMS child segment with fraud status changes after toggle.",
      "copybook": "CIPAUDTY",
      "citation": [
        525
      ]
    },
    {
      "name": "CARDDEMO-COMMAREA",
      "io_type": "CICS_COMMAREA",
      "description": "Updated commarea returned to caller or next transaction with current selected key and context.",
      "copybook": "COCOM01Y",
      "citation": [
        204
      ]
    }
  ],
  "called_programs": [
    {
      "program_name": "COPAUS2C",
      "call_type": "CICS_LINK",
      "purpose": "Handles fraud marking or removal on the authorization detail record, updates fraud status, and returns success/failure message.",
      "parameters": [
        "WS-FRAUD-DATA"
      ],
      "citation": 249
    },
    {
      "program_name": "COPAUS0C",
      "call_type": "CICS_XCTL",
      "purpose": "Returns control to the authorization summary screen (previous program).",
      "parameters": [
        "CARDDEMO-COMMAREA"
      ],
      "citation": 368
    }
  ],
  "calling_context": {
    "called_by": [
      "COPAUS0C"
    ],
    "entry_points": [
      "CPVD"
    ],
    "linkage_section": [
      "DFHCOMMAREA"
    ]
  },
  "business_rules": [
    {
      "rule_id": "BR001",
      "description": "Format authorization response: 'A' (Approved) with green color if PA-AUTH-RESP-CODE = '00', else 'D' (Declined) with red color.",
      "logic_summary": "Conditional move to AUTHRSPO and color field AUTHRSPC based on response code.",
      "conditions": [
        "PA-AUTH-RESP-CODE = '00'"
      ],
      "citation": [
        311,
        316
      ]
    },
    {
      "rule_id": "BR002",
      "description": "Lookup decline reason description from table by PA-AUTH-RESP-REASON code, append to code with '-' separator; default to '9999-ERROR' if not found.",
      "logic_summary": "SEARCH ALL on WS-DECLINE-REASON-TAB indexed table.",
      "conditions": [
        "DECL-CODE(WS-DECL-RSN-IDX) = PA-AUTH-RESP-REASON"
      ],
      "citation": [
        319,
        324
      ]
    },
    {
      "rule_id": "BR003",
      "description": "Toggle fraud status: If already PA-FRAUD-CONFIRMED, set to PA-FRAUD-REMOVED and call fraud program to remove; else set confirmed and report fraud.",
      "logic_summary": "Conditional set flags before LINK to fraud program.",
      "conditions": [
        "PA-FRAUD-CONFIRMED"
      ],
      "citation": [
        236,
        240
      ]
    },
    {
      "rule_id": "BR004",
      "description": "Validate enter key input: Require numeric CDEMO-ACCT-ID and non-blank/low-values CDEMO-CPVD-PAU-SELECTED before reading IMS.",
      "logic_summary": "IF numeric and not spaces/low-values check before PERFORM READ-AUTH-RECORD.",
      "conditions": [
        "CDEMO-ACCT-ID IS NUMERIC",
        "CDEMO-CPVD-PAU-SELECTED NOT = SPACES AND LOW-VALUES"
      ],
      "citation": [
        211,
        223
      ]
    }
  ],
  "data_flow": {
    "reads_from": [
      {
        "source": "PENDING-AUTH-SUMMARY",
        "fields_used": [
          "PA-ACCT-ID",
          "PA-AUTHORIZATION-KEY"
        ],
        "citation": [
          436
        ]
      },
      {
        "source": "PENDING-AUTH-DETAILS",
        "fields_used": [
          "PA-CARD-NUM",
          "PA-AUTH-ORIG-DATE",
          "PA-AUTH-ORIG-TIME",
          "PA-APPROVED-AMT",
          "PA-AUTH-RESP-CODE",
          "PA-AUTH-RESP-REASON",
          "PA-PROCESSING-CODE",
          "PA-FRAUD-CONFIRMED",
          "PA-FRAUD-RPT-DATE"
        ],
        "citation": [
          295,
          297,
          303,
          308,
          311,
          319,
          331,
          344
        ]
      },
      {
        "source": "CARDDEMO-COMMAREA",
        "fields_used": [
          "CDEMO-ACCT-ID",
          "CDEMO-CPVD-PAU-SELECTED",
          "CDEMO-CUST-ID"
        ],
        "citation": [
          231,
          270
        ]
      }
    ],
    "writes_to": [
      {
        "destination": "COPAU1AO",
        "fields_written": [
          "CARDNUMO",
          "AUTHDTO",
          "AUTHTMO",
          "AUTHAMTO",
          "AUTHRSPO",
          "AUTHRSNO",
          "AUTHFRDO",
          "MERNAMEO"
        ],
        "citation": [
          295,
          301,
          306,
          309,
          312,
          325,
          345,
          352
        ]
      },
      {
        "destination": "PENDING-AUTH-DETAILS",
        "fields_written": [
          "PA-FRAUD-CONFIRMED",
          "PA-FRAUD-REMOVED",
          "PA-FRAUD-RPT-DATE"
        ],
        "citation": [
          522
        ]
      }
    ],
    "transforms": [
      {
        "input_field": "PA-AUTH-ORIG-DATE",
        "output_field": "AUTHDTO",
        "transformation_description": "Reformat YYYYMMDD to MM/DD/YY by substring to WS-CURDATE components then WS-CURDATE-MM-DD-YY.",
        "citation": [
          297
        ]
      },
      {
        "input_field": "PA-AUTH-ORIG-TIME",
        "output_field": "AUTHTMO",
        "transformation_description": "Reformat HHMMSS to HH:MM:SS by substring positions.",
        "citation": [
          303
        ]
      },
      {
        "input_field": "PA-AUTH-RESP-REASON",
        "output_field": "AUTHRSNO",
        "transformation_description": "Search table for matching DECL-CODE, append '-' and DECL-DESC; else '9999-ERROR'.",
        "citation": [
          319
        ]
      },
      {
        "input_field": "PA-CARD-EXPIRY-DATE",
        "output_field": "CRDEXPO",
        "transformation_description": "Reformat YYMM to YY/MM by substring and insert '/'.",
        "citation": [
          336
        ]
      },
      {
        "input_field": "PA-FRAUD-RPT-DATE",
        "output_field": "AUTHFRDO",
        "transformation_description": "If fraud confirmed/removed, set first char from PA-AUTH-FRAUD and append date; else '-'.",
        "citation": [
          345
        ]
      }
    ]
  },
  "copybooks_used": [
    {
      "copybook_name": "COCOM01Y",
      "purpose": "Defines CARDDEMO-COMMAREA structure including CDEMO-CPVD-INFO for transaction data like account ID, selected keys, page num, fraud data.",
      "location": "WORKING_STORAGE",
      "citation": 109
    },
    {
      "copybook_name": "COPAU01",
      "purpose": "Defines BMS maps COPAU1AI (input) and COPAU1AO (output) for authorization detail view screen fields.",
      "location": "WORKING_STORAGE",
      "citation": 122
    },
    {
      "copybook_name": "COTTL01Y",
      "purpose": "Screen titles like CCDA-TITLE01, CCDA-TITLE02.",
      "location": "WORKING_STORAGE",
      "citation": 126
    },
    {
      "copybook_name": "CSDAT01Y",
      "purpose": "Current date working variables like WS-CURDATE-DATA, WS-CURDATE-MM-DD-YY.",
      "location": "WORKING_STORAGE",
      "citation": 129
    },
    {
      "copybook_name": "CSMSG01Y",
      "purpose": "Common messages like CCDA-MSG-INVALID-KEY.",
      "location": "WORKING_STORAGE",
      "citation": 132
    },
    {
      "copybook_name": "CSMSG02Y",
      "purpose": "Abend variables.",
      "location": "WORKING_STORAGE",
      "citation": 135
    },
    {
      "copybook_name": "CIPAUSMY",
      "purpose": "IMS segment layout for PENDING-AUTH-SUMMARY (PAUTSUM0 root).",
      "location": "WORKING_STORAGE",
      "citation": 142
    },
    {
      "copybook_name": "CIPAUDTY",
      "purpose": "IMS segment layout for PENDING-AUTH-DETAILS (PAUTDTL1 child).",
      "location": "WORKING_STORAGE",
      "citation": 146
    },
    {
      "copybook_name": "DFHAID",
      "purpose": "CICS attention identifier (EIBAID).",
      "location": "WORKING_STORAGE",
      "citation": 148
    },
    {
      "copybook_name": "DFHBMSCA",
      "purpose": "CICS basic mapping support constants like DFHENTER, DFHPF3.",
      "location": "WORKING_STORAGE",
      "citation": 150
    }
  ],
  "paragraphs": [
    {
      "paragraph_name": "MAIN-PARA",
      "summary": null,
      "purpose": "This is the primary entry point and orchestration paragraph that initializes flags and message areas, then handles first-time invocation (EIBCALEN=0) by XCTL back to summary screen or re-entry by moving commarea and dispatching based on reenter flag. For non-reenter, it processes enter key and sends screen; for reenter, receives map and evaluates EIBAID to handle PF3 (return to summary), PF5 (mark fraud), PF8 (next record), ENTER (refresh), or other (error). It consumes DFHCOMMAREA (via EIBCALEN), CARDDEMO-COMMAREA, and map input on receive. It produces updated CARDDEMO-COMMAREA and final CICS RETURN with TRANSID CPVD. Business logic includes conditional initialization, reenter detection (CDEMO-PGM-REENTER), and AID-based dispatching for navigation/error. Errors set WS-MESSAGE and redisplay screen. It calls subordinate paragraphs like PROCESS-ENTER-KEY, SEND-AUTHVIEW-SCREEN, RECEIVE-AUTHVIEW-SCREEN, MARK-AUTH-FRAUD, etc., and XCTL to COPAUS0C on PF3. Finally, always RETURNS to transaction CPVD preserving commarea.",
      "called_by": [],
      "calls": [
        "PROCESS-ENTER-KEY",
        "SEND-AUTHVIEW-SCREEN",
        "RECEIVE-AUTHVIEW-SCREEN",
        "RETURN-TO-PREV-SCREEN"
      ],
      "citation": [
        157,
        206
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "PROCESS-ENTER-KEY",
      "summary": null,
      "purpose": "This paragraph validates and refreshes the current authorization detail by reading IMS for the selected key. It consumes CDEMO-ACCT-ID (numeric check) and CDEMO-CPVD-PAU-SELECTED (non-blank/low check) from commarea/map, clears output map (LOW-VALUES to COPAU1AO), and performs READ-AUTH-RECORD using WS-ACCT-ID/WS-AUTH-KEY. If validation fails, sets ERR-FLG-ON. It syncpoints if PSB was scheduled. Produces populated map fields via subsequent POPULATE-AUTH-DETAILS. Business logic enforces numeric acct and valid selection before IMS GU read; errors flag only (no message here). No direct calls except READ-AUTH-RECORD (inline), then always calls POPULATE-AUTH-DETAILS to format display data. Error handling is validation-only; IMS errors handled in READ-AUTH-RECORD.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [
        "READ-AUTH-RECORD",
        "POPULATE-AUTH-DETAILS"
      ],
      "citation": [
        208,
        229
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "MARK-AUTH-FRAUD",
      "summary": null,
      "purpose": "This paragraph toggles fraud status on the current authorization detail via PF5, first reading IMS record then conditionally setting confirmed/removed flags. It consumes CDEMO-ACCT-ID, CDEMO-CPVD-PAU-SELECTED to read IMS, toggles PA-FRAUD-CONFIRMED/PA-FRAUD-REMOVED and prepares WS-FRAUD-DATA (acct/cust ID, record, action). Links to COPAUS2C; on success and update success, updates IMS REPL and sets success message; else rolls back and sets error message from fraud program. Produces updated PENDING-AUTH-DETAILS in IMS, refreshed map, and updated CDEMO-CPVD-PAU-SELECTED. Business logic toggles fraud state (confirmed->remove else report), commits only on full success. Errors from LINK/REPL trigger ROLL-BACK. Calls READ-AUTH-RECORD, LINK COPAUS2C, UPDATE-AUTH-DETAILS/POPULATE-AUTH-DETAILS on success, ROLL-BACK on failure.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [
        "READ-AUTH-RECORD",
        "UPDATE-AUTH-DETAILS",
        "POPULATE-AUTH-DETAILS",
        "ROLL-BACK"
      ],
      "citation": [
        230,
        267
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "PROCESS-PF8-KEY",
      "summary": null,
      "purpose": "Handles PF8 to navigate to next authorization detail record under the same account. Consumes current CDEMO-ACCT-ID/SELECTED to position via prior read, then GNP next PAUTDTL1 child. Syncpoints PSB if scheduled. If EOF, sets no-erase flag and 'last auth' message; else updates selected key and populates details. Produces next PENDING-AUTH-DETAILS or error message. Business logic detects AUTHS-EOF from IMS status to prevent wrap-around. Errors from GNP trigger message/screen send inline. Calls READ-AUTH-RECORD (to position?), READ-NEXT-AUTH-RECORD, POPULATE-AUTH-DETAILS.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [
        "READ-AUTH-RECORD",
        "READ-NEXT-AUTH-RECORD",
        "POPULATE-AUTH-DETAILS"
      ],
      "citation": [
        268,
        290
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "POPULATE-AUTH-DETAILS",
      "summary": null,
      "purpose": "Formats and moves IMS detail data to BMS output map fields only if no error flag, transforming dates/times/reasons/fraud info. Consumes PENDING-AUTH-DETAILS fields (PA-CARD-NUM, dates, amounts, codes, fraud flags) and decline table. Produces all screen fields like CARDNUMO, AUTHDTO (reformatted date), AUTHRSNO (lookup reason), AUTHFRDO (fraud date or '-'), merchant info etc. Business logic: conditional approved/decline display/color (BR001), table search for reason (BR002), fraud display if flagged, date/time reformats. No error handling (skips if ERR-FLG-ON). No calls.",
      "called_by": [
        "PROCESS-ENTER-KEY",
        "MARK-AUTH-FRAUD",
        "PROCESS-PF8-KEY"
      ],
      "calls": [],
      "citation": [
        291,
        358
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "RETURN-TO-PREV-SCREEN",
      "summary": null,
      "purpose": "Prepares commarea for return to authorization summary screen on PF3 or initial call. Sets CDEMO-FROM-TRANID/PROGRAM to current, context zeros, enter true, then XCTL to COPAUS0C. Consumes nothing new. Produces updated CARDDEMO-COMMAREA for caller. Business logic: standard navigation back. No errors. No subordinate calls.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [],
      "citation": [
        360,
        371
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "SEND-AUTHVIEW-SCREEN",
      "summary": null,
      "purpose": "Sends the populated BMS map COPAU1A to terminal, with header population and conditional ERASE. Consumes populated COPAU1AO, WS-MESSAGE. Produces screen display, cursor positioned. Business logic: ERASE if SEND-ERASE-YES (initial), else refresh. Calls POPULATE-HEADER-INFO first. No errors (NOHANDLE assumed).",
      "called_by": [
        "MAIN-PARA",
        "READ-AUTH-RECORD",
        "UPDATE-AUTH-DETAILS"
      ],
      "calls": [
        "POPULATE-HEADER-INFO"
      ],
      "citation": [
        373,
        396
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "RECEIVE-AUTHVIEW-SCREEN",
      "summary": null,
      "purpose": "Receives map input from terminal into COPAU1AI. Consumes screen data. Produces COPAU1AI fields for AID/evaluation. Business logic: none, just RECEIVE NOHANDLE. No errors handled here.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [],
      "citation": [
        398,
        406
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "POPULATE-HEADER-INFO",
      "summary": null,
      "purpose": "Populates static screen header with titles, transaction/program names, current date/time from FUNCTION CURRENT-DATE. Consumes WS-CICS-TRANID, WS-PGM-AUTH-DTL, date copybook vars. Produces TITLE01O etc., CURDATEO, CURTIMEO in map. Business logic: formats date/time HH:MM:SS, MM/DD/YY. No errors/calls.",
      "called_by": [
        "SEND-AUTHVIEW-SCREEN"
      ],
      "calls": [],
      "citation": [
        409,
        429
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "READ-AUTH-RECORD",
      "summary": null,
      "purpose": "Schedules PSB if needed, then GU reads summary root by acct ID, then GNP child details by auth key; sets EOF/error flags. Consumes WS-ACCT-ID/KEY to qualify. Produces PENDING-AUTH-SUMMARY/DETAILS or EOF/ERR-FLG. Business logic: IMS status eval (OK->not EOF, GE/GB->EOF, other->error msg/send screen). Errors string IMS-RETURN-CODE to WS-MESSAGE and send screen. Calls SCHEDULE-PSB.",
      "called_by": [
        "PROCESS-ENTER-KEY",
        "MARK-AUTH-FRAUD",
        "PROCESS-PF8-KEY"
      ],
      "calls": [
        "SCHEDULE-PSB"
      ],
      "citation": [
        431,
        492
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "READ-NEXT-AUTH-RECORD",
      "summary": null,
      "purpose": "GNP next child detail under current parent positioning. Consumes current PCB position. Produces next PENDING-AUTH-DETAILS or EOF/error. Business logic: status OK->not EOF, GE/GB->EOF, other->error msg/screen. Errors set ERR-FLG and send.",
      "called_by": [
        "PROCESS-PF8-KEY"
      ],
      "calls": [],
      "citation": [
        493,
        518
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "UPDATE-AUTH-DETAILS",
      "summary": null,
      "purpose": "REPL IMS detail segment with fraud-updated record from WS-FRAUD-AUTH-RECORD. On OK, syncpoint and set success msg (remove or mark); else rollback, err msg/screen. Consumes PENDING-AUTH-DETAILS (restored from fraud). Produces updated IMS segment. Business logic: conditional msg on PA-FRAUD-REMOVED. Calls TAKE-SYNCPOINT/ROLL-BACK.",
      "called_by": [
        "MARK-AUTH-FRAUD"
      ],
      "calls": [
        "TAKE-SYNCPOINT",
        "ROLL-BACK"
      ],
      "citation": [
        520,
        552
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "TAKE-SYNCPOINT",
      "summary": null,
      "purpose": "Performs CICS SYNCPOINT to commit changes. No inputs/outputs beyond CICS state. No logic/errors/calls.",
      "called_by": [
        "PROCESS-ENTER-KEY",
        "UPDATE-AUTH-DETAILS"
      ],
      "calls": [],
      "citation": [
        557,
        560
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "ROLL-BACK",
      "summary": null,
      "purpose": "Performs CICS SYNCPOINT ROLLBACK to undo DB changes. No inputs/outputs. No logic.",
      "called_by": [
        "MARK-AUTH-FRAUD",
        "UPDATE-AUTH-DETAILS"
      ],
      "calls": [],
      "citation": [
        565,
        569
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "SCHEDULE-PSB",
      "summary": null,
      "purpose": "Schedules IMS PSB 'PSBPAUTB' with retry if already scheduled (TERM then SCHD). Sets IMS-PSB-SCHD flag on OK, else err msg/screen. Consumes nothing. Produces PCB ready. Business logic: handle TC status. Errors string code and send screen.",
      "called_by": [
        "READ-AUTH-RECORD"
      ],
      "calls": [],
      "citation": [
        574,
        603
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    }
  ],
  "error_handling": [
    {
      "condition": "IMS DIBSTAT NOT OK/GE/GB (e.g., BA, FH)",
      "action": "Set WS-ERR-FLG 'Y', string error code to WS-MESSAGE, PERFORM SEND-AUTHVIEW-SCREEN",
      "citation": [
        453,
        479,
        508,
        593
      ]
    },
    {
      "condition": "CICS LINK EIBRESP NOT NORMAL",
      "action": "PERFORM ROLL-BACK",
      "citation": [
        260
      ]
    },
    {
      "condition": "Fraud LINK success but WS-FRD-UPDT-FAILED",
      "action": "Move WS-FRD-ACT-MSG to WS-MESSAGE, PERFORM ROLL-BACK",
      "citation": [
        257
      ]
    },
    {
      "condition": "Input validation fail (non-numeric acct or blank key)",
      "action": "SET ERR-FLG-ON (skips populate)",
      "citation": [
        224
      ]
    },
    {
      "condition": "EIBAID OTHER (invalid key)",
      "action": "Process enter anyway, set 'invalid key' message, send screen",
      "citation": [
        196
      ]
    },
    {
      "condition": "PF8 AUTHS-EOF",
      "action": "SET SEND-ERASE-NO, 'Already at last' message",
      "citation": [
        282
      ]
    }
  ],
  "sql_operations": [],
  "cics_operations": [
    {
      "command": "RETURN",
      "resource": "TRANSID(CPVD)",
      "purpose": "Return control to CICS transaction preserving COMMAREA",
      "citation": 202
    },
    {
      "command": "XCTL",
      "resource": "PROGRAM(COPAUS0C)",
      "purpose": "Transfer control to authorization summary program",
      "citation": 368
    },
    {
      "command": "LINK",
      "resource": "PROGRAM(COPAUS2C)",
      "purpose": "Call fraud handling subroutine synchronously",
      "citation": 249
    },
    {
      "command": "SEND MAP",
      "resource": "MAP('COPAU1A') MAPSET('COPAU01')",
      "purpose": "Display authorization detail screen, conditional ERASE",
      "citation": 381
    },
    {
      "command": "RECEIVE MAP",
      "resource": "MAP('COPAU1A') MAPSET('COPAU01')",
      "purpose": "Receive user input from screen",
      "citation": 400
    },
    {
      "command": "SYNCPOINT",
      "resource": null,
      "purpose": "Commit database changes",
      "citation": 558
    },
    {
      "command": "SYNCPOINT ROLLBACK",
      "resource": null,
      "purpose": "Rollback database changes on error",
      "citation": 567
    }
  ],
  "open_questions": [
    {
      "question": "Exact field layouts in copybooks like CIPAUSMY, CIPAUDTY, COPAU01",
      "context": "COPY statements present but contents not in source; inferred from usage (e.g., PA-ACCT-ID, CARDNUMO)",
      "suggestion": "Analyze referenced copybook files"
    },
    {
      "question": "Full list of calling programs beyond COPAUS0C",
      "context": "Inferred from WS-PGM-AUTH-SMRY='COPAUS0C' and context",
      "suggestion": "Trace commarea usage in other programs"
    },
    {
      "question": "Details of fraud program COPAUS2C response in WS-FRD-ACT-MSG",
      "context": "Used but not defined here",
      "suggestion": "Analyze COPAUS2C.cbl"
    }
  ],
  "dead_code": [],
  "flow_diagram": "flowchart TD\n    %% Title: COPAUS1C.cbl\n    MAIN_PARA[\"MAIN-PARA\"]\n    MARK_AUTH_FRAUD[\"MARK-AUTH-FRAUD\"]\n    PROCESS_ENTER_KEY[\"PROCESS-ENTER-KEY\"]\n    PROCESS_PF8_KEY[\"PROCESS-PF8-KEY\"]\n    RECEIVE_AUTHVIEW_SCREEN[\"RECEIVE-AUTHVIEW-SCREEN\"]\n    RETURN_TO_PREV_SCREEN[\"RETURN-TO-PREV-SCREEN\"]\n    SEND_AUTHVIEW_SCREEN[\"SEND-AUTHVIEW-SCREEN\"]\n    POPULATE_AUTH_DETAILS[\"POPULATE-AUTH-DETAILS\"]\n    READ_AUTH_RECORD[\"READ-AUTH-RECORD\"]\n    ROLL_BACK[\"ROLL-BACK\"]\n    UPDATE_AUTH_DETAILS[\"UPDATE-AUTH-DETAILS\"]\n    WS_PGM_AUTH_FRAUD__ext([\"WS-PGM-AUTH-FRAUD\"])\n    POPULATE_HEADER_INFO[\"POPULATE-HEADER-INFO\"]\n    TAKE_SYNCPOINT[\"TAKE-SYNCPOINT\"]\n    READ_NEXT_AUTH_RECORD[\"READ-NEXT-AUTH-RECORD\"]\n    SCHEDULE_PSB[\"SCHEDULE-PSB\"]\n    CDEMO_TO_PROGRAM__ext([\"CDEMO-TO-PROGRAM\"])\n    MAIN_PARA --> MARK_AUTH_FRAUD\n    MAIN_PARA --> PROCESS_ENTER_KEY\n    MAIN_PARA --> PROCESS_PF8_KEY\n    MAIN_PARA --> RECEIVE_AUTHVIEW_SCREEN\n    MAIN_PARA --> RETURN_TO_PREV_SCREEN\n    MAIN_PARA --> SEND_AUTHVIEW_SCREEN\n    MARK_AUTH_FRAUD --> POPULATE_AUTH_DETAILS\n    MARK_AUTH_FRAUD --> READ_AUTH_RECORD\n    MARK_AUTH_FRAUD --> ROLL_BACK\n    MARK_AUTH_FRAUD --> UPDATE_AUTH_DETAILS\n    MARK_AUTH_FRAUD -.->|calls| WS_PGM_AUTH_FRAUD__ext\n    PROCESS_ENTER_KEY --> POPULATE_AUTH_DETAILS\n    PROCESS_ENTER_KEY --> READ_AUTH_RECORD\n    PROCESS_ENTER_KEY --> TAKE_SYNCPOINT\n    PROCESS_PF8_KEY --> POPULATE_AUTH_DETAILS\n    PROCESS_PF8_KEY --> READ_AUTH_RECORD\n    PROCESS_PF8_KEY --> READ_NEXT_AUTH_RECORD\n    PROCESS_PF8_KEY --> TAKE_SYNCPOINT\n    READ_AUTH_RECORD --> SCHEDULE_PSB\n    READ_AUTH_RECORD --> SEND_AUTHVIEW_SCREEN\n    READ_NEXT_AUTH_RECORD --> SEND_AUTHVIEW_SCREEN\n    RETURN_TO_PREV_SCREEN -.->|calls| CDEMO_TO_PROGRAM__ext\n    SCHEDULE_PSB --> SEND_AUTHVIEW_SCREEN\n    SEND_AUTHVIEW_SCREEN --> POPULATE_HEADER_INFO\n    UPDATE_AUTH_DETAILS --> ROLL_BACK\n    UPDATE_AUTH_DETAILS --> SEND_AUTHVIEW_SCREEN\n    UPDATE_AUTH_DETAILS --> TAKE_SYNCPOINT"
}