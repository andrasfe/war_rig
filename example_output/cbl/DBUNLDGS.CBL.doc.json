{
  "header": {
    "program_id": "DBUNLDGS",
    "file_name": "cbl/DBUNLDGS.CBL",
    "file_type": "COBOL",
    "analyzed_by": "WAR_RIG",
    "analyzed_at": "2026-01-27T02:43:04.043604",
    "iteration_count": 1,
    "final_status": null
  },
  "purpose": {
    "summary": "This IMS DL/I batch program unloads pending authorization data from the PAUT hierarchical database by sequentially reading root PENDING-AUTH-SUMMARY (PAUTSUM0) segments using GN calls and associated child PENDING-AUTH-DETAILS (PAUTDTL1) segments using GNP calls via PAUTBPCB. It then inserts the unloaded root segments into the PASFL GSAM database and child segments into the PADFL GSAM database using ISRT calls via respective PCBs. Processing skips root and children if PA-ACCT-ID is not numeric, and maintains counters for processed records.",
    "business_context": "Supports unloading of pending authorization summary and detail records from IMS PAUT database to GSAM structures, likely for data migration, archiving, or flat file processing in an authorization system.",
    "program_type": "BATCH",
    "citations": [
      18,
      164,
      170,
      172,
      216,
      263,
      300,
      319
    ]
  },
  "inputs": [
    {
      "name": "PAUTBPCB",
      "io_type": "OTHER",
      "description": "Linkage IMS PCB parameter providing access to read PENDING-AUTH-SUMMARY root segments and PENDING-AUTH-DETAILS child segments from PAUT IMS database",
      "copybook": "PAUTBPCB",
      "citation": [
        159,
        222,
        268
      ]
    }
  ],
  "outputs": [
    {
      "name": "PASFLPCB",
      "io_type": "IMS_SEGMENT",
      "description": "Linkage IMS PCB for GSAM database receiving inserted PENDING-AUTH-SUMMARY root segments",
      "copybook": "PASFLPCB",
      "citation": [
        303
      ]
    },
    {
      "name": "PADFLPCB",
      "io_type": "IMS_SEGMENT",
      "description": "Linkage IMS PCB for GSAM database receiving inserted PENDING-AUTH-DETAILS child segments",
      "copybook": "PADFLPCB",
      "citation": [
        322
      ]
    }
  ],
  "called_programs": [],
  "calling_context": {
    "called_by": [],
    "entry_points": [
      "DLITCBL"
    ],
    "linkage_section": [
      "PAUTBPCB",
      "PASFLPCB",
      "PADFLPCB"
    ]
  },
  "business_rules": [
    {
      "rule_id": "BR001",
      "description": "Skip insertion of summary segment and processing of its detail children if the account ID is not numeric",
      "logic_summary": "Checks PA-ACCT-ID IS NUMERIC before performing parent insert and child loop",
      "conditions": [
        "PA-ACCT-ID IS NUMERIC"
      ],
      "citation": [
        241
      ]
    }
  ],
  "data_flow": {
    "reads_from": [
      {
        "source": "PAUTBPCB",
        "fields_used": [
          "PA-ACCT-ID"
        ],
        "citation": [
          222,
          239
        ]
      },
      {
        "source": "PAUTBPCB",
        "fields_used": [
          "PENDING-AUTH-DETAILS fields"
        ],
        "citation": [
          268
        ]
      }
    ],
    "writes_to": [
      {
        "destination": "PASFLPCB",
        "fields_written": [
          "PENDING-AUTH-SUMMARY"
        ],
        "citation": [
          303
        ]
      },
      {
        "destination": "PADFLPCB",
        "fields_written": [
          "PENDING-AUTH-DETAILS"
        ],
        "citation": [
          322
        ]
      }
    ],
    "transforms": [
      {
        "input_field": "PENDING-AUTH-SUMMARY",
        "output_field": "PENDING-AUTH-SUMMARY",
        "transformation_description": "Direct copy from IMS I/O area to GSAM insert without modification after GN read",
        "citation": [
          236,
          303
        ]
      },
      {
        "input_field": "PENDING-AUTH-DETAILS",
        "output_field": "PENDING-AUTH-DETAILS",
        "transformation_description": "Direct copy from IMS I/O area to GSAM insert without modification after GNP read",
        "citation": [
          280,
          322
        ]
      }
    ]
  },
  "copybooks_used": [
    {
      "copybook_name": "IMSFUNCS",
      "purpose": "Defines IMS DL/I function codes such as FUNC-GN, FUNC-GNP, FUNC-ISRT",
      "location": "WORKING_STORAGE",
      "citation": 136
    },
    {
      "copybook_name": "CIPAUSMY",
      "purpose": "Defines layout of PENDING-AUTH-SUMMARY root segment (PAUTSUM0)",
      "location": "WORKING_STORAGE",
      "citation": 143
    },
    {
      "copybook_name": "CIPAUDTY",
      "purpose": "Defines layout of PENDING-AUTH-DETAILS child segment (PAUTDTL1)",
      "location": "WORKING_STORAGE",
      "citation": 147
    },
    {
      "copybook_name": "PAUTBPCB",
      "purpose": "Defines PCB mask for source PAUT IMS database",
      "location": "LINKAGE",
      "citation": 154
    },
    {
      "copybook_name": "PASFLPCB",
      "purpose": "Defines PCB mask for target PASFL GSAM database",
      "location": "LINKAGE",
      "citation": 155
    },
    {
      "copybook_name": "PADFLPCB",
      "purpose": "Defines PCB mask for target PADFL GSAM database",
      "location": "LINKAGE",
      "citation": 156
    }
  ],
  "paragraphs": [
    {
      "paragraph_name": "MAIN-PARA",
      "summary": null,
      "purpose": "This paragraph serves as the primary orchestration point and entry point for the program, including an alternate ENTRY 'DLITCBL' for potential dynamic invocation using the same linkage PCBs. It consumes the linkage section PCBs PAUTBPCB, PASFLPCB, and PADFLPCB passed via PROCEDURE DIVISION USING at line 159. It begins by performing 1000-INITIALIZE to accept system dates and display startup messages. It then enters a loop at lines 172-173 that repeatedly performs 2000-FIND-NEXT-AUTH-SUMMARY until WS-END-OF-ROOT-SEG is set to 'Y', processing all root summaries and their children from IMS to GSAM. After the loop completes upon end-of-database, it performs 4000-FILE-CLOSE to display a closing message, though actual file closes are commented out. No direct data outputs are produced here; outputs occur via subordinate inserts in GSAM databases. Business logic is implicit in the loop control based on end-of-root flag set during reads. No explicit error handling occurs in this paragraph; subordinate paragraphs handle errors by abending. It calls 1000-INITIALIZE for setup, 2000-FIND-NEXT-AUTH-SUMMARY for core processing loop, and 4000-FILE-CLOSE for termination.",
      "called_by": [],
      "calls": [
        "1000-INITIALIZE",
        "2000-FIND-NEXT-AUTH-SUMMARY",
        "4000-FILE-CLOSE"
      ],
      "citation": [
        164,
        179
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "1000-INITIALIZE",
      "summary": null,
      "purpose": "This initialization paragraph sets up runtime variables and displays program startup information. It consumes system date via ACCEPT statements at lines 185-186 into CURRENT-DATE and CURRENT-YYDDD. No files are opened as those statements are commented out at lines 195-209. It produces display output to console with program start message, date, and decorative lines at 189-192. No business decisions or validations are performed. No error handling is present since no I/O occurs. No subordinate calls are made. Control returns to caller via 1000-EXIT at line 212.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [],
      "citation": [
        182,
        213
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "2000-FIND-NEXT-AUTH-SUMMARY",
      "summary": null,
      "purpose": "This paragraph handles reading the next root PENDING-AUTH-SUMMARY segment from PAUT IMS database and orchestrates processing of the root and its children. It consumes the current position in PAUTBPCB and reads via CBLTDLI GN call at lines 222-225 into PENDING-AUTH-SUMMARY I/O area using ROOT-UNQUAL-SSA. If PAUT-PCB-STATUS is spaces (success) at line 232, it increments summary read and process counters at 234-235, moves segment to WS OPFIL1-REC at 236, initializes keys and child rec at 237-238, moves PA-ACCT-ID to ROOT-SEG-KEY at 239. It then checks if PA-ACCT-ID IS NUMERIC at 241; if yes, performs 3100-INSERT-PARENT-SEG-GSAM at 243 to insert into PASFL GSAM, initializes child end flag at 244, and loops PERFORM 3000-FIND-NEXT-AUTH-DTL until WS-END-OF-CHILD-SEG='Y' at 245-246 to process all children under this root. If PAUT-PCB-STATUS='GB' (end-of-db) at 249, sets end flags at 250-251. If other error status at 253, displays feedback and abends via 9999-ABEND at 256. Business logic enforces numeric account ID for processing to avoid invalid inserts. Error handling abends on unexpected IMS statuses.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [
        "3100-INSERT-PARENT-SEG-GSAM",
        "3000-FIND-NEXT-AUTH-DTL"
      ],
      "citation": [
        216,
        259
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "3000-FIND-NEXT-AUTH-DTL",
      "summary": null,
      "purpose": "This paragraph reads the next child PENDING-AUTH-DETAILS segment under the current root using GNP positioned by prior GN. It consumes current PCB position in PAUTBPCB and calls CBLTDLI GNP at lines 267-270 into PENDING-AUTH-DETAILS using CHILD-UNQUAL-SSA. If PAUT-PCB-STATUS=spaces (success) at 276, sets MORE-AUTHS flag at 277, increments WS-NO-SUMRY-READ and WS-AUTH-SMRY-PROC-CNT counters at 278-279 (note: counters named for summary but used here), moves segment to CHILD-SEG-REC at 280, and performs 3200-INSERT-CHILD-SEG-GSAM at 282 to insert into PADFL GSAM. If PAUT-PCB-STATUS='GE' (segment not found, end of children) at 284, sets WS-END-OF-CHILD-SEG='Y' at 286 and displays flag. If other error at 290, displays status/feedback and abends at 293. Finally initializes PAUT-PCB-STATUS at 295. No business decisions beyond IMS status checks. Error handling abends on non-success/non-end statuses. Called repeatedly from 2000 until child end.",
      "called_by": [
        "2000-FIND-NEXT-AUTH-SUMMARY"
      ],
      "calls": [
        "3200-INSERT-CHILD-SEG-GSAM"
      ],
      "citation": [
        263,
        297
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "3100-INSERT-PARENT-SEG-GSAM",
      "summary": null,
      "purpose": "This utility paragraph inserts the current PENDING-AUTH-SUMMARY root segment into the PASFL GSAM database. It consumes the segment data in PENDING-AUTH-SUMMARY I/O area populated from prior GN read. Performs CBLTDLI ISRT call at lines 302-304 using PASFLPCB. Produces the inserted segment in PASFL GSAM. No transformations or validations performed. If PASFL-PCB-STATUS not spaces at 311, displays error/KEYFB and abends via 9999-ABEND at 314. No subordinate calls. Business logic is direct insert assuming valid data from read.",
      "called_by": [
        "2000-FIND-NEXT-AUTH-SUMMARY"
      ],
      "calls": [],
      "citation": [
        300,
        317
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "3200-INSERT-CHILD-SEG-GSAM",
      "summary": null,
      "purpose": "This utility paragraph inserts the current PENDING-AUTH-DETAILS child segment into the PADFL GSAM database. It consumes the segment data in PENDING-AUTH-DETAILS I/O area from prior GNP read. Performs CBLTDLI ISRT call at lines 321-323 using PADFLPCB. Produces the inserted segment in PADFL GSAM. No transformations or validations. If PADFL-PCB-STATUS not spaces at 330, displays error/KEYFB and abends at 333. No subordinate calls. Direct insert assuming valid positioned context from parent.",
      "called_by": [
        "3000-FIND-NEXT-AUTH-DTL"
      ],
      "calls": [],
      "citation": [
        319,
        336
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "4000-FILE-CLOSE",
      "summary": null,
      "purpose": "This termination paragraph handles program closeout by displaying a closing message at 339. It consumes no data inputs as file CLOSE statements are commented out at 340 and 347. Produces console display output. No business logic or decisions. No error handling since no active I/O. No calls made. Though labeled for file close, actual closes and status checks are commented, so effectively just a display.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [],
      "citation": [
        338,
        355
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "9999-ABEND",
      "summary": null,
      "purpose": "This error termination paragraph abends the program on IMS call failures or other errors. It consumes no specific inputs but is invoked on error conditions from other paragraphs. Displays abend message at 360. Sets RETURN-CODE to 16 at 362 and GOBACKs at 363. No validations or subordinate calls. Serves as centralized error exit point, halting execution with non-zero return.",
      "called_by": [
        "2000-FIND-NEXT-AUTH-SUMMARY",
        "3000-FIND-NEXT-AUTH-DTL",
        "3100-INSERT-PARENT-SEG-GSAM",
        "3200-INSERT-CHILD-SEG-GSAM"
      ],
      "calls": [],
      "citation": [
        357,
        366
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    }
  ],
  "error_handling": [
    {
      "condition": "PAUT-PCB-STATUS NOT = SPACES AND NOT = 'GB'",
      "action": "DISPLAY status and KEYFB, then PERFORM 9999-ABEND",
      "citation": [
        253
      ]
    },
    {
      "condition": "PAUT-PCB-STATUS NOT = SPACES AND NOT = 'GE'",
      "action": "DISPLAY status and KEYFB, then PERFORM 9999-ABEND",
      "citation": [
        290
      ]
    },
    {
      "condition": "PASFL-PCB-STATUS NOT = SPACES",
      "action": "DISPLAY status and KEYFB, then PERFORM 9999-ABEND",
      "citation": [
        311
      ]
    },
    {
      "condition": "PADFL-PCB-STATUS NOT = SPACES",
      "action": "DISPLAY status and KEYFB, then PERFORM 9999-ABEND",
      "citation": [
        330
      ]
    }
  ],
  "sql_operations": [],
  "cics_operations": [],
  "open_questions": [
    {
      "question": "Why does 3000-FIND-NEXT-AUTH-DTL increment WS-NO-SUMRY-READ and WS-AUTH-SMRY-PROC-CNT (lines 278-279) instead of detail-specific counters WS-NO-DTL-READ/WS-NO-DTL-DELETED?",
      "context": "Code increments summary counters during child processing, which may be a naming/logic error as variables suggest separation at lines 70-73",
      "suggestion": "Review variable usage or check if intentional aggregation"
    },
    {
      "question": "Purpose of MOVE PA-ACCT-ID TO ROOT-SEG-KEY (line 239) and preparation of OPFIL1-REC/OPFIL2-REC since no WRITE occurs (commented)?",
      "context": "Records prepared in WS at 236/280 but files commented out; ROOT-SEG-KEY in child rec structure unused in IMS calls",
      "suggestion": "Likely remnant of prior sequential file version; confirm if vestigial"
    }
  ],
  "dead_code": [],
  "flow_diagram": "flowchart TD\n    %% Title: DBUNLDGS.CBL\n    1000_EXIT[\"1000-EXIT\"]\n    1000_INITIALIZE[\"1000-INITIALIZE\"]\n    2000_EXIT[\"2000-EXIT\"]\n    2000_FIND_NEXT_AUTH_SUMMARY[\"2000-FIND-NEXT-AUTH-SUMMARY\"]\n    3000_FIND_NEXT_AUTH_DTL[\"3000-FIND-NEXT-AUTH-DTL\"]\n    3100_INSERT_PARENT_SEG_GSAM[\"3100-INSERT-PARENT-SEG-GSAM\"]\n    9999_ABEND[\"9999-ABEND\"]\n    CBLTDLI__ext([\"CBLTDLI\"])\n    3000_EXIT[\"3000-EXIT\"]\n    3200_INSERT_CHILD_SEG_GSAM[\"3200-INSERT-CHILD-SEG-GSAM\"]\n    3100_EXIT[\"3100-EXIT\"]\n    3200_EXIT[\"3200-EXIT\"]\n    4000_EXIT[\"4000-EXIT\"]\n    4000_FILE_CLOSE[\"4000-FILE-CLOSE\"]\n    9999_EXIT[\"9999-EXIT\"]\n    MAIN_PARA[\"MAIN-PARA\"]\n    2000_FIND_NEXT_AUTH_SUMMARY --> 3000_FIND_NEXT_AUTH_DTL\n    2000_FIND_NEXT_AUTH_SUMMARY --> 3100_INSERT_PARENT_SEG_GSAM\n    2000_FIND_NEXT_AUTH_SUMMARY --> 9999_ABEND\n    2000_FIND_NEXT_AUTH_SUMMARY -.->|calls| CBLTDLI__ext\n    3000_FIND_NEXT_AUTH_DTL --> 3200_INSERT_CHILD_SEG_GSAM\n    3000_FIND_NEXT_AUTH_DTL --> 9999_ABEND\n    3000_FIND_NEXT_AUTH_DTL -.->|calls| CBLTDLI__ext\n    3100_INSERT_PARENT_SEG_GSAM --> 9999_ABEND\n    3100_INSERT_PARENT_SEG_GSAM -.->|calls| CBLTDLI__ext\n    3200_INSERT_CHILD_SEG_GSAM --> 9999_ABEND\n    3200_INSERT_CHILD_SEG_GSAM -.->|calls| CBLTDLI__ext\n    MAIN_PARA --> 1000_INITIALIZE\n    MAIN_PARA --> 2000_FIND_NEXT_AUTH_SUMMARY\n    MAIN_PARA --> 4000_FILE_CLOSE"
}