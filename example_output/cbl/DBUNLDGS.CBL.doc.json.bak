{
  "header": {
    "program_id": "DBUNLDGS",
    "file_name": "DBUNLDGS.CBL",
    "file_type": "COBOL",
    "analyzed_by": "WAR_RIG",
    "analyzed_at": "2026-02-24T17:43:44.226557",
    "iteration_count": 1,
    "final_status": null
  },
  "purpose": {
    "summary": "The COBOL program DBUNLDGS is designed to unload data from an IMS database. It retrieves pending authorization summary and detail segments and writes them to output files. The program initializes, retrieves summary records, and then closes the files upon completion.",
    "business_context": "UNKNOWN",
    "program_type": "BATCH",
    "citations": [
      18,
      147,
      175
    ]
  },
  "inputs": [
    {
      "name": "IMS Database",
      "io_type": "IMS_SEGMENT",
      "description": "Pending authorization summary and detail segments from an IMS database.",
      "copybook": "CIPAUSMY, CIPAUDTY",
      "citation": [
        143,
        147
      ]
    },
    {
      "name": "PAUTBPCB",
      "io_type": "PARAMETER",
      "description": "Pending Authorization PCB mask.",
      "copybook": "PAUTBPCB",
      "citation": [
        159,
        165
      ]
    },
    {
      "name": "PASFLPCB",
      "io_type": "PARAMETER",
      "description": "Pending Authorization Summary File PCB mask.",
      "copybook": "PASFLPCB",
      "citation": [
        160,
        166
      ]
    },
    {
      "name": "PADFLPCB",
      "io_type": "PARAMETER",
      "description": "Pending Authorization Detail File PCB mask.",
      "copybook": "PADFLPCB",
      "citation": [
        161,
        167
      ]
    }
  ],
  "outputs": [
    {
      "name": "OPFILE1",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Output file containing data from the IMS database. The structure is defined by OPFIL1-REC.",
      "copybook": null,
      "citation": []
    },
    {
      "name": "OPFILE2",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Output file containing data from the IMS database. The structure is defined by OPFIL2-REC, containing a root segment key and a child segment record.",
      "copybook": null,
      "citation": []
    }
  ],
  "called_programs": [],
  "calling_context": {
    "called_by": [],
    "entry_points": [
      "DLITCBL"
    ],
    "linkage_section": [
      "PAUTBPCB",
      "PASFLPCB",
      "PADFLPCB"
    ]
  },
  "business_rules": [
    {
      "rule_id": "BR001",
      "description": "The program continues processing as long as the end-of-root-segment flag is not set to 'Y'.",
      "logic_summary": "The program loops through the 2000-FIND-NEXT-AUTH-SUMMARY paragraph until WS-END-OF-ROOT-SEG is equal to 'Y'.",
      "conditions": [
        "WS-END-OF-ROOT-SEG = 'Y'"
      ],
      "citation": [
        173
      ]
    }
  ],
  "data_flow": {
    "reads_from": [
      {
        "source": "IMS Database",
        "fields_used": [
          "PENDING-AUTH-SUMMARY",
          "PENDING-AUTH-DETAILS"
        ],
        "citation": [
          143,
          147
        ]
      }
    ],
    "writes_to": [
      {
        "destination": "OPFILE1",
        "fields_written": [
          "OPFIL1-REC"
        ],
        "citation": []
      },
      {
        "destination": "OPFILE2",
        "fields_written": [
          "ROOT-SEG-KEY",
          "CHILD-SEG-REC"
        ],
        "citation": []
      }
    ],
    "transforms": []
  },
  "copybooks_used": [
    {
      "copybook_name": "IMSFUNCS",
      "purpose": "Contains IMS function definitions.",
      "location": "WORKING_STORAGE",
      "citation": 116
    },
    {
      "copybook_name": "CIPAUSMY",
      "purpose": "Defines the layout of the PENDING-AUTH-SUMMARY segment.",
      "location": "WORKING_STORAGE",
      "citation": 123
    },
    {
      "copybook_name": "CIPAUDTY",
      "purpose": "Defines the layout of the PENDING-AUTH-DETAILS segment.",
      "location": "WORKING_STORAGE",
      "citation": 127
    },
    {
      "copybook_name": "PAUTBPCB",
      "purpose": "Defines the PCB mask for the Pending Authorization database.",
      "location": "LINKAGE",
      "citation": 134
    },
    {
      "copybook_name": "PASFLPCB",
      "purpose": "Defines the PCB mask for the Pending Authorization Summary File.",
      "location": "LINKAGE",
      "citation": 1341
    },
    {
      "copybook_name": "PADFLPCB",
      "purpose": "Defines the PCB mask for the Pending Authorization Detail File.",
      "location": "LINKAGE",
      "citation": 1342
    }
  ],
  "paragraphs": [
    {
      "paragraph_name": "MAIN-PARA",
      "summary": null,
      "purpose": "This is the main paragraph of the DBUNLDGS program. It serves as the entry point and orchestrates the overall program flow. It first performs the 1000-INITIALIZE paragraph to set up the program environment, including accepting the current date and displaying program start messages. Then, it enters a loop, repeatedly performing the 2000-FIND-NEXT-AUTH-SUMMARY paragraph to retrieve and process pending authorization summary records from the IMS database. The loop continues until the WS-END-OF-ROOT-SEG flag is set to 'Y', indicating that all summary records have been processed. Finally, it performs the 4000-FILE-CLOSE paragraph to close the output files and terminates the program using GOBACK. The paragraph uses PAUTBPCB, PASFLPCB and PADFLPCB from the linkage section.",
      "called_by": [],
      "calls": [
        "1000-INITIALIZE",
        "2000-FIND-NEXT-AUTH-SUMMARY",
        "4000-FILE-CLOSE"
      ],
      "citation": [
        141,
        154
      ],
      "outgoing_calls": [
        {
          "target": "1000-INITIALIZE",
          "call_type": "performs",
          "line": 170
        },
        {
          "target": "2000-FIND-NEXT-AUTH-SUMMARY",
          "call_type": "performs",
          "line": 172
        },
        {
          "target": "4000-FILE-CLOSE",
          "call_type": "performs",
          "line": 175
        }
      ],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "1000-INITIALIZE",
      "summary": null,
      "purpose": "This paragraph initializes the program environment. It accepts the current date and day from the system and stores them in CURRENT-DATE and CURRENT-YYDDD, respectively. It then displays a series of messages to the console indicating the start of the program and the current date. The commented-out code suggests that it was intended to accept parameters from SYSIN and open output files OPFILE1 and OPFILE2, with error handling for file open failures. However, these file operations are currently commented out. The paragraph consumes system date and day, and displays messages to the console. It does not directly produce any output data, but sets up the environment for subsequent processing. It does not call any other paragraphs.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [],
      "citation": [
        157,
        169
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    }
  ],
  "error_handling": [],
  "sql_operations": [],
  "cics_operations": [],
  "open_questions": [
    {
      "question": "What is the purpose of the IMSFUNCS copybook?",
      "context": "The code includes the IMSFUNCS copybook, but its contents and usage are not evident in the provided snippet.",
      "suggestion": "Examine the contents of IMSFUNCS to determine its role in the program."
    },
    {
      "question": "What are the exact record layouts for OPFILE1 and OPFILE2?",
      "context": "The file definitions for OPFILE1 and OPFILE2 are commented out, so their exact structure and content are unclear.",
      "suggestion": "Uncomment the file definitions in the FILE SECTION to determine their record layouts."
    },
    {
      "question": "What is the purpose of the 2000-FIND-NEXT-AUTH-SUMMARY and 4000-FILE-CLOSE paragraphs?",
      "context": "The code for these paragraphs is not provided in the snippet.",
      "suggestion": "Provide the code for these paragraphs to fully understand the program's functionality."
    },
    {
      "question": "What are the contents of the PASFLPCB and PADFLPCB copybooks?",
      "context": "The copybooks PASFLPCB and PADFLPCB are included, but their contents are not shown.",
      "suggestion": "Provide the contents of these copybooks to understand the structure of the Pending Authorization Summary File and Detail File PCBs."
    }
  ],
  "resolved_questions": [],
  "dead_code": [],
  "call_semantics": [
    {
      "caller": "MAIN-PARA",
      "callee": "1000-INITIALIZE",
      "inputs": [],
      "outputs": [
        "CURRENT-DATE",
        "CURRENT-YYDDD"
      ],
      "purpose": "Initializes the program by accepting current date and day from system and displaying startup information."
    },
    {
      "caller": "MAIN-PARA",
      "callee": "2000-FIND-NEXT-AUTH-SUMMARY",
      "inputs": [],
      "outputs": [
        "WS-END-OF-ROOT-SEG",
        "WS-NO-SUMRY-READ",
        "WS-AUTH-SMRY-PROC-CNT",
        "OPFIL1-REC",
        "ROOT-SEG-KEY",
        "CHILD-SEG-REC"
      ],
      "purpose": "Reads the next root segment from the IMS database and processes it if found, setting end-of-segment flag when complete."
    },
    {
      "caller": "MAIN-PARA",
      "callee": "4000-FILE-CLOSE",
      "inputs": [],
      "outputs": [],
      "purpose": "Displays a message indicating that the file is being closed."
    },
    {
      "caller": "2000-FIND-NEXT-AUTH-SUMMARY",
      "callee": "3100-INSERT-PARENT-SEG-GSAM",
      "inputs": [
        "PENDING-AUTH-SUMMARY"
      ],
      "outputs": [],
      "purpose": "Inserts the parent segment into the GSAM database using IMS call and abends if the insertion fails."
    },
    {
      "caller": "2000-FIND-NEXT-AUTH-SUMMARY",
      "callee": "3000-FIND-NEXT-AUTH-DTL",
      "inputs": [],
      "outputs": [
        "WS-END-OF-CHILD-SEG",
        "WS-NO-SUMRY-READ",
        "WS-AUTH-SMRY-PROC-CNT",
        "CHILD-SEG-REC"
      ],
      "purpose": "Finds and processes the next child segment in the IMS database, inserting it into GSAM and marking end-of-child-segment when no more exist."
    },
    {
      "caller": "2000-FIND-NEXT-AUTH-SUMMARY",
      "callee": "9999-ABEND",
      "inputs": [],
      "outputs": [],
      "purpose": "Terminates the program with return code 16 when an IMS call fails unexpectedly."
    },
    {
      "caller": "3000-FIND-NEXT-AUTH-DTL",
      "callee": "3200-INSERT-CHILD-SEG-GSAM",
      "inputs": [
        "PENDING-AUTH-DETAILS"
      ],
      "outputs": [],
      "purpose": "Writes the retrieved child segment data to a GSAM output file using IMS ISRT call."
    },
    {
      "caller": "3000-FIND-NEXT-AUTH-DTL",
      "callee": "9999-ABEND",
      "inputs": [],
      "outputs": [],
      "purpose": "Terminates the program with return code 16 when the IMS GNP call for child segment fails."
    },
    {
      "caller": "3100-INSERT-PARENT-SEG-GSAM",
      "callee": "9999-ABEND",
      "inputs": [],
      "outputs": [],
      "purpose": "Terminates the program with return code 16 when the IMS ISRT call for parent segment insertion fails."
    },
    {
      "caller": "3200-INSERT-CHILD-SEG-GSAM",
      "callee": "9999-ABEND",
      "inputs": [],
      "outputs": [],
      "purpose": "Terminates the program with return code 16 when the IMS ISRT call for child segment insertion fails."
    }
  ],
  "flow_diagram": "flowchart TD\n    %% Title: DBUNLDGS.CBL\n    1000_EXIT[\"1000-EXIT\"]\n    1000_INITIALIZE[\"1000-INITIALIZE\"]\n    2000_EXIT[\"2000-EXIT\"]\n    2000_FIND_NEXT_AUTH_SUMMARY[\"2000-FIND-NEXT-AUTH-SUMMARY\"]\n    3000_FIND_NEXT_AUTH_DTL[\"3000-FIND-NEXT-AUTH-DTL\"]\n    3100_INSERT_PARENT_SEG_GSAM[\"3100-INSERT-PARENT-SEG-GSAM\"]\n    9999_ABEND[\"9999-ABEND\"]\n    CBLTDLI__ext([\"CBLTDLI\"])\n    3000_EXIT[\"3000-EXIT\"]\n    3200_INSERT_CHILD_SEG_GSAM[\"3200-INSERT-CHILD-SEG-GSAM\"]\n    3100_EXIT[\"3100-EXIT\"]\n    3200_EXIT[\"3200-EXIT\"]\n    4000_EXIT[\"4000-EXIT\"]\n    4000_FILE_CLOSE[\"4000-FILE-CLOSE\"]\n    9999_EXIT[\"9999-EXIT\"]\n    MAIN_PARA[\"MAIN-PARA\"]\n    2000_FIND_NEXT_AUTH_SUMMARY --> 3000_FIND_NEXT_AUTH_DTL\n    2000_FIND_NEXT_AUTH_SUMMARY --> 3100_INSERT_PARENT_SEG_GSAM\n    2000_FIND_NEXT_AUTH_SUMMARY --> 9999_ABEND\n    2000_FIND_NEXT_AUTH_SUMMARY -.->|calls| CBLTDLI__ext\n    3000_FIND_NEXT_AUTH_DTL --> 3200_INSERT_CHILD_SEG_GSAM\n    3000_FIND_NEXT_AUTH_DTL --> 9999_ABEND\n    3000_FIND_NEXT_AUTH_DTL -.->|calls| CBLTDLI__ext\n    3100_INSERT_PARENT_SEG_GSAM --> 9999_ABEND\n    3100_INSERT_PARENT_SEG_GSAM -.->|calls| CBLTDLI__ext\n    3200_INSERT_CHILD_SEG_GSAM --> 9999_ABEND\n    3200_INSERT_CHILD_SEG_GSAM -.->|calls| CBLTDLI__ext\n    MAIN_PARA --> 1000_INITIALIZE\n    MAIN_PARA --> 2000_FIND_NEXT_AUTH_SUMMARY\n    MAIN_PARA --> 4000_FILE_CLOSE"
}