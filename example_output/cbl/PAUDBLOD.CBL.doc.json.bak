{
  "header": {
    "program_id": "PAUDBLOD",
    "file_name": "cbl/PAUDBLOD.CBL",
    "file_type": "COBOL",
    "analyzed_by": "WAR_RIG",
    "analyzed_at": "2026-01-26T15:16:42.514450",
    "iteration_count": 1,
    "final_status": null
  },
  "purpose": {
    "summary": "PAUDBLOD is a batch IMS database loader that reads root segment records (PAUTSUM0 pending authorization summaries) from INFILE1 and inserts them into the IMS database using ISRT calls. It then reads child segment records (PAUTDTL1 pending authorization details) from INFILE2, qualifies the corresponding root segment via GU using the root key, and inserts the child segments using ISRT. Duplicate segments (status 'II') are skipped with a display message, while other IMS errors cause abend.",
    "business_context": "Supports loading of pending authorization summary and detail data into IMS database PAUT for financial or authorization processing workflows",
    "program_type": "BATCH",
    "citations": [
      18,
      26,
      32,
      45,
      169,
      177,
      180,
      244,
      296,
      321
    ]
  },
  "inputs": [
    {
      "name": "INFILE1",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Sequential file containing root segment records (PAUTSUM0) in 100-byte fixed format mapped to PENDING-AUTH-SUMMARY",
      "copybook": "CIPAUSMY",
      "citation": [
        226,
        229
      ]
    },
    {
      "name": "INFILE2",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Sequential file containing child segment records prefixed with 11-digit COMP-3 root key (PAUTDTL1) mapped to PENDING-AUTH-DETAILS",
      "copybook": "CIPAUDTY",
      "citation": [
        272,
        277,
        280
      ]
    }
  ],
  "outputs": [
    {
      "name": "PAUTSUM0",
      "io_type": "IMS_SEGMENT",
      "description": "IMS root segment (Pending Authorization Summary) loaded via unqualified ISRT",
      "copybook": "CIPAUSMY",
      "citation": [
        244
      ]
    },
    {
      "name": "PAUTDTL1",
      "io_type": "IMS_SEGMENT",
      "description": "IMS child segment (Pending Authorization Details) loaded via unqualified ISRT under qualified parent root",
      "copybook": "CIPAUDTY",
      "citation": [
        321
      ]
    }
  ],
  "called_programs": [],
  "calling_context": {
    "called_by": [],
    "entry_points": [
      "DLITCBL"
    ],
    "linkage_section": [
      "IO-PCB-MASK",
      "PAUTBPCB"
    ]
  },
  "business_rules": [
    {
      "rule_id": "BR001",
      "description": "Child segments are only processed if the ROOT-SEG-KEY field is numeric",
      "logic_summary": "IS NUMERIC check before GU/ISRT; skips non-numeric records silently",
      "conditions": [
        "ROOT-SEG-KEY IS NUMERIC"
      ],
      "citation": [
        275
      ]
    },
    {
      "rule_id": "BR002",
      "description": "Duplicate segments (IMS status 'II') are tolerated and skipped without abending",
      "logic_summary": "Checks PAUT-PCB-STATUS after ISRT; displays message if 'II' and continues",
      "conditions": [
        "PAUT-PCB-STATUS = 'II'"
      ],
      "citation": [
        256,
        329
      ]
    },
    {
      "rule_id": "BR003",
      "description": "All root segments are loaded before any child segments to ensure parent existence",
      "logic_summary": "Sequential loop exhausts INFILE1 before processing INFILE2",
      "conditions": [
        "END-ROOT-SEG-FILE = 'Y'",
        "END-CHILD-SEG-FILE = 'Y'"
      ],
      "citation": [
        177,
        180
      ]
    }
  ],
  "data_flow": {
    "reads_from": [
      {
        "source": "INFILE1",
        "fields_used": [
          "INFIL1-REC"
        ],
        "citation": [
          226
        ]
      },
      {
        "source": "INFILE2",
        "fields_used": [
          "ROOT-SEG-KEY",
          "CHILD-SEG-REC"
        ],
        "citation": [
          272
        ]
      }
    ],
    "writes_to": [
      {
        "destination": "PAUTSUM0 IMS segment",
        "fields_written": [
          "PENDING-AUTH-SUMMARY"
        ],
        "citation": [
          244
        ]
      },
      {
        "destination": "PAUTDTL1 IMS segment",
        "fields_written": [
          "PENDING-AUTH-DETAILS"
        ],
        "citation": [
          321
        ]
      }
    ],
    "transforms": [
      {
        "input_field": "ROOT-SEG-KEY",
        "output_field": "QUAL-SSA-KEY-VALUE",
        "transformation_description": "Direct MOVE to populate qualified SSA for parent GU",
        "citation": [
          277
        ]
      },
      {
        "input_field": "INFIL1-REC",
        "output_field": "PENDING-AUTH-SUMMARY",
        "transformation_description": "Direct MOVE of entire 100-byte record to IMS segment layout",
        "citation": [
          229
        ]
      },
      {
        "input_field": "CHILD-SEG-REC",
        "output_field": "PENDING-AUTH-DETAILS",
        "transformation_description": "Direct MOVE of 200-byte child record data to IMS segment layout",
        "citation": [
          280
        ]
      }
    ]
  },
  "copybooks_used": [
    {
      "copybook_name": "IMSFUNCS",
      "purpose": "Defines IMS DL/I function codes (e.g., FUNC-ISRT, FUNC-GU)",
      "location": "WORKING_STORAGE",
      "citation": 142
    },
    {
      "copybook_name": "CIPAUSMY",
      "purpose": "Defines layout of PENDING-AUTH-SUMMARY root segment (PAUTSUM0)",
      "location": "WORKING_STORAGE",
      "citation": 149
    },
    {
      "copybook_name": "CIPAUDTY",
      "purpose": "Defines layout of PENDING-AUTH-DETAILS child segment (PAUTDTL1)",
      "location": "WORKING_STORAGE",
      "citation": 153
    },
    {
      "copybook_name": "PAUTBPCB",
      "purpose": "Defines IMS PCB mask for PAUT database including status, segment name, key feedback",
      "location": "LINKAGE",
      "citation": 161
    }
  ],
  "paragraphs": [
    {
      "paragraph_name": "MAIN-PARA",
      "summary": null,
      "purpose": "This is the primary entry point and orchestration paragraph controlling the entire program flow. It first executes an ENTRY 'DLITCBL' USING PAUTBPCB to support alternate entry (line 171). It displays a startup message (173). It then performs 1000-INITIALIZE THRU 1000-EXIT to accept dates, display them, and open both input files with error abend checks (175). Next, it enters a loop performing 2000-READ-ROOT-SEG-FILE THRU 2000-EXIT until END-ROOT-SEG-FILE = 'Y', reading and inserting all root segments from INFILE1 (177-178). After exhausting roots, it performs 3000-READ-CHILD-SEG-FILE THRU 3000-EXIT until END-CHILD-SEG-FILE = 'Y', processing all child segments from INFILE2 with parent qualification (180-181). It then performs 4000-FILE-CLOSE THRU 4000-EXIT to close files with status checks (183). No direct data consumption or production; delegates to subordinates. Error handling is propagated from called paragraphs via abend. Finally, GOBACK to caller (187).",
      "called_by": [],
      "calls": [
        "1000-INITIALIZE",
        "2000-READ-ROOT-SEG-FILE",
        "3000-READ-CHILD-SEG-FILE",
        "4000-FILE-CLOSE"
      ],
      "citation": [
        169,
        187
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "1000-INITIALIZE",
      "summary": null,
      "purpose": "This initialization paragraph sets up program variables and opens input files. It accepts CURRENT-DATE from DATE and CURRENT-YYDDD from DAY (193-194). It displays formatted date information (196-198). It opens INFILE1 and checks WS-INFIL1-STATUS; if not SPACES or '00', displays error and performs 9999-ABEND (201-207). Similarly opens INFILE2 and checks WS-INFIL2-STATUS with identical error handling (209-215). No data transformations or business logic beyond status validation. Consumes no prior data; produces open files ready for reads. Error handling is explicit with abend on open failures to prevent processing with invalid files. No calls to other paragraphs. Control passes to 1000-EXIT.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [],
      "citation": [
        190,
        218
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "2000-READ-ROOT-SEG-FILE",
      "summary": null,
      "purpose": "This paragraph reads the next root segment record from INFILE1 in the main root loading loop. It performs READ INFILE1 (226). If WS-INFIL1-STATUS = SPACES or '00', moves INFIL1-REC to PENDING-AUTH-SUMMARY and performs 2100-INSERT-ROOT-SEG THRU 2100-EXIT to load into IMS (228-230). If status = '10', sets END-ROOT-SEG-FILE = 'Y' to exit loop (232-233). For other statuses, displays error message but does not abend, allowing continuation (235). Consumes records from opened INFILE1; produces populated PENDING-AUTH-SUMMARY for insert. No complex business logic; simple status-based decisions. Error handling lenient on reads (display only). Calls 2100 for successful reads. Control to 2000-EXIT.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [
        "2100-INSERT-ROOT-SEG"
      ],
      "citation": [
        222,
        241
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "2100-INSERT-ROOT-SEG",
      "summary": null,
      "purpose": "This paragraph inserts a root segment into IMS using unqualified ISRT. It calls 'CBLTDLI' USING FUNC-ISRT, PAUTBPCB, PENDING-AUTH-SUMMARY, ROOT-UNQUAL-SSA (244-247). Displays decorative messages (248,252). If PAUT-PCB-STATUS = SPACES, displays success (253-254). If 'II', displays duplicate message (256-257). If neither, displays failure status and performs 9999-ABEND (259-261). Consumes pre-mapped PENDING-AUTH-SUMMARY from read; produces IMS PAUTSUM0 segment. Business logic enforces uniqueness tolerating duplicates. Strict error handling abends on unexpected IMS statuses. No subordinate calls. Control to 2100-EXIT.",
      "called_by": [
        "2000-READ-ROOT-SEG-FILE"
      ],
      "calls": [],
      "citation": [
        242,
        265
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "3000-READ-CHILD-SEG-FILE",
      "summary": null,
      "purpose": "This paragraph reads the next child segment record from INFILE2 in the main child loading loop. It performs READ INFILE2 (272). If WS-INFIL2-STATUS = SPACES or '00', checks if ROOT-SEG-KEY IS NUMERIC; if yes, moves ROOT-SEG-KEY to QUAL-SSA-KEY-VALUE, CHILD-SEG-REC to PENDING-AUTH-DETAILS, and performs 3100-INSERT-CHILD-SEG THRU 3100-EXIT (274-282). If status = '10', sets END-CHILD-SEG-FILE = 'Y' to exit loop (284-285). For other statuses, displays error but does not abend (287). Consumes records from INFILE2; produces populated SSA and details for child insert. Key business logic skips non-numeric root keys. Error handling lenient on reads. Calls 3100 for valid records. Control to 3000-EXIT.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [
        "3100-INSERT-CHILD-SEG"
      ],
      "citation": [
        269,
        291
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "3100-INSERT-CHILD-SEG",
      "summary": null,
      "purpose": "This paragraph performs GU on parent root before child insert to establish parentage. Initializes PAUT-PCB-STATUS (295). Calls 'CBLTDLI' USING FUNC-GU, PAUTBPCB, PENDING-AUTH-SUMMARY, ROOT-QUAL-SSA (296-299). Displays messages (300,304). If PAUT-PCB-STATUS = SPACES, displays success and performs 3200-INSERT-IMS-CALL THRU 3200-EXIT (305-309). If not SPACES or 'II', displays failure, key feedback, and abends (310-313). Consumes qualified SSA and details from read; temporarily retrieves root into PENDING-AUTH-SUMMARY for parentage. Ensures parent exists before child insert. Strict error handling abends on GU failure. Calls 3200 for success. Control to 3100-EXIT.",
      "called_by": [
        "3000-READ-CHILD-SEG-FILE"
      ],
      "calls": [
        "3200-INSERT-IMS-CALL"
      ],
      "citation": [
        292,
        316
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "3200-INSERT-IMS-CALL",
      "summary": null,
      "purpose": "This paragraph inserts the child segment into IMS using unqualified ISRT after successful parent GU. Calls 'CBLTDLI' USING FUNC-ISRT, PAUTBPCB, PENDING-AUTH-DETAILS, CHILD-UNQUAL-SSA (321-324). If PAUT-PCB-STATUS = SPACES, displays success (326-327). If 'II', displays duplicate (329-330). If neither, displays failure, key feedback, and abends (332-335). Consumes pre-mapped PENDING-AUTH-DETAILS; produces IMS PAUTDTL1 segment under located parent. Tolerates duplicates per business rule. Strict error handling on insert failures. No further calls. Control to 3200-EXIT.",
      "called_by": [
        "3100-INSERT-CHILD-SEG"
      ],
      "calls": [],
      "citation": [
        318,
        339
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "4000-FILE-CLOSE",
      "summary": null,
      "purpose": "This termination paragraph closes input files after all processing. Displays closing message (342). Closes INFILE1 and checks WS-INFIL1-STATUS; displays error if not SPACES/'00' but no abend (343-349). Closes INFILE2 similarly with display-only error handling (350-356). Consumes no data; ensures files closed. No business logic or validations. Lenient error handling (display only). No calls. Control to 4000-EXIT.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [],
      "citation": [
        341,
        358
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "9999-ABEND",
      "summary": null,
      "purpose": "This error termination paragraph abends the program on fatal errors. Displays abend message (363). Sets RETURN-CODE to 16 and GOBACK (365-366). Consumes no inputs; produces non-zero return code. Used by open and IMS call failures. No conditions checked here; invoked explicitly. No subordinate calls. Control to 9999-EXIT (unused).",
      "called_by": [
        "1000-INITIALIZE",
        "2100-INSERT-ROOT-SEG",
        "3100-INSERT-CHILD-SEG",
        "3200-INSERT-IMS-CALL"
      ],
      "calls": [],
      "citation": [
        360,
        369
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    }
  ],
  "error_handling": [
    {
      "condition": "WS-INFIL1-STATUS NOT = SPACES OR '00' after OPEN INFILE1",
      "action": "DISPLAY error message and PERFORM 9999-ABEND",
      "citation": [
        202,
        205
      ]
    },
    {
      "condition": "WS-INFIL2-STATUS NOT = SPACES OR '00' after OPEN INFILE2",
      "action": "DISPLAY error message and PERFORM 9999-ABEND",
      "citation": [
        210,
        213
      ]
    },
    {
      "condition": "PAUT-PCB-STATUS NOT = SPACES AND NOT 'II' after root ISRT",
      "action": "DISPLAY failure status and PERFORM 9999-ABEND",
      "citation": [
        259
      ]
    },
    {
      "condition": "PAUT-PCB-STATUS NOT = SPACES AND NOT 'II' after child GU",
      "action": "DISPLAY failure status and key feedback then PERFORM 9999-ABEND",
      "citation": [
        310
      ]
    },
    {
      "condition": "PAUT-PCB-STATUS NOT = SPACES AND NOT 'II' after child ISRT",
      "action": "DISPLAY failure status and key feedback then PERFORM 9999-ABEND",
      "citation": [
        332
      ]
    },
    {
      "condition": "WS-INFIL1-STATUS or WS-INFIL2-STATUS not SPACES/'00'/'10' on READ",
      "action": "DISPLAY error message but continue without abend",
      "citation": [
        235,
        287
      ]
    }
  ],
  "sql_operations": [],
  "cics_operations": [],
  "open_questions": [
    {
      "question": "Purpose of unused counters (e.g., WS-NO-CHKP, WS-AUTH-SMRY-PROC-CNT, WS-NO-SUMRY-DELETED)",
      "context": "Defined in WS-VARIABLES (63-69) but never incremented or displayed",
      "suggestion": "Check prior versions or related programs for delete logic"
    },
    {
      "question": "Usage of PRM-INFO parameters (P-EXPIRY-DAYS, P-CHKP-FREQ, etc.)",
      "context": "Defined (129-139) but never populated via ACCEPT or LINKAGE",
      "suggestion": "Examine calling program or prior iterations for parameter passing"
    },
    {
      "question": "Role of ENTRY 'DLITCBL' USING PAUTBPCB",
      "context": "Executed at start (171) but unclear if program is dynamically called under this name",
      "suggestion": "Review JCL or IMS DLITCBL caller for context"
    }
  ]
}