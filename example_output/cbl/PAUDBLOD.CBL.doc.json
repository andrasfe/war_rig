{
  "header": {
    "program_id": "PAUDBLOD",
    "file_name": "cbl/PAUDBLOD.CBL",
    "file_type": "COBOL",
    "analyzed_by": "WAR_RIG",
    "analyzed_at": "2026-01-26T14:23:45.621752",
    "iteration_count": 1,
    "final_status": null
  },
  "purpose": {
    "summary": "Batch IMS database load utility that reads root segment records from INFILE1 and inserts them as PAUTSUM0 segments into the PAUT database using unqualified ISRT calls. It then reads child segment records from INFILE2, which include the parent root key, uses qualified GU to position the parent, and inserts PAUTDTL1 child segments under matching parents using unqualified ISRT. Handles duplicates by displaying messages and continuing, abends on other IMS errors or file open failures.",
    "business_context": "Loads pending authorization summary and detail data into IMS PAUT database from unload files generated by IMSUNLOD or similar.",
    "program_type": "BATCH",
    "citations": [
      18,
      26,
      32,
      44,
      45,
      169,
      177,
      180,
      244,
      296
    ]
  },
  "inputs": [
    {
      "name": "INFILE1",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Sequential file containing root segment records (PAUTSUM0 layout) for IMS load",
      "copybook": null,
      "citation": [
        226
      ]
    },
    {
      "name": "INFILE2",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Sequential file containing child segment records prefixed with ROOT-SEG-KEY (PAUTDTL1 layout)",
      "copybook": null,
      "citation": [
        272
      ]
    },
    {
      "name": "PAUTBPCB",
      "io_type": "IMS_SEGMENT",
      "description": "IMS PCB for PAUT database access via DL/I calls",
      "copybook": "PAUTBPCB",
      "citation": [
        245,
        297,
        322
      ]
    }
  ],
  "outputs": [
    {
      "name": "PAUTSUM0",
      "io_type": "IMS_SEGMENT",
      "description": "Pending authorization summary root segments inserted into IMS PAUT database",
      "copybook": "CIPAUSMY",
      "citation": [
        244
      ]
    },
    {
      "name": "PAUTDTL1",
      "io_type": "IMS_SEGMENT",
      "description": "Pending authorization details child segments inserted under matching PAUTSUM0 parents in IMS PAUT database",
      "copybook": "CIPAUDTY",
      "citation": [
        321
      ]
    }
  ],
  "called_programs": [],
  "calling_context": {
    "called_by": [],
    "entry_points": [
      "DLITCBL"
    ],
    "linkage_section": [
      "PAUTBPCB"
    ]
  },
  "business_rules": [
    {
      "rule_id": "BR001",
      "description": "Abort program with return code 16 if file open status is not spaces or '00'",
      "logic_summary": "Check WS-INFIL1-STATUS and WS-INFIL2-STATUS after OPEN INPUT, PERFORM 9999-ABEND if invalid",
      "conditions": [
        "WS-INFIL1-STATUS NOT = SPACES OR '00'",
        "WS-INFIL2-STATUS NOT = SPACES OR '00'"
      ],
      "citation": [
        202,
        210
      ]
    },
    {
      "rule_id": "BR002",
      "description": "Insert root segment via unqualified ISRT; continue on success (spaces) or duplicate ('II'), abend otherwise",
      "logic_summary": "CALL 'CBLTDLI' with FUNC-ISRT, check PAUT-PCB-STATUS",
      "conditions": [
        "PAUT-PCB-STATUS = SPACES OR 'II'",
        "PAUT-PCB-STATUS NOT = SPACES AND 'II'"
      ],
      "citation": [
        253,
        256,
        259
      ]
    },
    {
      "rule_id": "BR003",
      "description": "Skip child records where ROOT-SEG-KEY is not numeric",
      "logic_summary": "IF ROOT-SEG-KEY IS NUMERIC before processing child insert",
      "conditions": [
        "ROOT-SEG-KEY IS NUMERIC"
      ],
      "citation": [
        275
      ]
    },
    {
      "rule_id": "BR004",
      "description": "For child insert, perform qualified GU on parent using ROOT-SEG-KEY from child record; if success, insert child unqualified ISRT; continue on success or duplicate, abend otherwise",
      "logic_summary": "Move ROOT-SEG-KEY to QUAL-SSA-KEY-VALUE, CALL 'CBLTDLI' GU on root, then if ok CALL ISRT on child",
      "conditions": [
        "PAUT-PCB-STATUS = SPACES after GU",
        "PAUT-PCB-STATUS NOT = SPACES AND 'II' after GU or ISRT"
      ],
      "citation": [
        277,
        305,
        310,
        326,
        332
      ]
    },
    {
      "rule_id": "BR005",
      "description": "On READ file status not '00'/spaces, set end flag if '10' (EOF), else DISPLAY error message but continue without abend",
      "logic_summary": "No PERFORM 9999-ABEND on invalid READ",
      "conditions": [
        "WS-INFIL*-STATUS = '10'",
        "WS-INFIL*-STATUS NOT = SPACES OR '00' OR '10'"
      ],
      "citation": [
        232,
        284,
        235,
        287
      ]
    }
  ],
  "data_flow": {
    "reads_from": [
      {
        "source": "INFILE1",
        "fields_used": [
          "INFIL1-REC"
        ],
        "citation": [
          226
        ]
      },
      {
        "source": "INFILE2",
        "fields_used": [
          "ROOT-SEG-KEY",
          "CHILD-SEG-REC"
        ],
        "citation": [
          272
        ]
      }
    ],
    "writes_to": [
      {
        "destination": "PAUTSUM0",
        "fields_written": [
          "PENDING-AUTH-SUMMARY"
        ],
        "citation": [
          244
        ]
      },
      {
        "destination": "PAUTDTL1",
        "fields_written": [
          "PENDING-AUTH-DETAILS"
        ],
        "citation": [
          321
        ]
      }
    ],
    "transforms": [
      {
        "input_field": "INFIL1-REC",
        "output_field": "PENDING-AUTH-SUMMARY",
        "transformation_description": "Direct MOVE to root segment layout for IMS insert",
        "citation": [
          229
        ]
      },
      {
        "input_field": "ROOT-SEG-KEY",
        "output_field": "QUAL-SSA-KEY-VALUE",
        "transformation_description": "MOVE to qualified SSA key field for parent GU",
        "citation": [
          277
        ]
      },
      {
        "input_field": "CHILD-SEG-REC",
        "output_field": "PENDING-AUTH-DETAILS",
        "transformation_description": "Direct MOVE to child segment layout for IMS insert",
        "citation": [
          280
        ]
      }
    ]
  },
  "copybooks_used": [
    {
      "copybook_name": "IMSFUNCS",
      "purpose": "Defines IMS DL/I function codes (FUNC-ISRT, FUNC-GU)",
      "location": "WORKING_STORAGE",
      "citation": 142
    },
    {
      "copybook_name": "CIPAUSMY",
      "purpose": "Defines layout of PENDING-AUTH-SUMMARY (PAUTSUM0 root segment)",
      "location": "WORKING_STORAGE",
      "citation": 149
    },
    {
      "copybook_name": "CIPAUDTY",
      "purpose": "Defines layout of PENDING-AUTH-DETAILS (PAUTDTL1 child segment)",
      "location": "WORKING_STORAGE",
      "citation": 153
    },
    {
      "copybook_name": "PAUTBPCB",
      "purpose": "Defines IMS PCB mask for PAUT database (PAUT-PCB-STATUS, PAUT-SEG-NAME, PAUT-KEYFB)",
      "location": "LINKAGE",
      "citation": 161
    }
  ],
  "paragraphs": [
    {
      "paragraph_name": "MAIN-PARA",
      "summary": null,
      "purpose": "This is the primary entry point paragraph that orchestrates the entire IMS database load process. It begins with an ENTRY 'DLITCBL' statement allowing alternate entry using PAUTBPCB linkage. It displays a start message, then performs 1000-INITIALIZE to open input files and set dates. It enters a loop performing 2000-READ-ROOT-SEG-FILE until END-ROOT-SEG-FILE is 'Y', processing each root record by inserting into IMS. After root processing, it loops on 3000-READ-CHILD-SEG-FILE until END-CHILD-SEG-FILE is 'Y', handling child inserts under parents. Upon completion of both loops, it performs 4000-FILE-CLOSE to shut down files. No explicit error handling here; relies on subordinate paragraphs to abend if needed. Finally, GOBACK with return code set only if abended earlier. No other paragraphs or programs called directly beyond the PERFORMs.",
      "called_by": [],
      "calls": [
        "1000-INITIALIZE",
        "2000-READ-ROOT-SEG-FILE",
        "3000-READ-CHILD-SEG-FILE",
        "4000-FILE-CLOSE"
      ],
      "citation": [
        169,
        187
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "1000-INITIALIZE",
      "summary": null,
      "purpose": "This paragraph handles program initialization including date acceptance and input file opens. It consumes system date via ACCEPT CURRENT-DATE FROM DATE and CURRENT-YYDDD FROM DAY. It displays diagnostic messages including today's date. It then performs OPEN INPUT on INFILE1 and checks WS-INFIL1-STATUS; if not spaces or '00', displays error and performs 9999-ABEND. Similarly for OPEN INPUT INFILE2 with WS-INFIL2-STATUS check and abend on failure. Produces open files ready for reads and initialized date variables in WS-VARIABLES. Implements business logic to ensure files are accessible before processing, with strict error handling via abend on open failures. No subordinate calls beyond potential abend.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [
        "9999-ABEND"
      ],
      "citation": [
        190,
        217
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "2000-READ-ROOT-SEG-FILE",
      "summary": null,
      "purpose": "This paragraph reads the next root segment record from INFILE1 in the main root processing loop. It performs READ INFILE1, consuming INFIL1-REC into the record area. If WS-INFIL1-STATUS is spaces or '00', moves INFIL1-REC to PENDING-AUTH-SUMMARY and performs 2100-INSERT-ROOT-SEG to load into IMS. If status '10', sets END-ROOT-SEG-FILE to 'Y' to exit loop. For other statuses, displays 'ERROR READING ROOT SEG INFILE' but does not abend, continuing to next iteration. Outputs updated EOF flag or processed record to IMS via subordinate. Business logic distinguishes EOF from errors but tolerates read errors without halt. Calls 2100-INSERT-ROOT-SEG only on successful reads.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [
        "2100-INSERT-ROOT-SEG"
      ],
      "citation": [
        222,
        240
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "2100-INSERT-ROOT-SEG",
      "summary": null,
      "purpose": "This paragraph inserts a root segment into IMS using unqualified SSA. It consumes PENDING-AUTH-SUMMARY (moved from input record) and calls 'CBLTDLI' with FUNC-ISRT, PAUTBPCB, segment, ROOT-UNQUAL-SSA. Displays decorative messages and checks PAUT-PCB-STATUS post-call. If spaces, displays success; if 'II', displays duplicate message. If neither, displays failure status and performs 9999-ABEND. Produces inserted PAUTSUM0 segment or abend on error. Implements logic to handle duplicates gracefully (log and continue) but fail-fast on other IMS errors like GE/GB. No further calls.",
      "called_by": [
        "2000-READ-ROOT-SEG-FILE"
      ],
      "calls": [
        "9999-ABEND"
      ],
      "citation": [
        242,
        264
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "3000-READ-CHILD-SEG-FILE",
      "summary": null,
      "purpose": "This paragraph reads the next child segment record from INFILE2 in the main child processing loop. It performs READ INFILE2, consuming ROOT-SEG-KEY and CHILD-SEG-REC. If WS-INFIL2-STATUS spaces or '00' and ROOT-SEG-KEY IS NUMERIC, moves key to QUAL-SSA-KEY-VALUE, CHILD-SEG-REC to PENDING-AUTH-DETAILS, and performs 3100-INSERT-CHILD-SEG. If status '10', sets END-CHILD-SEG-FILE 'Y'. For other statuses, displays error but no abend. Skips non-numeric keys silently. Outputs positioned parent for child insert or EOF flag. Logic validates parent key before attempting child load to ensure parentage.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [
        "3100-INSERT-CHILD-SEG"
      ],
      "citation": [
        269,
        290
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "3100-INSERT-CHILD-SEG",
      "summary": null,
      "purpose": "This paragraph positions the parent root segment and prepares for child insert. It initializes PAUT-PCB-STATUS, then CALL 'CBLTDLI' FUNC-GU using PAUTBPCB, PENDING-AUTH-SUMMARY (not used?), ROOT-QUAL-SSA (keyed on ROOT-SEG-KEY). Displays messages, checks PAUT-PCB-STATUS: if spaces, displays success and performs 3200-INSERT-IMS-CALL. If not spaces or 'II', displays failure, KEYFB, and abends. Consumes child record's parent key to locate root. Produces positioned PCB for child ISRT or abend. Logic enforces parent-child relationship via qualified GU before insert.",
      "called_by": [
        "3000-READ-CHILD-SEG-FILE"
      ],
      "calls": [
        "3200-INSERT-IMS-CALL",
        "9999-ABEND"
      ],
      "citation": [
        292,
        315
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "3200-INSERT-IMS-CALL",
      "summary": null,
      "purpose": "This paragraph performs the actual child segment insert under the positioned parent. It CALL 'CBLTDLI' FUNC-ISRT with PAUTBPCB, PENDING-AUTH-DETAILS, CHILD-UNQUAL-SSA. Checks PAUT-PCB-STATUS: spaces success display, 'II' duplicate display, other displays failure/KEYFB and abends. Consumes positioned PCB from prior GU and child data. Produces inserted PAUTDTL1 segment. Handles duplicates gracefully, fails on other errors. No further calls.",
      "called_by": [
        "3100-INSERT-CHILD-SEG"
      ],
      "calls": [
        "9999-ABEND"
      ],
      "citation": [
        318,
        338
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "4000-FILE-CLOSE",
      "summary": null,
      "purpose": "This paragraph closes the input files at program end. It displays closing message, CLOSE INFILE1, checks WS-INFIL1-STATUS (displays error if bad but no abend). Then CLOSE INFILE2, similar status check/display only. Consumes open files. No outputs beyond status logs. No error handling beyond display; program continues to GOBACK regardless.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [],
      "citation": [
        341,
        357
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "9999-ABEND",
      "summary": null,
      "purpose": "Error termination paragraph invoked on critical failures like open errors or IMS call failures. Displays 'IMS LOAD ABENDING ...', sets RETURN-CODE to 16, GOBACK. Consumes error context from caller. No validation or further logic. Halts program with non-zero return code.",
      "called_by": [
        "1000-INITIALIZE",
        "2100-INSERT-ROOT-SEG",
        "3100-INSERT-CHILD-SEG",
        "3200-INSERT-IMS-CALL"
      ],
      "calls": [],
      "citation": [
        360,
        368
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    }
  ],
  "error_handling": [
    {
      "condition": "File OPEN status not spaces or '00'",
      "action": "DISPLAY error and PERFORM 9999-ABEND",
      "citation": [
        205,
        213
      ]
    },
    {
      "condition": "IMS ISRT/GU status not spaces or 'II'",
      "action": "DISPLAY status/KEYFB and PERFORM 9999-ABEND",
      "citation": [
        260,
        311,
        333
      ]
    },
    {
      "condition": "File READ status not spaces/'00'/'10'",
      "action": "DISPLAY error message, continue without abend",
      "citation": [
        235,
        287
      ]
    },
    {
      "condition": "File CLOSE status not spaces/'00'",
      "action": "DISPLAY error message, continue",
      "citation": [
        348,
        355
      ]
    }
  ],
  "sql_operations": [],
  "cics_operations": [],
  "open_questions": [
    {
      "question": "Exact field layouts and key fields in copybooks CIPAUSMY, CIPAUDTY, PAUTBPCB",
      "context": "Copybooks not provided; cannot detail field mappings or validate key usage (e.g., ACCNTID in SSA line 116)",
      "suggestion": "Provide copybook source for field-level analysis"
    },
    {
      "question": "Origin and format of INFILE1/INFILE2 (e.g., generated by IMSUNLOD?)",
      "context": "Assumed unload files matching segment layouts; WS-PGMNAME 'IMSUNLOD' suggests relation",
      "suggestion": "Trace upstream unload process"
    },
    {
      "question": "Purpose of ENTRY 'DLITCBL' and if program is ever called dynamically",
      "context": "Unused in main flow; possible alternate entry for DL/I compatibility",
      "suggestion": "Check JCL or callers"
    },
    {
      "question": "Usage of counters like WS-NO-CHKP, WS-AUTH-SMRY-PROC-CNT, WS-TOT-REC-WRITTEN etc.",
      "context": "Defined but never incremented or used",
      "suggestion": "Possibly vestigial or for future/debug"
    },
    {
      "question": "PRM-INFO parameter structure defined but not populated or used",
      "context": "In WS, fields like P-EXPIRY-DAYS, P-DEBUG-FLAG unused",
      "suggestion": "Check if passed via linkage or sysin"
    }
  ]
}