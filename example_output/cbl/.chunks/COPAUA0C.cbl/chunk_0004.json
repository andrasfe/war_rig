{
  "batch_idx": 4,
  "total_batches": 5,
  "template": {
    "header": {
      "program_id": "COPAUA0C",
      "file_name": "cbl/COPAUA0C.cbl",
      "file_type": "COBOL",
      "analyzed_by": "WAR_RIG",
      "analyzed_at": "2026-02-24T03:53:33.425670",
      "iteration_count": 1,
      "final_status": null
    },
    "purpose": {
      "summary": "COPAUA0C is a CICS online COBOL program containing terminal error handling paragraphs. The 9500-LOG-ERROR paragraph obtains and formats the current timestamp, populates an error log record with transaction ID, program authority, date, and time, and writes it to the CSSL transient data queue. Critical errors trigger execution of 9990-END-ROUTINE to terminate the program via 9000-TERMINATE and CICS RETURN.",
      "business_context": null,
      "program_type": "ONLINE_CICS",
      "citations": [
        1,
        4,
        14,
        19,
        26,
        37
      ]
    },
    "inputs": [],
    "outputs": [
      {
        "name": "CSSL",
        "io_type": "CICS_QUEUE",
        "description": "Transient data queue receiving error log records populated with application/transaction ID, program name, date, and time",
        "copybook": "ERROR-LOG-RECORD",
        "citation": [
          19,
          20,
          21,
          22,
          23,
          24
        ]
      }
    ],
    "called_programs": [],
    "calling_context": {
      "called_by": [],
      "entry_points": [],
      "linkage_section": []
    },
    "business_rules": [
      {
        "rule_id": "BR001",
        "description": "Terminate program immediately if the error is flagged as critical",
        "logic_summary": "Check ERR-CRITICAL flag and perform 9990-END-ROUTINE if true",
        "conditions": [
          "IF ERR-CRITICAL"
        ],
        "citation": [
          26,
          27
        ]
      }
    ],
    "data_flow": {
      "reads_from": [
        {
          "source": "WS-ABS-TIME",
          "fields_used": [
            "WS-ABS-TIME"
          ],
          "citation": [
            5
          ]
        },
        {
          "source": "WS-CICS-TRANID",
          "fields_used": [
            "WS-CICS-TRANID"
          ],
          "citation": [
            14
          ]
        },
        {
          "source": "WS-PGM-AUTH",
          "fields_used": [
            "WS-PGM-AUTH"
          ],
          "citation": [
            15
          ]
        },
        {
          "source": "WS-CUR-DATE-X6",
          "fields_used": [
            "WS-CUR-DATE-X6"
          ],
          "citation": [
            16
          ]
        },
        {
          "source": "WS-CUR-TIME-X6",
          "fields_used": [
            "WS-CUR-TIME-X6"
          ],
          "citation": [
            17
          ]
        },
        {
          "source": "ERR-CRITICAL",
          "fields_used": [
            "ERR-CRITICAL"
          ],
          "citation": [
            26
          ]
        }
      ],
      "writes_to": [
        {
          "destination": "ERROR-LOG-RECORD",
          "fields_written": [
            "ERR-APPLICATION",
            "ERR-PROGRAM",
            "ERR-DATE",
            "ERR-TIME"
          ],
          "citation": [
            14,
            15,
            16,
            17
          ]
        },
        {
          "destination": "CSSL",
          "fields_written": [
            "ERROR-LOG-RECORD"
          ],
          "citation": [
            19
          ]
        }
      ],
      "transforms": [
        {
          "input_field": "WS-ABS-TIME",
          "output_field": "WS-CUR-DATE-X6",
          "transformation_description": "Format absolute time to YYMMDD date format using CICS FORMATTIME",
          "citation": [
            8,
            10
          ]
        },
        {
          "input_field": "WS-ABS-TIME",
          "output_field": "WS-CUR-TIME-X6",
          "transformation_description": "Format absolute time to TIME format using CICS FORMATTIME",
          "citation": [
            8,
            11
          ]
        },
        {
          "input_field": "WS-CICS-TRANID",
          "output_field": "ERR-APPLICATION",
          "transformation_description": "Direct move of transaction ID to error log application field",
          "citation": [
            14
          ]
        },
        {
          "input_field": "WS-PGM-AUTH",
          "output_field": "ERR-PROGRAM",
          "transformation_description": "Direct move of program authority to error log program field",
          "citation": [
            15
          ]
        },
        {
          "input_field": "WS-CUR-DATE-X6",
          "output_field": "ERR-DATE",
          "transformation_description": "Direct move of formatted date to error log date field",
          "citation": [
            16
          ]
        },
        {
          "input_field": "WS-CUR-TIME-X6",
          "output_field": "ERR-TIME",
          "transformation_description": "Direct move of formatted time to error log time field",
          "citation": [
            17
          ]
        }
      ]
    },
    "copybooks_used": [],
    "paragraphs": [
      {
        "paragraph_name": "9500-LOG-ERROR",
        "summary": null,
        "purpose": "This paragraph serves as the primary error logging routine in the program, invoked when an error condition occurs to record details for auditing and diagnostics. It consumes working storage variables such as WS-CICS-TRANID, WS-PGM-AUTH, and ERR-CRITICAL, as well as internally populating WS-ABS-TIME via CICS ASKTIME and deriving WS-CUR-DATE-X6 and WS-CUR-TIME-X6 via FORMATTIME. It produces a populated ERROR-LOG-RECORD by moving transaction ID to ERR-APPLICATION, program auth to ERR-PROGRAM, formatted date to ERR-DATE, and time to ERR-TIME, then writes the entire record to the CSSL TD queue. The business logic centers on deciding whether to terminate based on the ERR-CRITICAL flag: if true, it performs 9990-END-ROUTINE to shut down; otherwise, it falls through to exit. Error handling for CICS commands uses NOHANDLE, suppressing exceptions silently. It calls 9990-END-ROUTINE conditionally for critical errors to ensure proper program termination. This routine supports operational reliability by logging errors without interrupting non-critical flows. No files are opened or closed here; it relies on prior setup.",
        "called_by": [],
        "calls": [
          "9990-END-ROUTINE"
        ],
        "citation": [
          983,
          1011
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "9500-EXIT",
        "summary": null,
        "purpose": "This paragraph acts as the standard exit point for the 9500-LOG-ERROR section, providing a clean return to the calling code when no critical termination is needed. It consumes no inputs or data explicitly, serving solely as a control flow terminator. It produces no outputs, modifications, or side effects. There is no business logic, conditions, decisions, or validations implemented. No error handling is present, as it assumes prior steps succeeded. It makes no calls to other paragraphs or programs. In the program flow, it is reached sequentially after the IF-END-IF block in 9500-LOG-ERROR if ERR-CRITICAL is false. This minimal paragraph ensures proper COBOL procedure division scoping and prevents fall-through issues. Its role is purely structural for maintainability.",
        "called_by": [],
        "calls": [],
        "citation": [
          1012,
          1015
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "9990-END-ROUTINE",
        "summary": null,
        "purpose": "This paragraph orchestrates the final termination of the program in response to critical errors, ensuring cleanup and return to CICS. It consumes no explicit inputs, relying on prior state from calling context. It produces program shutdown by performing 9000-TERMINATE (presumably for resource cleanup) and issuing EXEC CICS RETURN to release control back to CICS. There is no conditional business logic; it unconditionally executes termination steps. No specific error handling or validations are performed here, deferring to 9000-TERMINATE. It calls 9000-TERMINATE to handle any necessary file closures, variable resets, or other end-of-task activities before returning. This routine is critical for preventing resource leaks in CICS environment. Control flows to 9990-EXIT afterward. Its invocation only occurs from 9500-LOG-ERROR for critical cases.",
        "called_by": [],
        "calls": [
          "9000-TERMINATE"
        ],
        "citation": [
          1016,
          1023
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "9990-EXIT",
        "summary": null,
        "purpose": "This paragraph functions as the exit point for the 9990-END-ROUTINE section, allowing control to return after termination logic. It takes no inputs and performs no reads or computations. It generates no outputs or data changes. No business rules, conditions, or decisions are evaluated. Error handling is absent, as termination is already in progress. No further calls are made to paragraphs or programs. In the overall flow, it is reached immediately after CICS RETURN in 9990-END-ROUTINE, ensuring scoped exit. This structural element maintains COBOL best practices for procedure division organization. It prevents unintended execution of subsequent code.",
        "called_by": [],
        "calls": [],
        "citation": [
          1024,
          1026
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      }
    ],
    "error_handling": [
      {
        "condition": "Critical error flagged (ERR-CRITICAL)",
        "action": "Perform 9990-END-ROUTINE to terminate program",
        "citation": [
          26
        ]
      },
      {
        "condition": "CICS command failures (ASKTIME, FORMATTIME, WRITEQ)",
        "action": "Ignored via NOHANDLE clauses",
        "citation": [
          4,
          8,
          23
        ]
      }
    ],
    "sql_operations": [],
    "cics_operations": [
      {
        "command": "ASKTIME",
        "resource": null,
        "purpose": "Retrieve current absolute system time for error log timestamp",
        "citation": 4
      },
      {
        "command": "FORMATTIME",
        "resource": null,
        "purpose": "Convert absolute time to readable YYMMDD date and TIME formats for logging",
        "citation": 8
      },
      {
        "command": "WRITEQ",
        "resource": "CSSL",
        "purpose": "Append error log record to transient data queue for audit trail",
        "citation": 19
      },
      {
        "command": "RETURN",
        "resource": null,
        "purpose": "Terminate task and return control to CICS transaction manager",
        "citation": 39
      }
    ],
    "open_questions": [
      {
        "question": "What is the overall business purpose and main flow of COPAUA0C?",
        "context": "Only terminal error handling paragraphs provided; no main logic, initialization, or processing sections visible.",
        "suggestion": "Analyze full source code including PROGRAM-ID, PROCEDURE DIVISION start, and main paragraphs."
      },
      {
        "question": "What external inputs (e.g., CICS_MAP, COMMAREA, queues, files) does the program use?",
        "context": "Snippet shows only WS variables; no open/read operations or input definitions.",
        "suggestion": "Provide WORKING-STORAGE, FILE SECTION, and main processing paragraphs."
      },
      {
        "question": "What does 9000-TERMINATE paragraph do?",
        "context": "Called but code not provided.",
        "suggestion": "Include lines for 9000-TERMINATE."
      },
      {
        "question": "How are WS-CICS-TRANID, WS-PGM-AUTH, ERR-CRITICAL, and other fields in ERROR-LOG-RECORD populated before 9500-LOG-ERROR?",
        "context": "Moves occur but prior setup not shown.",
        "suggestion": "Examine calling paragraphs."
      },
      {
        "question": "Is ERROR-LOG-RECORD from a COPYBOOK or local WS definition?",
        "context": "Used directly; no COPY statement in snippet.",
        "suggestion": "Check WORKING-STORAGE SECTION."
      }
    ],
    "resolved_questions": [],
    "dead_code": [],
    "call_semantics": [],
    "flow_diagram": null
  },
  "saved_at": "2026-02-23T20:53:33.426887"
}