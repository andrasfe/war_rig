{
  "batch_idx": 1,
  "total_batches": 5,
  "template": {
    "header": {
      "program_id": "COPAUA0C",
      "file_name": "COPAUA0C.cbl",
      "file_type": "COBOL",
      "analyzed_by": "WAR_RIG",
      "analyzed_at": "2026-02-24T17:36:39.977812",
      "iteration_count": 1,
      "final_status": null
    },
    "purpose": {
      "summary": "This COBOL program processes authorization requests by extracting data from an MQ message, reading related records from CICS files, making an authorization decision, sending a response, and writing authorization data to a database. It retrieves cardholder information from various sources, including a card cross-reference file, account master file, customer record file, and authorization summary file, to determine whether to approve or decline a transaction.",
      "business_context": null,
      "program_type": "ONLINE_CICS",
      "citations": [
        4,
        96,
        107,
        109,
        112
      ]
    },
    "inputs": [
      {
        "name": "W01-GET-BUFFER",
        "io_type": "CICS_QUEUE",
        "description": "MQ message buffer containing the authorization request data.",
        "copybook": null,
        "citation": [
          4,
          54
        ]
      },
      {
        "name": "WS-CCXREF-FILE",
        "io_type": "FILE_VSAM",
        "description": "CICS VSAM file containing card cross-reference records.",
        "copybook": "CARD-XREF-RECORD",
        "citation": [
          125
        ]
      },
      {
        "name": "WS-ACCTFILENAME",
        "io_type": "FILE_VSAM",
        "description": "CICS VSAM file containing account records.",
        "copybook": "ACCOUNT-RECORD",
        "citation": [
          172
        ]
      }
    ],
    "outputs": [],
    "called_programs": [
      {
        "program_name": "MQGET",
        "call_type": "STATIC_CALL",
        "purpose": "Retrieves a message from the MQ queue.",
        "parameters": [
          "W01-HCONN-REQUEST",
          "W01-HOBJ-REQUEST",
          "MQM-MD-REQUEST",
          "MQM-GET-MESSAGE-OPTIONS",
          "W01-BUFFLEN",
          "W01-GET-BUFFER",
          "W01-DATALEN",
          "WS-COMPCODE",
          "WS-REASON"
        ],
        "citation": 49
      },
      {
        "program_name": "9500-LOG-ERROR",
        "call_type": "STATIC_CALL",
        "purpose": "Logs error messages.",
        "parameters": [],
        "citation": 78
      }
    ],
    "calling_context": {
      "called_by": [],
      "entry_points": [],
      "linkage_section": []
    },
    "business_rules": [],
    "data_flow": {
      "reads_from": [
        {
          "source": "W01-GET-BUFFER",
          "fields_used": [
            "PA-RQ-AUTH-DATE",
            "PA-RQ-AUTH-TIME",
            "PA-RQ-CARD-NUM",
            "PA-RQ-AUTH-TYPE",
            "PA-RQ-CARD-EXPIRY-DATE",
            "PA-RQ-MESSAGE-TYPE",
            "PA-RQ-MESSAGE-SOURCE",
            "PA-RQ-PROCESSING-CODE",
            "WS-TRANSACTION-AMT-AN",
            "PA-RQ-MERCHANT-CATAGORY-CODE",
            "PA-RQ-ACQR-COUNTRY-CODE",
            "PA-RQ-POS-ENTRY-MODE",
            "PA-RQ-MERCHANT-ID",
            "PA-RQ-MERCHANT-NAME",
            "PA-RQ-MERCHANT-CITY",
            "PA-RQ-MERCHANT-STATE",
            "PA-RQ-MERCHANT-ZIP",
            "PA-RQ-TRANSACTION-ID"
          ],
          "citation": [
            4
          ]
        },
        {
          "source": "WS-CCXREF-FILE",
          "fields_used": [
            "CARD-XREF-RECORD"
          ],
          "citation": [
            126
          ]
        },
        {
          "source": "WS-ACCTFILENAME",
          "fields_used": [
            "ACCOUNT-RECORD"
          ],
          "citation": [
            175
          ]
        }
      ],
      "writes_to": [],
      "transforms": [
        {
          "input_field": "WS-TRANSACTION-AMT-AN",
          "output_field": "PA-RQ-TRANSACTION-AMT",
          "transformation_description": "Converts alphanumeric transaction amount to numeric.",
          "citation": [
            26
          ]
        },
        {
          "input_field": "PA-RQ-TRANSACTION-AMT",
          "output_field": "WS-TRANSACTION-AMT",
          "transformation_description": "Moves transaction amount to working storage.",
          "citation": [
            29
          ]
        }
      ]
    },
    "copybooks_used": [
      {
        "copybook_name": "CARD-XREF-RECORD",
        "purpose": "Defines the structure of the card cross-reference record.",
        "location": "WORKING_STORAGE",
        "citation": 126
      },
      {
        "copybook_name": "ACCOUNT-RECORD",
        "purpose": "Defines the structure of the account record.",
        "location": "WORKING_STORAGE",
        "citation": 175
      }
    ],
    "paragraphs": [
      {
        "paragraph_name": "2100-EXTRACT-REQUEST-MSG",
        "summary": null,
        "purpose": "This paragraph extracts data from the MQ message buffer (W01-GET-BUFFER) into individual fields. It uses the UNSTRING statement to parse the comma-delimited message. The extracted fields include authorization date, time, card number, authorization type, card expiry date, message type, message source, processing code, transaction amount (alphanumeric), merchant category code, acquirer country code, POS entry mode, merchant ID, merchant name, merchant city, merchant state, merchant zip, and transaction ID. It then converts the alphanumeric transaction amount (WS-TRANSACTION-AMT-AN) to a numeric value (PA-RQ-TRANSACTION-AMT) using the NUMVAL function and moves it to WS-TRANSACTION-AMT. No error handling is explicitly performed within this paragraph. It does not call any other paragraphs or programs.",
        "called_by": [],
        "calls": [],
        "citation": [
          351,
          381
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "2100-EXIT",
        "summary": null,
        "purpose": "This paragraph simply exits the 2100-EXTRACT-REQUEST-MSG paragraph. It serves as a standard exit point and does not perform any specific logic or data manipulation. It does not consume any inputs or produce any outputs. It does not make any decisions or handle any errors. It does not call any other paragraphs or programs.",
        "called_by": [],
        "calls": [],
        "citation": [
          382,
          385
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "3100-READ-REQUEST-MQ",
        "summary": null,
        "purpose": "This paragraph reads a request message from the MQ queue. It sets the MQGMO options for no syncpoint, waiting, conversion, and failing if quiescing. It moves the wait interval to MQGMO-WAITINTERVAL. It initializes the message ID and correlation ID in the MQMD. It then calls the MQGET API to retrieve the message from the queue, using the connection and object handles, message descriptor, get message options, buffer length, and buffer. If the MQGET call is successful (WS-COMPCODE = MQCC-OK), it saves the correlation ID and reply-to queue name. If the call fails, it checks if the reason code is MQRC-NO-MSG-AVAILABLE and sets the NO-MORE-MSG-AVAILABLE flag. Otherwise, it logs an error message using 9500-LOG-ERROR, including the component code, reason code, and a descriptive message. The paragraph consumes the W01-HCONN-REQUEST, W01-HOBJ-REQUEST, MQM-MD-REQUEST, MQM-GET-MESSAGE-OPTIONS, W01-BUFFLEN and produces the W01-GET-BUFFER, W01-DATALEN, WS-COMPCODE, WS-REASON.",
        "called_by": [],
        "calls": [
          "MQGET",
          "9500-LOG-ERROR"
        ],
        "citation": [
          386,
          433
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "3100-EXIT",
        "summary": null,
        "purpose": "This paragraph simply exits the 3100-READ-REQUEST-MQ paragraph. It serves as a standard exit point and does not perform any specific logic or data manipulation. It does not consume any inputs or produce any outputs. It does not make any decisions or handle any errors. It does not call any other paragraphs or programs.",
        "called_by": [],
        "calls": [],
        "citation": [
          434,
          437
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "5000-PROCESS-AUTH",
        "summary": null,
        "purpose": "This paragraph is the main processing logic for authorization requests. It starts by setting APPROVE-AUTH to TRUE. It then performs 1200-SCHEDULE-PSB. It sets CARD-FOUND-XREF and FOUND-ACCT-IN-MSTR to TRUE. It then performs 5100-READ-XREF-RECORD to read the card cross-reference record. If the card is found in the cross-reference file (CARD-FOUND-XREF), it performs 5200-READ-ACCT-RECORD, 5300-READ-CUST-RECORD, 5500-READ-AUTH-SUMMRY, and 5600-READ-PROFILE-DATA. After reading the records, it performs 6000-MAKE-DECISION to determine whether to approve or decline the authorization. It then performs 7100-SEND-RESPONSE to send the response. Finally, if the card was found in the cross-reference file, it performs 8000-WRITE-AUTH-TO-DB to write the authorization data to the database. This paragraph orchestrates the entire authorization process, reading data from various sources, making a decision, sending a response, and writing data to the database. The inputs are PA-RQ-CARD-NUM, and the outputs are the authorization decision and the data written to the database. It calls several other paragraphs to perform specific tasks.",
        "called_by": [],
        "calls": [
          "1200-SCHEDULE-PSB",
          "5100-READ-XREF-RECORD",
          "5200-READ-ACCT-RECORD",
          "5300-READ-CUST-RECORD",
          "5500-READ-AUTH-SUMMRY",
          "5600-READ-PROFILE-DATA",
          "6000-MAKE-DECISION",
          "7100-SEND-RESPONSE",
          "8000-WRITE-AUTH-TO-DB"
        ],
        "citation": [
          438,
          467
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "5000-EXIT",
        "summary": null,
        "purpose": "This paragraph simply exits the 5000-PROCESS-AUTH paragraph. It serves as a standard exit point and does not perform any specific logic or data manipulation. It does not consume any inputs or produce any outputs. It does not make any decisions or handle any errors. It does not call any other paragraphs or programs.",
        "called_by": [],
        "calls": [],
        "citation": [
          468,
          471
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "5100-READ-XREF-RECORD",
        "summary": null,
        "purpose": "This paragraph reads the card cross-reference record from the WS-CCXREF-FILE. It moves the card number (PA-RQ-CARD-NUM) to the XREF-CARD-NUM field. It then executes a CICS READ command to read the CARD-XREF-RECORD from the WS-CCXREF-FILE using the XREF-CARD-NUM as the RIDFLD. It evaluates the CICS response code (WS-RESP-CD). If the response is DFHRESP(NORMAL), it sets CARD-FOUND-XREF to TRUE. If the response is DFHRESP(NOTFND), it sets CARD-NFOUND-XREF and NFOUND-ACCT-IN-MSTR to TRUE and logs a warning message using 9500-LOG-ERROR. If the response is OTHER, it logs a critical error message using 9500-LOG-ERROR. The input is PA-RQ-CARD-NUM, and the output is the CARD-XREF-RECORD. It calls 9500-LOG-ERROR in case of errors.",
        "called_by": [],
        "calls": [
          "9500-LOG-ERROR",
          "9500-LOG-ERROR"
        ],
        "citation": [
          472,
          515
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "5100-EXIT",
        "summary": null,
        "purpose": "This paragraph simply exits the 5100-READ-XREF-RECORD paragraph. It serves as a standard exit point and does not perform any specific logic or data manipulation. It does not consume any inputs or produce any outputs. It does not make any decisions or handle any errors. It does not call any other paragraphs or programs.",
        "called_by": [],
        "calls": [],
        "citation": [
          516,
          519
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "5200-READ-ACCT-RECORD",
        "summary": null,
        "purpose": "This paragraph reads the account record from the WS-ACCTFILENAME. It moves the account ID (XREF-ACCT-ID) to WS-CARD-RID-ACCT-ID. It then executes a CICS READ command to read the ACCOUNT-RECORD from the WS-ACCTFILENAME using WS-CARD-RID-ACCT-ID-X as the RIDFLD. It evaluates the CICS response code (WS-RESP-CD). If the response is DFHRESP(NORMAL), it sets FOUND-ACCT-IN-MSTR to TRUE. If the response is DFHRESP(NOTFND), it sets NFOUND-ACCT-IN-MSTR to TRUE and logs a warning message using 9500-LOG-ERROR. If the response is OTHER, it logs a critical error message using 9500-LOG-ERROR. The input is XREF-ACCT-ID, and the output is the ACCOUNT-RECORD. It calls 9500-LOG-ERROR in case of errors.",
        "called_by": [],
        "calls": [
          "9500-LOG-ERROR",
          "9500-LOG-ERROR"
        ],
        "citation": [
          520,
          563
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "5200-EXIT",
        "summary": null,
        "purpose": "This paragraph simply exits the 5200-READ-ACCT-RECORD paragraph. It serves as a standard exit point and does not perform any specific logic or data manipulation. It does not consume any inputs or produce any outputs. It does not make any decisions or handle any errors. It does not call any other paragraphs or programs.",
        "called_by": [],
        "calls": [],
        "citation": [
          564,
          567
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      }
    ],
    "error_handling": [
      {
        "condition": "WS-REASON = MQRC-NO-MSG-AVAILABLE",
        "action": "SET NO-MORE-MSG-AVAILABLE TO TRUE",
        "citation": [
          65,
          66
        ]
      },
      {
        "condition": "WS-COMPCODE not equal to MQCC-OK",
        "action": "Log error and perform 9500-LOG-ERROR",
        "citation": [
          59,
          78
        ]
      },
      {
        "condition": "WS-RESP-CD not equal to DFHRESP(NORMAL) and equal to DFHRESP(NOTFND) in 5100-READ-XREF-RECORD",
        "action": "SET CARD-NFOUND-XREF TO TRUE, SET NFOUND-ACCT-IN-MSTR TO TRUE, log warning and perform 9500-LOG-ERROR",
        "citation": [
          137,
          147
        ]
      },
      {
        "condition": "WS-RESP-CD not equal to DFHRESP(NORMAL) in 5100-READ-XREF-RECORD",
        "action": "Log critical error and perform 9500-LOG-ERROR",
        "citation": [
          148,
          159
        ]
      },
      {
        "condition": "WS-RESP-CD not equal to DFHRESP(NORMAL) and equal to DFHRESP(NOTFND) in 5200-READ-ACCT-RECORD",
        "action": "SET NFOUND-ACCT-IN-MSTR TO TRUE, log warning and perform 9500-LOG-ERROR",
        "citation": [
          184,
          193
        ]
      },
      {
        "condition": "WS-RESP-CD not equal to DFHRESP(NORMAL) in 5200-READ-ACCT-RECORD",
        "action": "Log critical error and perform 9500-LOG-ERROR",
        "citation": [
          195,
          206
        ]
      }
    ],
    "sql_operations": [],
    "cics_operations": [
      {
        "command": "READ",
        "resource": "WS-CCXREF-FILE",
        "purpose": "Read card cross-reference record.",
        "citation": 124
      },
      {
        "command": "READ",
        "resource": "WS-ACCTFILENAME",
        "purpose": "Read account record.",
        "citation": 171
      }
    ],
    "open_questions": [
      {
        "question": "What is the purpose of 1200-SCHEDULE-PSB?",
        "context": "The code calls 1200-SCHEDULE-PSB, but the source code for this paragraph is not provided.",
        "suggestion": "Need to examine the source code of 1200-SCHEDULE-PSB to understand its functionality."
      },
      {
        "question": "What is the purpose of 5300-READ-CUST-RECORD, 5500-READ-AUTH-SUMMRY, 5600-READ-PROFILE-DATA, 6000-MAKE-DECISION, 7100-SEND-RESPONSE, and 8000-WRITE-AUTH-TO-DB?",
        "context": "The code calls these paragraphs, but the source code for these paragraphs is not provided.",
        "suggestion": "Need to examine the source code of these paragraphs to understand their functionality."
      }
    ],
    "resolved_questions": [],
    "dead_code": [],
    "call_semantics": [],
    "flow_diagram": null
  },
  "saved_at": "2026-02-24T10:36:39.978801"
}