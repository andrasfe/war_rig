{
  "batch_idx": 1,
  "total_batches": 2,
  "template": {
    "header": {
      "program_id": "CBPAUP0C",
      "file_name": "cbl/CBPAUP0C.cbl",
      "file_type": "COBOL",
      "analyzed_by": "WAR_RIG",
      "analyzed_at": "2026-02-25T15:25:52.671403",
      "iteration_count": 1,
      "final_status": null
    },
    "purpose": {
      "summary": "Deletes authorization detail (PAUTDTL1) and summary (PAUTSUM0) segments from the PAUT IMS database using DL/I DLET calls for pending authorizations. Increments counters for successful deletions and checkpoints, abending the program if any DL/I operation fails (DIBSTAT not spaces). Periodically takes IMS checkpoints every P-CHKP-DIS-FREQ successful checkpoints, displaying progress information.",
      "business_context": null,
      "program_type": "BATCH",
      "citations": [
        303,
        328,
        352
      ]
    },
    "inputs": [
      {
        "name": "PAUT-PCB-NUM",
        "io_type": "IMS_SEGMENT",
        "description": "IMS DL/I PCB used for DLET and CHKP operations on PAUT database segments PAUTDTL1 and PAUTSUM0",
        "copybook": null,
        "citation": [
          303,
          328,
          352
        ]
      },
      {
        "name": "PENDING-AUTH-DETAILS",
        "io_type": "OTHER",
        "description": "Working storage area containing key data (including PA-ACCT-ID) for deleting PAUTDTL1 segment",
        "copybook": null,
        "citation": [
          303
        ]
      },
      {
        "name": "PENDING-AUTH-SUMMARY",
        "io_type": "OTHER",
        "description": "Working storage area containing key data (including PA-ACCT-ID) for deleting PAUTSUM0 segment",
        "copybook": null,
        "citation": [
          328
        ]
      },
      {
        "name": "P-CHKP-DIS-FREQ",
        "io_type": "PARAMETER",
        "description": "Parameter defining checkpoint display frequency",
        "copybook": null,
        "citation": [
          352
        ]
      },
      {
        "name": "WK-CHKPT-ID",
        "io_type": "OTHER",
        "description": "Working storage checkpoint ID used in CHKP call",
        "copybook": null,
        "citation": [
          352
        ]
      }
    ],
    "outputs": [
      {
        "name": "PAUT IMS Database",
        "io_type": "IMS_SEGMENT",
        "description": "Deleted PAUTDTL1 and PAUTSUM0 segments",
        "copybook": null,
        "citation": [
          303,
          328
        ]
      },
      {
        "name": "WS-NO-DTL-DELETED",
        "io_type": "OTHER",
        "description": "Counter incremented for each successful detail deletion",
        "copybook": null,
        "citation": [
          303
        ]
      },
      {
        "name": "WS-NO-SUMRY-DELETED",
        "io_type": "OTHER",
        "description": "Counter incremented for each successful summary deletion",
        "copybook": null,
        "citation": [
          328
        ]
      },
      {
        "name": "WS-NO-CHKP",
        "io_type": "OTHER",
        "description": "Checkpoint counter incremented and reset periodically",
        "copybook": null,
        "citation": [
          352
        ]
      },
      {
        "name": "RETURN-CODE",
        "io_type": "RETURN_CODE",
        "description": "Set to 16 upon abend",
        "copybook": null,
        "citation": [
          377
        ]
      }
    ],
    "called_programs": [],
    "calling_context": {
      "called_by": [],
      "entry_points": [],
      "linkage_section": []
    },
    "business_rules": [
      {
        "rule_id": "BR001",
        "description": "Successful DL/I DLET (DIBSTAT = SPACES) increments deletion counter",
        "logic_summary": "ADD 1 TO counter after DLET if DIBSTAT = SPACES",
        "conditions": [
          "DIBSTAT = SPACES"
        ],
        "citation": [
          303,
          328
        ]
      },
      {
        "rule_id": "BR002",
        "description": "Failed DL/I DLET (DIBSTAT not SPACES) displays error and abends",
        "logic_summary": "DISPLAY error messages and PERFORM 9999-ABEND",
        "conditions": [
          "DIBSTAT != SPACES"
        ],
        "citation": [
          303,
          328
        ]
      },
      {
        "rule_id": "BR003",
        "description": "Take IMS checkpoint and increment counter; display and reset counter if frequency reached",
        "logic_summary": "EXEC DLI CHKP; if successful and WS-NO-CHKP >= P-CHKP-DIS-FREQ, display stats and reset",
        "conditions": [
          "DIBSTAT = SPACES",
          "WS-NO-CHKP >= P-CHKP-DIS-FREQ"
        ],
        "citation": [
          352
        ]
      },
      {
        "rule_id": "BR004",
        "description": "Failed checkpoint abends program",
        "logic_summary": "DISPLAY error and PERFORM 9999-ABEND if DIBSTAT != SPACES",
        "conditions": [
          "DIBSTAT != SPACES"
        ],
        "citation": [
          352
        ]
      }
    ],
    "data_flow": {
      "reads_from": [
        {
          "source": "PENDING-AUTH-DETAILS",
          "fields_used": [
            "PA-ACCT-ID"
          ],
          "citation": [
            303
          ]
        },
        {
          "source": "PENDING-AUTH-SUMMARY",
          "fields_used": [
            "PA-ACCT-ID"
          ],
          "citation": [
            328
          ]
        },
        {
          "source": "DIBSTAT",
          "fields_used": [
            "DIBSTAT"
          ],
          "citation": [
            303,
            328,
            352
          ]
        },
        {
          "source": "DEBUG-ON",
          "fields_used": [
            "DEBUG-ON"
          ],
          "citation": [
            303,
            328
          ]
        },
        {
          "source": "WS-NO-CHKP",
          "fields_used": [
            "WS-NO-CHKP"
          ],
          "citation": [
            352
          ]
        },
        {
          "source": "P-CHKP-DIS-FREQ",
          "fields_used": [
            "P-CHKP-DIS-FREQ"
          ],
          "citation": [
            352
          ]
        },
        {
          "source": "WS-NO-SUMRY-READ",
          "fields_used": [
            "WS-NO-SUMRY-READ"
          ],
          "citation": [
            352
          ]
        },
        {
          "source": "WS-CURR-APP-ID",
          "fields_used": [
            "WS-CURR-APP-ID"
          ],
          "citation": [
            352
          ]
        }
      ],
      "writes_to": [
        {
          "destination": "PAUT IMS Database",
          "fields_written": [
            "PAUTDTL1",
            "PAUTSUM0"
          ],
          "citation": [
            303,
            328
          ]
        },
        {
          "destination": "WS-NO-DTL-DELETED",
          "fields_written": [
            "WS-NO-DTL-DELETED"
          ],
          "citation": [
            303
          ]
        },
        {
          "destination": "WS-NO-SUMRY-DELETED",
          "fields_written": [
            "WS-NO-SUMRY-DELETED"
          ],
          "citation": [
            328
          ]
        },
        {
          "destination": "WS-NO-CHKP",
          "fields_written": [
            "WS-NO-CHKP"
          ],
          "citation": [
            352
          ]
        },
        {
          "destination": "RETURN-CODE",
          "fields_written": [
            "RETURN-CODE"
          ],
          "citation": [
            377
          ]
        }
      ],
      "transforms": []
    },
    "copybooks_used": [],
    "paragraphs": [
      {
        "paragraph_name": "5000-DELETE-AUTH-DTL",
        "summary": null,
        "purpose": "The 5000-DELETE-AUTH-DTL paragraph is responsible for deleting a specific authorization detail segment (PAUTDTL1) from the PAUT IMS database. It consumes input from the PENDING-AUTH-DETAILS working storage area, which holds the segment key data including PA-ACCT-ID, and the PAUT-PCB-NUM PCB. If DEBUG-ON is true, it displays a debug message with PA-ACCT-ID before the deletion. It performs an EXEC DLI DLET using the PCB, specifying the PAUTDTL1 segment and the key from PENDING-AUTH-DETAILS. After the DLET, it checks DIBSTAT: if SPACES, it increments WS-NO-DTL-DELETED counter, indicating successful deletion; otherwise, it displays error messages with DIBSTAT and PA-ACCT-ID, then performs 9999-ABEND to terminate the program. There are no other paragraphs called besides the potential abend. This ensures atomic deletion of detail records with immediate failure handling for data integrity.",
        "called_by": [],
        "calls": [
          "9999-ABEND"
        ],
        "citation": [
          303,
          323
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "5000-EXIT",
        "summary": null,
        "purpose": "The 5000-EXIT paragraph serves as the standard exit point for the 5000-DELETE-AUTH-DTL paragraph. It consumes no inputs and reads no data or files. It produces no outputs, modifies no variables, and performs no writes. There is no business logic, conditions, or decisions implemented in this paragraph. No error handling is performed as it assumes successful completion of the prior deletion logic. It contains only an EXIT statement, which transfers control back to the calling paragraph without any further action. This maintains proper control flow in the COBOL PERFORM structure.",
        "called_by": [],
        "calls": [],
        "citation": [
          324,
          327
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "6000-DELETE-AUTH-SUMMARY",
        "summary": null,
        "purpose": "The 6000-DELETE-AUTH-SUMMARY paragraph handles the deletion of an authorization summary segment (PAUTSUM0) from the PAUT IMS database. It reads from the PENDING-AUTH-SUMMARY working storage area containing the segment key including PA-ACCT-ID, and uses the PAUT-PCB-NUM PCB. If DEBUG-ON, it displays a debug message with PA-ACCT-ID. It executes a DL/I DLET specifying PAUTSUM0 and the key from PENDING-AUTH-SUMMARY. Post-deletion, it evaluates DIBSTAT: if SPACES, adds 1 to WS-NO-SUMRY-DELETED; else, displays failure details with DIBSTAT and PA-ACCT-ID, then performs 9999-ABEND. No other calls are made except potential abend. This paragraph ensures summary records are deleted reliably after details, with strict error handling to prevent partial updates.",
        "called_by": [],
        "calls": [
          "9999-ABEND"
        ],
        "citation": [
          328,
          347
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "6000-EXIT",
        "summary": null,
        "purpose": "The 6000-EXIT paragraph acts as the exit routine for the 6000-DELETE-AUTH-SUMMARY paragraph. It does not consume any inputs or read from files or variables. No outputs are produced, and no data modifications occur. No business rules, validations, or conditional logic are applied. Error handling is not relevant here as it follows successful summary deletion. It solely executes an EXIT statement to return control to the invoker. This paragraph enforces standard COBOL flow control discipline.",
        "called_by": [],
        "calls": [],
        "citation": [
          348,
          351
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "9000-TAKE-CHECKPOINT",
        "summary": null,
        "purpose": "The 9000-TAKE-CHECKPOINT paragraph manages IMS checkpointing to ensure database consistency during batch processing. It consumes WS-NO-CHKP counter, P-CHKP-DIS-FREQ parameter, WS-NO-SUMRY-READ, WS-CURR-APP-ID, and WK-CHKPT-ID. It executes DL/I CHKP using WK-CHKPT-ID. If DIBSTAT = SPACES, it increments WS-NO-CHKP; if this reaches or exceeds P-CHKP-DIS-FREQ, resets WS-NO-CHKP to 0 and displays checkpoint success with record count and app ID. If DIBSTAT not SPACES, displays failure details and performs 9999-ABEND. No other paragraphs are called except abend. This implements periodic commit points critical for long-running IMS batch jobs, balancing recovery needs with performance.",
        "called_by": [],
        "calls": [
          "9999-ABEND"
        ],
        "citation": [
          352,
          372
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "9000-EXIT",
        "summary": null,
        "purpose": "The 9000-EXIT paragraph provides the exit mechanism for the 9000-TAKE-CHECKPOINT paragraph. It reads no data and has no inputs from files or storage. It generates no outputs or changes to variables. There are no decisions, loops, or business logic executed. Error conditions are handled upstream before reaching this exit. It performs a single EXIT to return control to the caller. This simple structure supports modular PERFORM/EXIT patterns in the program.",
        "called_by": [],
        "calls": [],
        "citation": [
          373,
          376
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "9999-ABEND",
        "summary": null,
        "purpose": "The 9999-ABEND paragraph is the central error termination routine invoked on any DL/I failure. It consumes no specific inputs but is triggered by error conditions in prior paragraphs. It displays 'CBPAUP0C ABENDING ...' to the console or log. It then sets RETURN-CODE to 16 to signal abnormal end to the caller or JCL. No validations or further conditions are checked. It executes GOBACK to terminate the program. This ensures consistent abend handling across the module, preventing continuation on database errors.",
        "called_by": [
          "5000-DELETE-AUTH-DTL",
          "6000-DELETE-AUTH-SUMMARY",
          "9000-TAKE-CHECKPOINT"
        ],
        "calls": [],
        "citation": [
          377,
          384
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "9999-EXIT",
        "summary": null,
        "purpose": "The 9999-EXIT paragraph functions as an exit for the 9999-ABEND section, though rarely reached due to GOBACK. It processes no inputs or data reads. No outputs or modifications are made. No logic, conditions, or error handling is present. It issues an EXIT statement for potential return, but contextually supports PERFORM structures. This maintains code standardization even in terminal routines.",
        "called_by": [],
        "calls": [],
        "citation": [
          385,
          386
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      }
    ],
    "error_handling": [
      {
        "condition": "DIBSTAT != SPACES after DLET PAUTDTL1",
        "action": "DISPLAY error messages and PERFORM 9999-ABEND",
        "citation": [
          303
        ]
      },
      {
        "condition": "DIBSTAT != SPACES after DLET PAUTSUM0",
        "action": "DISPLAY error messages and PERFORM 9999-ABEND",
        "citation": [
          328
        ]
      },
      {
        "condition": "DIBSTAT != SPACES after CHKP",
        "action": "DISPLAY error messages and PERFORM 9999-ABEND",
        "citation": [
          352
        ]
      },
      {
        "condition": "Any DL/I failure",
        "action": "MOVE 16 TO RETURN-CODE and GOBACK",
        "citation": [
          377
        ]
      }
    ],
    "sql_operations": [],
    "cics_operations": [],
    "open_questions": [
      {
        "question": "What loads data into PENDING-AUTH-DETAILS and PENDING-AUTH-SUMMARY?",
        "context": "These WS areas provide keys for DLET but source of data (prior GU/GET?) not in fragment",
        "suggestion": "Analyze earlier paragraphs like 0000-MAIN or 2000-READ"
      },
      {
        "question": "What is the full program flow and calling context for these paragraphs?",
        "context": "Fragment shows only deletion/checkpoint; no main logic or how these are invoked",
        "suggestion": "Provide AST for full source or prior/next paragraphs"
      },
      {
        "question": "What copybooks define PAUTDTL1, PAUTSUM0, PCBs, and WS areas?",
        "context": "No COPY statements visible in fragment",
        "suggestion": "Scan for COPY in full file or related copybooks"
      },
      {
        "question": "Business context of PAUT database and pending authorizations?",
        "context": "Names suggest payment auth, but no comments or full logic",
        "suggestion": "Review program docs or related JCL/PROCs"
      }
    ],
    "resolved_questions": [],
    "dead_code": [],
    "call_semantics": [],
    "flow_diagram": null
  },
  "saved_at": "2026-02-25T08:25:52.673136"
}