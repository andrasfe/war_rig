{
  "batch_idx": 0,
  "total_batches": 2,
  "template": {
    "header": {
      "program_id": "DBUNLDGS",
      "file_name": "cbl/DBUNLDGS.CBL",
      "file_type": "COBOL",
      "analyzed_by": "WAR_RIG",
      "analyzed_at": "2026-02-25T15:21:15.615213",
      "iteration_count": 1,
      "final_status": null
    },
    "purpose": {
      "summary": "DBUNLDGS is a batch utility that unloads IMS authorization summary (root) and detail (child) segments from the PAUT database into GSAM files via PASFLPCB and presumably PADFLPCB. It sequentially reads root segments using GN calls, inserts each into the parent GSAM, then reads and inserts all child segments using GNP calls until GE condition. The process repeats until GB on root read, with error abends on invalid PCB statuses.",
      "business_context": "Supports data migration or archiving of authorization database records from hierarchical IMS to GSAM sequential access method files, likely for reporting or further processing in an audit or financial system.",
      "program_type": "BATCH",
      "citations": [
        164,
        182,
        216,
        263
      ]
    },
    "inputs": [
      {
        "name": "PAUTBPCB",
        "io_type": "IMS_SEGMENT",
        "description": "IMS PCB for reading authorization root (summary) and child (detail) segments from PAUT database",
        "copybook": null,
        "citation": [
          197,
          216,
          241,
          263
        ]
      },
      {
        "name": "PASFLPCB",
        "io_type": "IMS_SEGMENT",
        "description": "IMS PCB passed as parameter for writing parent GSAM segments",
        "copybook": null,
        "citation": [
          142,
          271
        ]
      },
      {
        "name": "PADFLPCB",
        "io_type": "IMS_SEGMENT",
        "description": "IMS PCB passed as parameter, likely for writing child GSAM segments (inferred from naming and context)",
        "copybook": null,
        "citation": [
          142
        ]
      }
    ],
    "outputs": [
      {
        "name": "PASFLPCB",
        "io_type": "IMS_SEGMENT",
        "description": "GSAM file receiving inserted parent authorization summary segments",
        "copybook": null,
        "citation": [
          271,
          300
        ]
      },
      {
        "name": "PADFLPCB",
        "io_type": "IMS_SEGMENT",
        "description": "GSAM file receiving inserted child authorization detail segments (inferred usage in 3200-INSERT-CHILD-SEG-GSAM)",
        "copybook": null,
        "citation": [
          255
        ]
      }
    ],
    "called_programs": [],
    "calling_context": {
      "called_by": [],
      "entry_points": [],
      "linkage_section": [
        "PAUTBPCB",
        "PASFLPCB",
        "PADFLPCB"
      ]
    },
    "business_rules": [
      {
        "rule_id": "BR001",
        "description": "Process only numeric PA-ACCT-ID for root segment insertion",
        "logic_summary": "Checks IF PA-ACCT-ID IS NUMERIC before performing insert",
        "conditions": [
          "PA-ACCT-ID IS NUMERIC"
        ],
        "citation": [
          216
        ]
      },
      {
        "rule_id": "BR002",
        "description": "End root processing on GB status from GN call",
        "logic_summary": "Sets WS-END-OF-ROOT-SEG to 'Y' if PAUT-PCB-STATUS = 'GB'",
        "conditions": [
          "PAUT-PCB-STATUS = 'GB'"
        ],
        "citation": [
          223
        ]
      },
      {
        "rule_id": "BR003",
        "description": "End child processing on GE status from GNP call",
        "logic_summary": "Sets WS-END-OF-CHILD-SEG to 'Y' if PAUT-PCB-STATUS = 'GE'",
        "conditions": [
          "PAUT-PCB-STATUS = 'GE'"
        ],
        "citation": [
          257
        ]
      }
    ],
    "data_flow": {
      "reads_from": [
        {
          "source": "PAUTBPCB",
          "fields_used": [
            "PAUT-PCB-STATUS",
            "PAUT-SEG-LEVEL",
            "PAUT-SEG-NAME",
            "PAUT-KEYFB",
            "PENDING-AUTH-SUMMARY",
            "PENDING-AUTH-DETAILS"
          ],
          "citation": [
            197,
            241,
            263
          ]
        }
      ],
      "writes_to": [
        {
          "destination": "PASFLPCB",
          "fields_written": [
            "PENDING-AUTH-SUMMARY"
          ],
          "citation": [
            271
          ]
        },
        {
          "destination": "PADFLPCB",
          "fields_written": [
            "PENDING-AUTH-DETAILS"
          ],
          "citation": [
            255
          ]
        }
      ],
      "transforms": [
        {
          "input_field": "PENDING-AUTH-SUMMARY",
          "output_field": "OPFIL1-REC",
          "transformation_description": "MOVE PENDING-AUTH-SUMMARY TO OPFIL1-REC before insert preparation; ROOT-SEG-KEY set from PA-ACCT-ID",
          "citation": [
            211,
            214
          ]
        },
        {
          "input_field": "PENDING-AUTH-DETAILS",
          "output_field": "CHILD-SEG-REC",
          "transformation_description": "MOVE PENDING-AUTH-DETAILS TO CHILD-SEG-REC before child insert",
          "citation": [
            254
          ]
        }
      ]
    },
    "copybooks_used": [],
    "paragraphs": [
      {
        "paragraph_name": "DBUNLDGS",
        "summary": null,
        "purpose": "DBUNLDGS serves as the program entry point paragraph, likely containing the initial setup or linkage convention, but primarily identified as the PROGRAM-ID context. It receives control implicitly upon program invocation. No explicit data consumption or production is shown in this minimal paragraph. There are no business decisions or validations performed here. No error handling is present. It delegates flow to MAIN-PARA implicitly as the main logic orchestrator. This paragraph's role is foundational, enabling the alternate ENTRY 'DLITCBL' in MAIN-PARA for linkage parameters.",
        "called_by": [],
        "calls": [],
        "citation": [
          18,
          18
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "MAIN-PARA",
        "summary": null,
        "purpose": "MAIN-PARA is the primary orchestration paragraph controlling the overall unload process from IMS to GSAM. It establishes an alternate entry point 'DLITCBL' using linkage parameters PAUTBPCB, PASFLPCB, and PADFLPCB, which provide IMS PCBs for input reading and output insertion. It consumes these PCBs and WS-END-OF-ROOT-SEG flag as loop control. It produces completed GSAM inserts by delegating to initialization, processing loop, and close. The business logic implements a top-down hierarchical unload: initialize, loop over root summaries until end (GB), processing children for each root, then close files. No direct error handling here; relies on abends from subordinates. It calls 1000-INITIALIZE for setup including date acceptance and displays, 2000-FIND-NEXT-AUTH-SUMMARY in a loop for root and nested child processing, and 4000-FILE-CLOSE for termination.",
        "called_by": [
          "DBUNLDGS"
        ],
        "calls": [
          "1000-INITIALIZE",
          "2000-FIND-NEXT-AUTH-SUMMARY",
          "4000-FILE-CLOSE"
        ],
        "citation": [
          164,
          181
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "1000-INITIALIZE",
        "summary": null,
        "purpose": "1000-INITIALIZE handles program startup by accepting system date information and displaying startup messages. It consumes DATE and DAY from system for CURRENT-DATE and CURRENT-YYDDD. It produces display output to console for logging start time and date. No business decisions or validations are made. No error handling is implemented. No calls to other paragraphs. This paragraph sets the stage for processing by logging entry without file opens or data initialization beyond dates.",
        "called_by": [
          "MAIN-PARA"
        ],
        "calls": [],
        "citation": [
          182,
          211
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "1000-EXIT",
        "summary": null,
        "purpose": "1000-EXIT is a simple flow control exit point returning to the caller after 1000-INITIALIZE. It consumes no data. It produces no outputs or modifications. No logic, conditions, or error handling. No calls made. Its role is to cleanly terminate the initialization paragraph scope.",
        "called_by": [
          "1000-INITIALIZE"
        ],
        "calls": [],
        "citation": [
          212,
          215
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "2000-FIND-NEXT-AUTH-SUMMARY",
        "summary": null,
        "purpose": "2000-FIND-NEXT-AUTH-SUMMARY orchestrates reading and processing of each authorization root summary segment, including nested child details. It consumes PAUTBPCB for IMS GN call into PENDING-AUTH-SUMMARY, using ROOT-UNQUAL-SSA, and reads PA-ACCT-ID, PAUT-PCB-STATUS. It produces inserts to parent GSAM via 3100, increments counters WS-NO-SUMRY-READ and WS-AUTH-SMRY-PROC-CNT, sets ROOT-SEG-KEY and CHILD-SEG-REC. Business logic: if status SPACES, process numeric acct ID root insert then loop children until end; if GB set root EOF; else error abend. Error handling checks status != SPACES or GB, displays feedback and abends. Calls CBLTDLI GN (197-200), 3100-INSERT-PARENT-SEG-GSAM (217), 3000-FIND-NEXT-AUTH-DTL loop (219), 9999-ABEND on error (230).",
        "called_by": [
          "MAIN-PARA"
        ],
        "calls": [
          "CBLTDLI",
          "3100-INSERT-PARENT-SEG-GSAM",
          "3000-FIND-NEXT-AUTH-DTL",
          "9999-ABEND"
        ],
        "citation": [
          216,
          257
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "2000-EXIT",
        "summary": null,
        "purpose": "2000-EXIT provides clean exit from the root summary processing paragraph. No inputs consumed or outputs produced. No decisions, validations, or errors handled. No calls. Ensures proper return to loop controller in MAIN-PARA.",
        "called_by": [
          "2000-FIND-NEXT-AUTH-SUMMARY"
        ],
        "calls": [],
        "citation": [
          258,
          262
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "3000-FIND-NEXT-AUTH-DTL",
        "summary": null,
        "purpose": "3000-FIND-NEXT-AUTH-DTL manages reading sequential child authorization detail segments under current root. Consumes PAUTBPCB via GNP call into PENDING-AUTH-DETAILS using CHILD-UNQUAL-SSA, checks PAUT-PCB-STATUS. Produces child inserts via 3200, increments counters WS-NO-SUMRY-READ and WS-AUTH-SMRY-PROC-CNT, sets CHILD-SEG-REC, sets WS-END-OF-CHILD-SEG on GE. Business logic: if SPACES insert child; if GE end children; else abend. Error handling: status != SPACES/GE displays keyfb and abends (264-266). Calls CBLTDLI GNP (241-244), 3200-INSERT-CHILD-SEG-GSAM (255), 9999-ABEND. Initializes status post-check.",
        "called_by": [
          "2000-FIND-NEXT-AUTH-SUMMARY"
        ],
        "calls": [
          "CBLTDLI",
          "3200-INSERT-CHILD-SEG-GSAM",
          "9999-ABEND"
        ],
        "citation": [
          263,
          295
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "3000-EXIT",
        "summary": null,
        "purpose": "3000-EXIT is the termination point for child detail processing loop iteration. No data I/O, logic, or error handling. No calls. Returns control to allow loop continuation until child EOF.",
        "called_by": [
          "3000-FIND-NEXT-AUTH-DTL"
        ],
        "calls": [],
        "citation": [
          296,
          299
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "3100-INSERT-PARENT-SEG-GSAM",
        "summary": null,
        "purpose": "3100-INSERT-PARENT-SEG-GSAM performs the IMS ISRT call to insert the current root summary into GSAM via PASFLPCB. Consumes PENDING-AUTH-SUMMARY and PASFL-PCB-STATUS. Produces inserted segment or error display. Business logic: single decision on status != SPACES to abend. Error handling: if PASFL-PCB-STATUS not SPACES, display status/keyfb and abend (311). Calls CBLTDLI ISRT (271-273), 9999-ABEND on failure.",
        "called_by": [
          "2000-FIND-NEXT-AUTH-SUMMARY"
        ],
        "calls": [
          "CBLTDLI",
          "9999-ABEND"
        ],
        "citation": [
          300,
          315
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      },
      {
        "paragraph_name": "3100-EXIT",
        "summary": null,
        "purpose": "3100-EXIT exits the parent insert paragraph cleanly. No inputs, outputs, logic, errors, or calls. Returns to caller post-insert.",
        "called_by": [
          "3100-INSERT-PARENT-SEG-GSAM"
        ],
        "calls": [],
        "citation": [
          316,
          318
        ],
        "outgoing_calls": [],
        "incoming_calls": [],
        "is_dead_code": false,
        "dead_code_reason": null,
        "metadata": null
      }
    ],
    "error_handling": [
      {
        "condition": "PAUT-PCB-STATUS NOT = SPACES AND 'GB'",
        "action": "DISPLAY status and keyfb, PERFORM 9999-ABEND",
        "citation": [
          227
        ]
      },
      {
        "condition": "PAUT-PCB-STATUS NOT = SPACES AND 'GE'",
        "action": "DISPLAY status and keyfb, PERFORM 9999-ABEND",
        "citation": [
          264
        ]
      },
      {
        "condition": "PASFL-PCB-STATUS NOT = SPACES",
        "action": "DISPLAY status and keyfb, PERFORM 9999-ABEND",
        "citation": [
          311
        ]
      }
    ],
    "sql_operations": [],
    "cics_operations": [],
    "open_questions": [
      {
        "question": "Details of 3200-INSERT-CHILD-SEG-GSAM, 4000-FILE-CLOSE, 9999-ABEND paragraphs",
        "context": "AST provided is partial, cuts off after 3100-EXIT; only referenced in PERFORMs",
        "suggestion": "Provide full AST or source for these paragraphs"
      },
      {
        "question": "Exact copybook names for PCBs and segments like PAUTBPCB, PENDING-AUTH-SUMMARY",
        "context": "Not visible in provided AST; inferred from variable usage",
        "suggestion": "Include WORKING-STORAGE and FILE sections"
      },
      {
        "question": "Role of PADFLPCB",
        "context": "Passed in ENTRY but not used in visible AST; likely for 3200 child insert",
        "suggestion": "Confirm in full source"
      }
    ],
    "resolved_questions": [],
    "dead_code": [],
    "call_semantics": [],
    "flow_diagram": null
  },
  "saved_at": "2026-02-25T08:21:15.616632"
}