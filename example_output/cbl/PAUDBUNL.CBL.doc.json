{
  "header": {
    "program_id": "PAUDBUNL",
    "file_name": "PAUDBUNL.CBL",
    "file_type": "COBOL",
    "analyzed_by": "WAR_RIG",
    "analyzed_at": "2026-02-24T17:42:26.182361",
    "iteration_count": 1,
    "final_status": null
  },
  "purpose": {
    "summary": "The COBOL program PAUDBUNL unloads pending authorization summary and detail segments from an IMS database and writes them to two sequential output files. It reads the PAUTSUM0 root segment and PAUTDTL1 child segment from the IMS database and writes them to OPFILE1 and OPFILE2 respectively, filtering for numeric PA-ACCT-ID.",
    "business_context": null,
    "program_type": "BATCH",
    "citations": [
      18,
      213,
      271
    ]
  },
  "inputs": [
    {
      "name": "IMS Database (PAUTSUM0, PAUTDTL1 segments)",
      "io_type": "IMS_SEGMENT",
      "description": "Pending authorization summary (PAUTSUM0) and detail (PAUTDTL1) segments from an IMS database.",
      "copybook": "CIPAUSMY, CIPAUDTY",
      "citation": [
        213,
        237
      ]
    },
    {
      "name": "PAUTBPCB",
      "io_type": "PARAMETER",
      "description": "PCB mask for IMS calls.",
      "copybook": "PAUTBPCB",
      "citation": [
        153
      ]
    }
  ],
  "outputs": [
    {
      "name": "OPFILE1",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Pending authorization summary records (PAUTSUM0).",
      "copybook": "CIPAUSMY",
      "citation": [
        233
      ]
    },
    {
      "name": "OPFILE2",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Pending authorization detail records (PAUTDTL1).",
      "copybook": "CIPAUDTY",
      "citation": [
        271
      ]
    }
  ],
  "called_programs": [
    {
      "program_name": "CBLTDLI",
      "call_type": "STATIC_CALL",
      "purpose": "Performs IMS database calls.",
      "parameters": [
        "FUNC-GN",
        "PAUTBPCB",
        "PENDING-AUTH-SUMMARY",
        "ROOT-UNQUAL-SSA"
      ],
      "citation": 213
    },
    {
      "program_name": "CBLTDLI",
      "call_type": "STATIC_CALL",
      "purpose": "Performs IMS database calls to retrieve child segments.",
      "parameters": [
        "FUNC-GNP",
        "PAUTBPCB",
        "PENDING-AUTH-DETAILS",
        "CHILD-UNQUAL-SSA"
      ],
      "citation": 237
    }
  ],
  "calling_context": {
    "called_by": [],
    "entry_points": [
      "DLITCBL"
    ],
    "linkage_section": [
      "PAUTBPCB"
    ]
  },
  "business_rules": [],
  "data_flow": {
    "reads_from": [
      {
        "source": "IMS Database (PAUTSUM0)",
        "fields_used": [
          "PA-ACCT-ID",
          "PENDING-AUTH-SUMMARY"
        ],
        "citation": [
          213,
          230
        ]
      },
      {
        "source": "IMS Database (PAUTDTL1)",
        "fields_used": [
          "PENDING-AUTH-DETAILS"
        ],
        "citation": [
          237
        ]
      }
    ],
    "writes_to": [
      {
        "destination": "OPFILE1",
        "fields_written": [
          "OPFIL1-REC"
        ],
        "citation": [
          233
        ]
      },
      {
        "destination": "OPFILE2",
        "fields_written": [
          "OPFIL2-REC",
          "ROOT-SEG-KEY",
          "CHILD-SEG-REC"
        ],
        "citation": [
          271
        ]
      }
    ],
    "transforms": []
  },
  "copybooks_used": [
    {
      "copybook_name": "IMSFUNCS",
      "purpose": "Contains definitions for IMS function codes.",
      "location": "WORKING_STORAGE",
      "citation": 132
    },
    {
      "copybook_name": "CIPAUSMY",
      "purpose": "Defines the layout of the PENDING-AUTH-SUMMARY segment.",
      "location": "WORKING_STORAGE",
      "citation": 103
    },
    {
      "copybook_name": "CIPAUDTY",
      "purpose": "Defines the layout of the PENDING-AUTH-DETAILS segment.",
      "location": "WORKING_STORAGE",
      "citation": 107
    },
    {
      "copybook_name": "PAUTBPCB",
      "purpose": "Defines the PCB mask for IMS calls.",
      "location": "LINKAGE",
      "citation": 114
    }
  ],
  "paragraphs": [
    {
      "paragraph_name": "MAIN-PARA",
      "summary": null,
      "purpose": "This is the main control paragraph of the PAUDBUNL program. It orchestrates the entire process of unloading pending authorization data from an IMS database to sequential files. It first calls 1000-INITIALIZE to perform initial setup tasks such as accepting the current date and opening the output files (OPFILE1 and OPFILE2). After initialization, it enters a loop, controlled by the WS-END-OF-ROOT-SEG flag, that repeatedly calls 2000-FIND-NEXT-AUTH-SUMMARY to retrieve and process pending authorization summary segments. Once all summary segments have been processed (WS-END-OF-ROOT-SEG is 'Y'), the paragraph calls 4000-FILE-CLOSE to close the output files. Finally, the program terminates using GOBACK.",
      "called_by": [],
      "calls": [
        "1000-INITIALIZE",
        "2000-FIND-NEXT-AUTH-SUMMARY",
        "4000-FILE-CLOSE"
      ],
      "citation": [
        157,
        170
      ],
      "outgoing_calls": [
        {
          "target": "1000-INITIALIZE",
          "call_type": "performs",
          "line": 161
        },
        {
          "target": "2000-FIND-NEXT-AUTH-SUMMARY",
          "call_type": "performs",
          "line": 163
        },
        {
          "target": "4000-FILE-CLOSE",
          "call_type": "performs",
          "line": 166
        }
      ],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "1000-INITIALIZE",
      "summary": null,
      "purpose": "This paragraph performs the initialization tasks required before processing the IMS database. It accepts the current date and day from the system. It then opens the two output files, OPFILE1 and OPFILE2, for writing. It checks the file status after each OPEN operation (WS-OUTFL1-STATUS and WS-OUTFL2-STATUS). If the file status is not spaces or '00', indicating a successful open, it displays an error message and calls 9999-ABEND to terminate the program. Otherwise, the program continues. There is no specific input consumed by this paragraph other than system date and parameters. The outputs are the opened files OPFILE1 and OPFILE2. It does not call any other paragraphs other than 9999-ABEND in case of an error.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [
        "9999-ABEND"
      ],
      "citation": [
        173,
        204
      ],
      "outgoing_calls": [
        {
          "target": "9999-ABEND",
          "call_type": "performs",
          "line": 191
        },
        {
          "target": "9999-ABEND",
          "call_type": "performs",
          "line": 199
        }
      ],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "2000-FIND-NEXT-AUTH-SUMMARY",
      "summary": null,
      "purpose": "This paragraph retrieves the next pending authorization summary segment from the IMS database. It initializes the PAUT-PCB-STATUS field and then calls the CBLTDLI routine with the FUNC-GN (Get Next) function code to retrieve the next PAUTSUM0 segment using the ROOT-UNQUAL-SSA. After the IMS call, it checks the PAUT-PCB-STATUS. If the status is spaces, indicating a successful read, it increments counters WS-NO-SUMRY-READ and WS-AUTH-SMRY-PROC-CNT, moves the retrieved PENDING-AUTH-SUMMARY data to OPFIL1-REC, and writes the record to OPFILE1 if PA-ACCT-ID is numeric. It then calls 3000-FIND-NEXT-AUTH-DTL to process the child segments. If the PAUT-PCB-STATUS is 'GB' (End of Database), it sets the WS-END-OF-ROOT-SEG flag to 'Y' to terminate the main processing loop. If the PAUT-PCB-STATUS is neither spaces nor 'GB', it displays an error message and calls 9999-ABEND. The input is the IMS database and the output is the OPFILE1 file. The paragraph calls 3000-FIND-NEXT-AUTH-DTL to process child segments.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [
        "3000-FIND-NEXT-AUTH-DTL",
        "9999-ABEND"
      ],
      "citation": [
        207,
        249
      ],
      "outgoing_calls": [
        {
          "target": "CBLTDLI",
          "call_type": "calls",
          "line": 213
        },
        {
          "target": "3000-FIND-NEXT-AUTH-DTL",
          "call_type": "performs",
          "line": 235
        },
        {
          "target": "9999-ABEND",
          "call_type": "performs",
          "line": 246
        }
      ],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "3000-FIND-NEXT-AUTH-DTL",
      "summary": null,
      "purpose": "This paragraph retrieves the next pending authorization detail segment (PAUTDTL1) for the current summary segment. It calls the CBLTDLI routine with the FUNC-GNP (Get Next within Parent) function code, using the CHILD-UNQUAL-SSA. After the call, it checks the PAUT-PCB-STATUS. If the status is spaces, indicating a successful read, it sets the MORE-AUTHS flag to TRUE, increments counters WS-NO-SUMRY-READ and WS-AUTH-SMRY-PROC-CNT, moves the PENDING-AUTH-DETAILS data to CHILD-SEG-REC, and writes the record to OPFILE2. If the PAUT-PCB-STATUS is 'GE' (Segment Not Found), it sets the WS-END-OF-CHILD-SEG flag to 'Y' to indicate that there are no more detail segments for the current summary segment. If the PAUT-PCB-STATUS is neither spaces nor 'GE', it displays an error message and calls 9999-ABEND. Finally, it initializes PAUT-PCB-STATUS. The input is the IMS database and the output is the OPFILE2 file. No other paragraphs are called other than 9999-ABEND in case of error.",
      "called_by": [
        "2000-FIND-NEXT-AUTH-SUMMARY"
      ],
      "calls": [
        "9999-ABEND"
      ],
      "citation": [
        253,
        286
      ],
      "outgoing_calls": [
        {
          "target": "CBLTDLI",
          "call_type": "calls",
          "line": 257
        },
        {
          "target": "9999-ABEND",
          "call_type": "performs",
          "line": 282
        }
      ],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "4000-FILE-CLOSE",
      "summary": null,
      "purpose": "This paragraph closes the output files OPFILE1 and OPFILE2. It displays a message indicating that the files are being closed. It then closes each file and checks the file status (WS-OUTFL1-STATUS and WS-OUTFL2-STATUS) after the CLOSE operation. If the file status is not spaces or '00', indicating a successful close, it displays an error message. The input to this paragraph is the open files OPFILE1 and OPFILE2. The output is the closed files. It does not call any other paragraphs.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [],
      "citation": [
        289,
        306
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "9999-ABEND",
      "summary": null,
      "purpose": "This paragraph handles abnormal termination of the program. It displays a message indicating that the program is abending. It sets the RETURN-CODE to 16 and terminates the program using GOBACK. The input is the error condition that led to the abend. There is no output other than the program termination. It does not call any other paragraphs.",
      "called_by": [
        "1000-INITIALIZE",
        "2000-FIND-NEXT-AUTH-SUMMARY",
        "3000-FIND-NEXT-AUTH-DTL"
      ],
      "calls": [],
      "citation": [
        308,
        317
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    }
  ],
  "error_handling": [
    {
      "condition": "WS-OUTFL1-STATUS not equal to spaces or '00' during OPEN",
      "action": "DISPLAY error message and PERFORM 9999-ABEND",
      "citation": [
        190,
        191
      ]
    },
    {
      "condition": "WS-OUTFL2-STATUS not equal to spaces or '00' during OPEN",
      "action": "DISPLAY error message and PERFORM 9999-ABEND",
      "citation": [
        198,
        199
      ]
    },
    {
      "condition": "PAUT-PCB-STATUS not equal to spaces or 'GB' after GN call",
      "action": "DISPLAY error message and PERFORM 9999-ABEND",
      "citation": [
        244,
        246
      ]
    },
    {
      "condition": "PAUT-PCB-STATUS not equal to spaces or 'GE' after GNP call",
      "action": "DISPLAY error message and PERFORM 9999-ABEND",
      "citation": [
        280,
        282
      ]
    },
    {
      "condition": "WS-OUTFL1-STATUS not equal to spaces or '00' during CLOSE",
      "action": "DISPLAY error message",
      "citation": [
        269
      ]
    },
    {
      "condition": "WS-OUTFL2-STATUS not equal to spaces or '00' during CLOSE",
      "action": "DISPLAY error message",
      "citation": [
        303
      ]
    }
  ],
  "sql_operations": [],
  "cics_operations": [],
  "open_questions": [
    {
      "question": "What is the purpose of the commented out ACCEPT PRM-INFO FROM SYSIN statement?",
      "context": "The code is commented out, so it's unclear if it was intended to be used or if it's obsolete.",
      "suggestion": "Check older versions of the code or related documentation to see if PRM-INFO was ever used."
    }
  ],
  "resolved_questions": [],
  "dead_code": [],
  "call_semantics": [
    {
      "caller": "MAIN-PARA",
      "callee": "1000-INITIALIZE",
      "inputs": [],
      "outputs": [
        "CURRENT-DATE",
        "CURRENT-YYDDD",
        "WS-OUTFL1-STATUS",
        "WS-OUTFL2-STATUS",
        "WS-END-OF-ROOT-SEG"
      ],
      "purpose": "Initializes the program by accepting current date and opening output files, setting up environment for processing."
    },
    {
      "caller": "MAIN-PARA",
      "callee": "2000-FIND-NEXT-AUTH-SUMMARY",
      "inputs": [
        "WS-END-OF-ROOT-SEG"
      ],
      "outputs": [
        "WS-NO-SUMRY-READ",
        "WS-AUTH-SMRY-PROC-CNT",
        "OPFIL1-REC",
        "ROOT-SEG-KEY",
        "WS-END-OF-CHILD-SEG",
        "WS-END-OF-ROOT-SEG"
      ],
      "purpose": "Reads the next authorization summary segment from IMS database and processes its child segments if available."
    },
    {
      "caller": "MAIN-PARA",
      "callee": "4000-FILE-CLOSE",
      "inputs": [
        "WS-OUTFL1-STATUS",
        "WS-OUTFL2-STATUS"
      ],
      "outputs": [],
      "purpose": "Closes the output files and displays error messages if closing fails."
    },
    {
      "caller": "1000-INITIALIZE",
      "callee": "9999-ABEND",
      "inputs": [
        "WS-OUTFL1-STATUS",
        "WS-OUTFL2-STATUS"
      ],
      "outputs": [
        "RETURN-CODE"
      ],
      "purpose": "Terminates the program with a return code of 16 upon encountering a critical error during initialization."
    },
    {
      "caller": "1000-INITIALIZE",
      "callee": "9999-ABEND",
      "inputs": [
        "WS-OUTFL1-STATUS",
        "WS-OUTFL2-STATUS"
      ],
      "outputs": [
        "RETURN-CODE"
      ],
      "purpose": "Terminates the program with a return code of 16 upon encountering a critical error during initialization."
    },
    {
      "caller": "2000-FIND-NEXT-AUTH-SUMMARY",
      "callee": "3000-FIND-NEXT-AUTH-DTL",
      "inputs": [
        "WS-END-OF-CHILD-SEG"
      ],
      "outputs": [
        "WS-END-OF-CHILD-SEG"
      ],
      "purpose": "Processes all child detail segments for the current root summary segment by reading and writing them until no more child segments are found."
    },
    {
      "caller": "2000-FIND-NEXT-AUTH-SUMMARY",
      "callee": "9999-ABEND",
      "inputs": [],
      "outputs": [],
      "purpose": "Terminates the program with a return code of 16 when an unexpected IMS status code is encountered during root segment retrieval."
    },
    {
      "caller": "3000-FIND-NEXT-AUTH-DTL",
      "callee": "9999-ABEND",
      "inputs": [],
      "outputs": [],
      "purpose": "Terminates the program with a return code of 16 when an unexpected IMS status code is encountered during child segment retrieval."
    }
  ],
  "flow_diagram": "flowchart TD\n    %% Title: PAUDBUNL.CBL\n    1000_EXIT[\"1000-EXIT\"]\n    1000_INITIALIZE[\"1000-INITIALIZE\"]\n    9999_ABEND[\"9999-ABEND\"]\n    2000_EXIT[\"2000-EXIT\"]\n    2000_FIND_NEXT_AUTH_SUMMARY[\"2000-FIND-NEXT-AUTH-SUMMARY\"]\n    3000_FIND_NEXT_AUTH_DTL[\"3000-FIND-NEXT-AUTH-DTL\"]\n    CBLTDLI__ext([\"CBLTDLI\"])\n    3000_EXIT[\"3000-EXIT\"]\n    4000_EXIT[\"4000-EXIT\"]\n    4000_FILE_CLOSE[\"4000-FILE-CLOSE\"]\n    9999_EXIT[\"9999-EXIT\"]\n    MAIN_PARA[\"MAIN-PARA\"]\n    1000_INITIALIZE --> 9999_ABEND\n    2000_FIND_NEXT_AUTH_SUMMARY --> 3000_FIND_NEXT_AUTH_DTL\n    2000_FIND_NEXT_AUTH_SUMMARY --> 9999_ABEND\n    2000_FIND_NEXT_AUTH_SUMMARY -.->|calls| CBLTDLI__ext\n    3000_FIND_NEXT_AUTH_DTL --> 9999_ABEND\n    3000_FIND_NEXT_AUTH_DTL -.->|calls| CBLTDLI__ext\n    MAIN_PARA --> 1000_INITIALIZE\n    MAIN_PARA --> 2000_FIND_NEXT_AUTH_SUMMARY\n    MAIN_PARA --> 4000_FILE_CLOSE"
}