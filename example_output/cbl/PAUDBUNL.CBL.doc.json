{
  "header": {
    "program_id": "PAUDBUNL",
    "file_name": "PAUDBUNL.CBL",
    "file_type": "COBOL",
    "analyzed_by": "WAR_RIG",
    "analyzed_at": "2026-01-27T23:04:27.591831",
    "iteration_count": 1,
    "final_status": null
  },
  "purpose": {
    "summary": "The COBOL program PAUDBUNL unloads pending authorization summary and detail segments from an IMS database to two sequential output files. It reads PAUTSUM0 root segments and PAUTDTL1 child segments, writing them to OPFILE1 and OPFILE2 respectively, after checking if the PA-ACCT-ID is numeric.",
    "business_context": "This program is likely used for data migration, reporting, or archiving purposes related to pending authorizations.",
    "program_type": "BATCH",
    "citations": [
      18,
      213,
      271
    ]
  },
  "inputs": [
    {
      "name": "IMS Database (PAUTSUM0, PAUTDTL1)",
      "io_type": "IMS_SEGMENT",
      "description": "Pending authorization summary (root) and detail (child) segments from an IMS database.",
      "copybook": "CIPAUSMY, CIPAUDTY",
      "citation": [
        213,
        237
      ]
    },
    {
      "name": "PAUTBPCB",
      "io_type": "PARAMETER",
      "description": "PCB mask for IMS calls.",
      "copybook": "PAUTBPCB",
      "citation": [
        153,
        158
      ]
    }
  ],
  "outputs": [
    {
      "name": "OPFILE1",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Unloaded pending authorization summary segments.",
      "copybook": "CIPAUSMY",
      "citation": [
        233
      ]
    },
    {
      "name": "OPFILE2",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Unloaded pending authorization detail segments.",
      "copybook": "CIPAUDTY",
      "citation": [
        271
      ]
    }
  ],
  "called_programs": [
    {
      "program_name": "CBLTDLI",
      "call_type": "STATIC_CALL",
      "purpose": "Performs IMS database calls to retrieve segments.",
      "parameters": [
        "FUNC-GN",
        "PAUTBPCB",
        "PENDING-AUTH-SUMMARY",
        "ROOT-UNQUAL-SSA"
      ],
      "citation": 213
    },
    {
      "program_name": "CBLTDLI",
      "call_type": "STATIC_CALL",
      "purpose": "Performs IMS database calls to retrieve child segments.",
      "parameters": [
        "FUNC-GNP",
        "PAUTBPCB",
        "PENDING-AUTH-DETAILS",
        "CHILD-UNQUAL-SSA"
      ],
      "citation": 257
    }
  ],
  "calling_context": {
    "called_by": [],
    "entry_points": [
      "DLITCBL"
    ],
    "linkage_section": [
      "PAUTBPCB"
    ]
  },
  "business_rules": [
    {
      "rule_id": "BR001",
      "description": "Only write the summary record to OPFILE1 if PA-ACCT-ID is numeric.",
      "logic_summary": "Checks if PA-ACCT-ID is numeric before writing OPFIL1-REC.",
      "conditions": [
        "IF PA-ACCT-ID IS NUMERIC"
      ],
      "citation": [
        232,
        233
      ]
    }
  ],
  "data_flow": {
    "reads_from": [
      {
        "source": "IMS Database (PAUTSUM0)",
        "fields_used": [
          "PA-ACCT-ID",
          "All fields in PENDING-AUTH-SUMMARY"
        ],
        "citation": [
          213,
          230
        ]
      },
      {
        "source": "IMS Database (PAUTDTL1)",
        "fields_used": [
          "All fields in PENDING-AUTH-DETAILS"
        ],
        "citation": [
          257,
          270
        ]
      }
    ],
    "writes_to": [
      {
        "destination": "OPFILE1",
        "fields_written": [
          "All fields in PENDING-AUTH-SUMMARY"
        ],
        "citation": [
          233
        ]
      },
      {
        "destination": "OPFILE2",
        "fields_written": [
          "All fields in PENDING-AUTH-DETAILS"
        ],
        "citation": [
          271
        ]
      }
    ],
    "transforms": []
  },
  "copybooks_used": [
    {
      "copybook_name": "IMSFUNCS",
      "purpose": "Contains definitions for IMS function codes.",
      "location": "WORKING_STORAGE",
      "citation": 132
    },
    {
      "copybook_name": "CIPAUSMY",
      "purpose": "Defines the layout of the PENDING-AUTH-SUMMARY segment.",
      "location": "WORKING_STORAGE",
      "citation": 103
    },
    {
      "copybook_name": "CIPAUDTY",
      "purpose": "Defines the layout of the PENDING-AUTH-DETAILS segment.",
      "location": "WORKING_STORAGE",
      "citation": 107
    },
    {
      "copybook_name": "PAUTBPCB",
      "purpose": "Defines the PCB mask for IMS calls.",
      "location": "LINKAGE",
      "citation": 114
    }
  ],
  "paragraphs": [
    {
      "paragraph_name": "MAIN-PARA",
      "summary": null,
      "purpose": "This is the main control paragraph of the program. It first calls 1000-INITIALIZE to perform initialization tasks such as accepting the current date and opening the output files OPFILE1 and OPFILE2. Then, it enters a loop that continues until WS-END-OF-ROOT-SEG is set to 'Y', indicating that all root segments have been processed. Inside the loop, it calls 2000-FIND-NEXT-AUTH-SUMMARY to retrieve and process the next root segment. After processing all root segments, it calls 4000-FILE-CLOSE to close the output files. Finally, it terminates the program with a GOBACK statement. The paragraph also includes an ENTRY point 'DLITCBL' for IMS.",
      "called_by": [],
      "calls": [
        "1000-INITIALIZE",
        "2000-FIND-NEXT-AUTH-SUMMARY",
        "4000-FILE-CLOSE"
      ],
      "citation": [
        157,
        170
      ],
      "outgoing_calls": [
        {
          "target": "1000-INITIALIZE",
          "call_type": "performs",
          "line": 161
        },
        {
          "target": "2000-FIND-NEXT-AUTH-SUMMARY",
          "call_type": "performs",
          "line": 163
        },
        {
          "target": "4000-FILE-CLOSE",
          "call_type": "performs",
          "line": 166
        }
      ],
      "incoming_calls": [],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "1000-INITIALIZE",
      "summary": null,
      "purpose": "This paragraph initializes the program by accepting the current date and opening the output files OPFILE1 and OPFILE2. It retrieves the current date from the system using ACCEPT statements and stores it in CURRENT-DATE and CURRENT-YYDDD. It then opens OPFILE1 and OPFILE2 for output. If either file fails to open, the program displays an error message and calls 9999-ABEND to terminate. There is a commented-out line that suggests the program might have originally accepted parameters from SYSIN. The paragraph displays messages to the console indicating the start of the program and the current date.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [
        "9999-ABEND"
      ],
      "citation": [
        173,
        204
      ],
      "outgoing_calls": [
        {
          "target": "9999-ABEND",
          "call_type": "performs",
          "line": 191
        },
        {
          "target": "9999-ABEND",
          "call_type": "performs",
          "line": 199
        }
      ],
      "incoming_calls": [
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/CBPAUP0C.cbl",
          "function": "MAIN-PARA",
          "line": 138,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/COPAUA0C.cbl",
          "function": "MAIN-PARA",
          "line": 222,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/DBUNLDGS.CBL",
          "function": "MAIN-PARA",
          "line": 170,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/PAUDBLOD.CBL",
          "function": "MAIN-PARA",
          "line": 175,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/PAUDBUNL.CBL",
          "function": "MAIN-PARA",
          "line": 161,
          "call_type": "performs"
        }
      ],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "2000-FIND-NEXT-AUTH-SUMMARY",
      "summary": null,
      "purpose": "This paragraph retrieves and processes the next pending authorization summary (root) segment from the IMS database. It initializes PAUT-PCB-STATUS and then calls the CBLTDLI routine with the FUNC-GN function code to retrieve the next root segment using the PAUTBPCB PCB mask, PENDING-AUTH-SUMMARY segment layout, and ROOT-UNQUAL-SSA SSA. If the PCB status is spaces, indicating a successful read, it increments counters WS-NO-SUMRY-READ and WS-AUTH-SMRY-PROC-CNT, moves the segment data to OPFIL1-REC, and calls 3000-FIND-NEXT-AUTH-DTL to process the child segments. If the PCB status is 'GB', indicating end of database, it sets WS-END-OF-ROOT-SEG to 'Y'. If the PCB status is neither spaces nor 'GB', it displays an error message and calls 9999-ABEND to terminate the program.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [
        "CBLTDLI",
        "3000-FIND-NEXT-AUTH-DTL",
        "9999-ABEND"
      ],
      "citation": [
        207,
        249
      ],
      "outgoing_calls": [
        {
          "target": "CBLTDLI",
          "call_type": "calls",
          "line": 213
        },
        {
          "target": "3000-FIND-NEXT-AUTH-DTL",
          "call_type": "performs",
          "line": 235
        },
        {
          "target": "9999-ABEND",
          "call_type": "performs",
          "line": 246
        }
      ],
      "incoming_calls": [
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/CBPAUP0C.cbl",
          "function": "MAIN-PARA",
          "line": 140,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/CBPAUP0C.cbl",
          "function": "MAIN-PARA",
          "line": 165,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/DBUNLDGS.CBL",
          "function": "MAIN-PARA",
          "line": 172,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/PAUDBUNL.CBL",
          "function": "MAIN-PARA",
          "line": 163,
          "call_type": "performs"
        }
      ],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "3000-FIND-NEXT-AUTH-DTL",
      "summary": null,
      "purpose": "This paragraph retrieves and processes the next pending authorization detail (child) segment from the IMS database for the current root segment. It calls the CBLTDLI routine with the FUNC-GNP function code to retrieve the next child segment using the PAUTBPCB PCB mask, PENDING-AUTH-DETAILS segment layout, and CHILD-UNQUAL-SSA SSA. If the PCB status is spaces, indicating a successful read, it sets MORE-AUTHS to TRUE, increments counters WS-NO-SUMRY-READ and WS-AUTH-SMRY-PROC-CNT, moves the segment data to CHILD-SEG-REC, and writes the record to OPFILE2. If the PCB status is 'GE', indicating segment not found, it sets WS-END-OF-CHILD-SEG to 'Y'. If the PCB status is neither spaces nor 'GE', it displays an error message and calls 9999-ABEND to terminate the program. Finally, it initializes PAUT-PCB-STATUS.",
      "called_by": [
        "2000-FIND-NEXT-AUTH-SUMMARY"
      ],
      "calls": [
        "CBLTDLI",
        "9999-ABEND"
      ],
      "citation": [
        253,
        286
      ],
      "outgoing_calls": [
        {
          "target": "CBLTDLI",
          "call_type": "calls",
          "line": 257
        },
        {
          "target": "9999-ABEND",
          "call_type": "performs",
          "line": 282
        }
      ],
      "incoming_calls": [
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/CBPAUP0C.cbl",
          "function": "MAIN-PARA",
          "line": 144,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/CBPAUP0C.cbl",
          "function": "MAIN-PARA",
          "line": 153,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/DBUNLDGS.CBL",
          "function": "2000-FIND-NEXT-AUTH-SUMMARY",
          "line": 245,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/PAUDBUNL.CBL",
          "function": "2000-FIND-NEXT-AUTH-SUMMARY",
          "line": 235,
          "call_type": "performs"
        }
      ],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "4000-FILE-CLOSE",
      "summary": null,
      "purpose": "This paragraph closes the output files OPFILE1 and OPFILE2. It displays a message to the console indicating that the files are being closed. It then closes each file and checks the file status. If an error occurs during the close operation, it displays an error message. The paragraph does not perform any error handling beyond displaying the error message; it continues execution regardless of the file close status.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [],
      "citation": [
        289,
        306
      ],
      "outgoing_calls": [],
      "incoming_calls": [
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/DBUNLDGS.CBL",
          "function": "MAIN-PARA",
          "line": 175,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/PAUDBLOD.CBL",
          "function": "MAIN-PARA",
          "line": 183,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/PAUDBUNL.CBL",
          "function": "MAIN-PARA",
          "line": 166,
          "call_type": "performs"
        }
      ],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    },
    {
      "paragraph_name": "9999-ABEND",
      "summary": null,
      "purpose": "This paragraph handles abnormal program termination. It displays a message to the console indicating that the program is abending. It then sets the RETURN-CODE to 16 and terminates the program using the GOBACK statement. This paragraph is called when a critical error occurs, such as a file open or close error, or an IMS call failure.",
      "called_by": [
        "1000-INITIALIZE",
        "2000-FIND-NEXT-AUTH-SUMMARY",
        "3000-FIND-NEXT-AUTH-DTL"
      ],
      "calls": [],
      "citation": [
        308,
        317
      ],
      "outgoing_calls": [],
      "incoming_calls": [
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/CBPAUP0C.cbl",
          "function": "2000-FIND-NEXT-AUTH-SUMMARY",
          "line": 240,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/CBPAUP0C.cbl",
          "function": "3000-FIND-NEXT-AUTH-DTL",
          "line": 270,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/CBPAUP0C.cbl",
          "function": "5000-DELETE-AUTH-DTL",
          "line": 320,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/CBPAUP0C.cbl",
          "function": "6000-DELETE-AUTH-SUMMARY",
          "line": 345,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/CBPAUP0C.cbl",
          "function": "9000-TAKE-CHECKPOINT",
          "line": 369,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/DBUNLDGS.CBL",
          "function": "2000-FIND-NEXT-AUTH-SUMMARY",
          "line": 256,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/DBUNLDGS.CBL",
          "function": "3000-FIND-NEXT-AUTH-DTL",
          "line": 293,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/DBUNLDGS.CBL",
          "function": "3100-INSERT-PARENT-SEG-GSAM",
          "line": 314,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/DBUNLDGS.CBL",
          "function": "3200-INSERT-CHILD-SEG-GSAM",
          "line": 333,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/PAUDBLOD.CBL",
          "function": "1000-INITIALIZE",
          "line": 206,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/PAUDBLOD.CBL",
          "function": "1000-INITIALIZE",
          "line": 214,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/PAUDBLOD.CBL",
          "function": "2100-INSERT-ROOT-SEG",
          "line": 261,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/PAUDBLOD.CBL",
          "function": "3100-INSERT-CHILD-SEG",
          "line": 313,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/PAUDBLOD.CBL",
          "function": "3200-INSERT-IMS-CALL",
          "line": 335,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/PAUDBUNL.CBL",
          "function": "1000-INITIALIZE",
          "line": 191,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/PAUDBUNL.CBL",
          "function": "1000-INITIALIZE",
          "line": 199,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/PAUDBUNL.CBL",
          "function": "2000-FIND-NEXT-AUTH-SUMMARY",
          "line": 246,
          "call_type": "performs"
        },
        {
          "file": "/home/andras/aws-mainframe-modernization-carddemo/app/app-authorization-ims-db2-mq/cbl/PAUDBUNL.CBL",
          "function": "3000-FIND-NEXT-AUTH-DTL",
          "line": 282,
          "call_type": "performs"
        }
      ],
      "is_dead_code": false,
      "dead_code_reason": null,
      "metadata": null
    }
  ],
  "error_handling": [
    {
      "condition": "WS-OUTFL1-STATUS not equal to SPACES or '00' during OPEN",
      "action": "DISPLAY error message and PERFORM 9999-ABEND",
      "citation": [
        187,
        191
      ]
    },
    {
      "condition": "WS-OUTFL2-STATUS not equal to SPACES or '00' during OPEN",
      "action": "DISPLAY error message and PERFORM 9999-ABEND",
      "citation": [
        195,
        199
      ]
    },
    {
      "condition": "PAUT-PCB-STATUS not equal to SPACES or 'GB' after GN call",
      "action": "DISPLAY error message and PERFORM 9999-ABEND",
      "citation": [
        243,
        246
      ]
    },
    {
      "condition": "PAUT-PCB-STATUS not equal to SPACES or 'GE' after GNP call",
      "action": "DISPLAY error message and PERFORM 9999-ABEND",
      "citation": [
        279,
        282
      ]
    },
    {
      "condition": "WS-OUTFL1-STATUS not equal to SPACES or '00' during CLOSE",
      "action": "DISPLAY error message",
      "citation": [
        293,
        296
      ]
    },
    {
      "condition": "WS-OUTFL2-STATUS not equal to SPACES or '00' during CLOSE",
      "action": "DISPLAY error message",
      "citation": [
        300,
        303
      ]
    }
  ],
  "sql_operations": [],
  "cics_operations": [],
  "open_questions": [
    {
      "question": "What is the purpose of the commented-out ACCEPT PRM-INFO FROM SYSIN statement?",
      "context": "It is unclear if this program was originally intended to accept parameters from SYSIN, and if so, what those parameters represent.",
      "suggestion": "Check older versions of the code or related documentation to determine the purpose of this statement."
    },
    {
      "question": "What is the exact structure of the IMS database being accessed?",
      "context": "While the program accesses PAUTSUM0 and PAUTDTL1 segments, the full database schema and relationships are not clear from the code alone.",
      "suggestion": "Consult the database documentation or DBA to understand the database structure."
    }
  ],
  "dead_code": [],
  "flow_diagram": "flowchart TD\n    %% Title: PAUDBUNL.CBL\n    1000_EXIT[\"1000-EXIT\"]\n    1000_INITIALIZE[\"1000-INITIALIZE\"]\n    9999_ABEND[\"9999-ABEND\"]\n    2000_EXIT[\"2000-EXIT\"]\n    2000_FIND_NEXT_AUTH_SUMMARY[\"2000-FIND-NEXT-AUTH-SUMMARY\"]\n    3000_FIND_NEXT_AUTH_DTL[\"3000-FIND-NEXT-AUTH-DTL\"]\n    CBLTDLI__ext([\"CBLTDLI\"])\n    3000_EXIT[\"3000-EXIT\"]\n    4000_EXIT[\"4000-EXIT\"]\n    4000_FILE_CLOSE[\"4000-FILE-CLOSE\"]\n    9999_EXIT[\"9999-EXIT\"]\n    MAIN_PARA[\"MAIN-PARA\"]\n    1000_INITIALIZE --> 9999_ABEND\n    2000_FIND_NEXT_AUTH_SUMMARY --> 3000_FIND_NEXT_AUTH_DTL\n    2000_FIND_NEXT_AUTH_SUMMARY --> 9999_ABEND\n    2000_FIND_NEXT_AUTH_SUMMARY -.->|calls| CBLTDLI__ext\n    3000_FIND_NEXT_AUTH_DTL --> 9999_ABEND\n    3000_FIND_NEXT_AUTH_DTL -.->|calls| CBLTDLI__ext\n    MAIN_PARA --> 1000_INITIALIZE\n    MAIN_PARA --> 2000_FIND_NEXT_AUTH_SUMMARY\n    MAIN_PARA --> 4000_FILE_CLOSE"
}