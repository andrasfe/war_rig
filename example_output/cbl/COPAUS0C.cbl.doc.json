{
  "header": {
    "program_id": "COPAUS0C",
    "file_name": "cbl/COPAUS0C.cbl",
    "file_type": "COBOL",
    "analyzed_by": "WAR_RIG",
    "analyzed_at": "2026-01-26T14:22:43.300258",
    "iteration_count": 1,
    "final_status": null
  },
  "purpose": {
    "summary": "COPAUS0C is a CICS online program that provides a paginated summary view of pending authorization details for a specific account ID in the CardDemo authorization module. It retrieves account, customer, and card cross-reference data from VSAM files, fetches IMS pending authorization summary and detail segments, populates a BMS map with header info, customer details, summary counts, and a list of up to 5 authorizations, and handles navigation (PF7/PF8), selection for detail view (ENTER), and return to menu (PF3).",
    "business_context": "Serves the CardDemo application by displaying authorization message summaries to allow users to review and select pending authorizations for an account.",
    "program_type": "ONLINE_CICS",
    "citations": [
      2,
      3,
      4,
      5,
      23,
      36,
      178
    ]
  },
  "inputs": [
    {
      "name": "COPAU0AI",
      "io_type": "CICS_MAP",
      "description": "BMS input map containing entered account ID (ACCTIDI) and selection flags (SEL0001I-SEL0005I) from user screen interactions",
      "copybook": "COPAU00",
      "citation": [
        715,
        716,
        717,
        718
      ]
    },
    {
      "name": "CXACAIX",
      "io_type": "FILE_VSAM",
      "description": "Card cross-reference alternate index by account ID to retrieve customer ID and card number",
      "copybook": "CVACT03Y",
      "citation": [
        817,
        818,
        819
      ]
    },
    {
      "name": "ACCTDAT",
      "io_type": "FILE_VSAM",
      "description": "Account master file containing account details like credit limits",
      "copybook": "CVACT01Y",
      "citation": [
        868,
        869,
        870
      ]
    },
    {
      "name": "CUSTDAT",
      "io_type": "FILE_VSAM",
      "description": "Customer master file containing customer name, address, phone",
      "copybook": "CVCUS01Y",
      "citation": [
        918,
        920,
        921
      ]
    },
    {
      "name": "PAUTSUM0",
      "io_type": "IMS_SEGMENT",
      "description": "Pending authorization summary root segment containing counts and balances for the account",
      "copybook": "CIPAUSMY",
      "citation": [
        974,
        975
      ]
    },
    {
      "name": "PAUTDTL1",
      "io_type": "IMS_SEGMENT",
      "description": "Pending authorization details child segments containing individual authorization records",
      "copybook": "CIPAUDTY",
      "citation": [
        462,
        463
      ]
    },
    {
      "name": "DFHCOMMAREA",
      "io_type": "CICS_COMMAREA",
      "description": "Common CardDemo commarea passed between programs containing account ID, page keys, selected auth key",
      "copybook": "COCOM01Y",
      "citation": [
        200,
        201
      ]
    }
  ],
  "outputs": [
    {
      "name": "COPAU0AO",
      "io_type": "CICS_MAP",
      "description": "BMS output map populated with header, customer info, account summary stats, authorization list, and error messages",
      "copybook": "COPAU00",
      "citation": [
        696,
        697,
        698
      ]
    },
    {
      "name": "CARDDEMO-COMMAREA",
      "io_type": "CICS_COMMAREA",
      "description": "Updated commarea with page navigation keys, selected authorization, page number for return or XCTL",
      "copybook": "COCOM01Y",
      "citation": [
        256,
        324
      ]
    }
  ],
  "called_programs": [
    {
      "program_name": "COPAUS1C",
      "call_type": "CICS_XCTL",
      "purpose": "Transfer control to authorization detail program when user selects 'S' on an authorization line",
      "parameters": [
        "CARDDEMO-COMMAREA"
      ],
      "citation": 323
    },
    {
      "program_name": "COMEN01C",
      "call_type": "CICS_XCTL",
      "purpose": "Return to menu program on PF3 key press",
      "parameters": [
        "CARDDEMO-COMMAREA"
      ],
      "citation": 236
    },
    {
      "program_name": "COSGN00C",
      "call_type": "CICS_XCTL",
      "purpose": "Default fallback program for return if no previous program specified",
      "parameters": [
        "CARDDEMO-COMMAREA"
      ],
      "citation": 669
    }
  ],
  "calling_context": {
    "called_by": [],
    "entry_points": [
      "CPVS"
    ],
    "linkage_section": [
      "LK-COMMAREA",
      "EIBCALEN"
    ]
  },
  "business_rules": [
    {
      "rule_id": "BR001",
      "description": "Account ID must be numeric and not spaces/low-values for processing",
      "logic_summary": "Validates ACCTIDI from map; sets error if invalid",
      "conditions": [
        "IF ACCTIDI = SPACES OR LOW-VALUES",
        "IF ACCTIDI NOT NUMERIC"
      ],
      "citation": [
        264,
        273
      ]
    },
    {
      "rule_id": "BR002",
      "description": "Authorization selection must be 'S' or 's' to proceed to detail view",
      "logic_summary": "Checks SEL000XI fields and sets selected auth key; invalid sets error message",
      "conditions": [
        "EVALUATE SEL0001I-SEL0005I",
        "WHEN 'S' or 's'"
      ],
      "citation": [
        286,
        313
      ]
    },
    {
      "rule_id": "BR003",
      "description": "Approval status 'A' if response code '00', else 'D' for display",
      "logic_summary": "Transforms PA-AUTH-RESP-CODE to WS-AUTH-APRV-STAT for map population",
      "conditions": [
        "IF PA-AUTH-RESP-CODE = '00'"
      ],
      "citation": [
        536
      ]
    },
    {
      "rule_id": "BR004",
      "description": "Page navigation backward only if current page >1; forward repositions from last key",
      "logic_summary": "PF7 decrements page, loads prev key; PF8 uses last key to GNP",
      "conditions": [
        "IF CDEMO-CPVS-PAGE-NUM > 1",
        "IF CDEMO-CPVS-PAUKEY-LAST NOT = SPACES"
      ],
      "citation": [
        365,
        391
      ]
    }
  ],
  "data_flow": {
    "reads_from": [
      {
        "source": "COPAU0AI",
        "fields_used": [
          "ACCTIDI",
          "SEL0001I",
          "SEL0002I",
          "SEL0003I",
          "SEL0004I",
          "SEL0005I"
        ],
        "citation": [
          264,
          286
        ]
      },
      {
        "source": "CXACAIX",
        "fields_used": [
          "XREF-CUST-ID",
          "XREF-CARD-NUM"
        ],
        "citation": [
          830
        ]
      },
      {
        "source": "ACCTDAT",
        "fields_used": [
          "ACCT-CREDIT-LIMIT",
          "ACCT-CASH-CREDIT-LIMIT"
        ],
        "citation": [
          780,
          782
        ]
      },
      {
        "source": "CUSTDAT",
        "fields_used": [
          "CUST-ID",
          "CUST-FIRST-NAME",
          "CUST-LAST-NAME",
          "CUST-ADDR-LINE-1"
        ],
        "citation": [
          757,
          759
        ]
      },
      {
        "source": "PAUTSUM0",
        "fields_used": [
          "PA-APPROVED-AUTH-CNT",
          "PA-DECLINED-AUTH-CNT",
          "PA-CREDIT-BALANCE"
        ],
        "citation": [
          787,
          788
        ]
      },
      {
        "source": "PAUTDTL1",
        "fields_used": [
          "PA-AUTHORIZATION-KEY",
          "PA-APPROVED-AMT",
          "PA-AUTH-ORIG-DATE"
        ],
        "citation": [
          434,
          525
        ]
      }
    ],
    "writes_to": [
      {
        "destination": "COPAU0AO",
        "fields_written": [
          "ACCTIDO",
          "CNAMEO",
          "CREDLIMO",
          "APPRCNTO",
          "TRNID01I",
          "PAMT001I"
        ],
        "citation": [
          230,
          763,
          781,
          789,
          547
        ]
      },
      {
        "destination": "CARDDEMO-COMMAREA",
        "fields_written": [
          "CDEMO-CPVS-PAU-SELECTED",
          "CDEMO-CPVS-AUTH-KEYS",
          "CDEMO-CPVS-PAGE-NUM"
        ],
        "citation": [
          289,
          545,
          437
        ]
      }
    ],
    "transforms": [
      {
        "input_field": "PA-AUTH-ORIG-TIME",
        "output_field": "WS-AUTH-TIME",
        "transformation_description": "Reformats HHMMSS to HH:MM:SS string by substring moves",
        "citation": [
          527
        ]
      },
      {
        "input_field": "PA-AUTH-ORIG-DATE",
        "output_field": "WS-AUTH-DATE",
        "transformation_description": "Reformats YYMMDD to MM/DD/YY using WS-CURDATE intermediates",
        "citation": [
          531
        ]
      },
      {
        "input_field": "PA-AUTH-RESP-CODE",
        "output_field": "WS-AUTH-APRV-STAT",
        "transformation_description": "'00' becomes 'A' (approved), else 'D' (declined)",
        "citation": [
          536
        ]
      },
      {
        "input_field": "CUST-FIRST-NAME CUST-MIDDLE-NAME CUST-LAST-NAME",
        "output_field": "CNAMEO",
        "transformation_description": "Concatenates name parts with spaces, middle initial truncated to 1",
        "citation": [
          758
        ]
      }
    ]
  },
  "copybooks_used": [
    {
      "copybook_name": "COCOM01Y",
      "purpose": "Defines CARDDEMO-COMMAREA structure including CDEMO-CPVS-INFO for page keys, selected auth, account ID",
      "location": "WORKING_STORAGE",
      "citation": 116
    },
    {
      "copybook_name": "COPAU00",
      "purpose": "BMS mapset for COPAU0A input/output maps handling account ID, auth list fields, selections",
      "location": "WORKING_STORAGE",
      "citation": 129
    },
    {
      "copybook_name": "COTTL01Y",
      "purpose": "Screen titles like CCDA-TITLE01 used in header",
      "location": "WORKING_STORAGE",
      "citation": 132
    },
    {
      "copybook_name": "CSDAT01Y",
      "purpose": "Current date working variables WS-CURDATE-* for formatting",
      "location": "WORKING_STORAGE",
      "citation": 135
    },
    {
      "copybook_name": "CSMSG01Y",
      "purpose": "Common messages like CCDA-MSG-INVALID-KEY",
      "location": "WORKING_STORAGE",
      "citation": 138
    },
    {
      "copybook_name": "CSMSG02Y",
      "purpose": "Abend variables",
      "location": "WORKING_STORAGE",
      "citation": 141
    },
    {
      "copybook_name": "CVACT01Y",
      "purpose": "Account record layout ACCOUNT-RECORD",
      "location": "WORKING_STORAGE",
      "citation": 144
    },
    {
      "copybook_name": "CVACT02Y",
      "purpose": "Additional customer or account related layout",
      "location": "WORKING_STORAGE",
      "citation": 147
    },
    {
      "copybook_name": "CVACT03Y",
      "purpose": "Card XREF record layout CARD-XREF-RECORD",
      "location": "WORKING_STORAGE",
      "citation": 150
    },
    {
      "copybook_name": "CVCUS01Y",
      "purpose": "Customer record layout CUSTOMER-RECORD",
      "location": "WORKING_STORAGE",
      "citation": 153
    },
    {
      "copybook_name": "CIPAUSMY",
      "purpose": "IMS PENDING-AUTH-SUMMARY segment PAUTSUM0 layout",
      "location": "WORKING_STORAGE",
      "citation": 161
    },
    {
      "copybook_name": "CIPAUDTY",
      "purpose": "IMS PENDING-AUTH-DETAILS segment PAUTDTL1 layout",
      "location": "WORKING_STORAGE",
      "citation": 165
    },
    {
      "copybook_name": "DFHAID",
      "purpose": "CICS attention identifier EIBAID",
      "location": "WORKING_STORAGE",
      "citation": 168
    },
    {
      "copybook_name": "DFHBMSCA",
      "purpose": "CICS BMS control attributes like DFHBMUNP, DFHBMPRO",
      "location": "WORKING_STORAGE",
      "citation": 170
    }
  ],
  "paragraphs": [
    {
      "paragraph_name": "MAIN-PARA",
      "summary": null,
      "purpose": "This is the primary entry point and orchestration paragraph that initializes flags, handles first-time entry (EIBCALEN=0) by sending initial screen, or processes commarea for reentry. It consumes EIBCALEN, DFHCOMMAREA if present, and map data via RECEIVE-PAULST-SCREEN. It produces updated COPAU0AO map and CARDDEMO-COMMAREA for return or XCTL. Business logic evaluates EIBAID for PF/ENTER keys dispatching to specific handlers like PROCESS-ENTER-KEY, navigation, or return; first distinguishes initial load vs reenter. Errors set WS-ERR-FLG and message. Calls RECEIVE-PAULST-SCREEN, PROCESS-ENTER-KEY, SEND-PAULST-SCREEN, RETURN-TO-PREV-SCREEN, GATHER-DETAILS, and CICS RETURN with TRANSID CPVS. Always ends with CICS RETURN preserving commarea and transaction.",
      "called_by": [],
      "calls": [
        "RECEIVE-PAULST-SCREEN",
        "PROCESS-ENTER-KEY",
        "SEND-PAULST-SCREEN",
        "GATHER-DETAILS",
        "RETURN-TO-PREV-SCREEN"
      ],
      "citation": [
        178,
        257
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "PROCESS-ENTER-KEY",
      "summary": null,
      "purpose": "Handles ENTER key press to validate and process account ID entry or line selection for detail view. Consumes ACCTIDI and SEL0001I-SEL0005I from input map COPAU0AI. Produces updated CDEMO-CPVS-PAU-SEL-FLG, CDEMO-CPVS-PAU-SELECTED in commarea, WS-ACCT-ID, and error message if invalid. Business logic checks ACCTIDI for spaces/low/non-numeric, maps SEL fields to index 1-5 for selected auth key, validates selection 'S'/'s' before XCTL to detail program. Errors set WS-ERR-FLG, cursor to ACCTIDL, custom messages. Calls GATHER-DETAILS to refresh data post-processing.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [
        "GATHER-DETAILS"
      ],
      "citation": [
        261,
        338
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "GATHER-DETAILS",
      "summary": null,
      "purpose": "Orchestrates data retrieval and page population for the current account. Consumes WS-ACCT-ID from map/commarea. Produces populated auth list in map via PROCESS-PAGE-FORWARD, initializes data. Business logic conditionally gathers account details if valid ACCT-ID, initializes auth data, processes first page of auths if summary segment found. No explicit errors but relies on subordinate error handling. Calls GATHER-ACCOUNT-DETAILS, INITIALIZE-AUTH-DATA, PROCESS-PAGE-FORWARD.",
      "called_by": [
        "MAIN-PARA",
        "PROCESS-ENTER-KEY"
      ],
      "calls": [
        "GATHER-ACCOUNT-DETAILS",
        "INITIALIZE-AUTH-DATA",
        "PROCESS-PAGE-FORWARD"
      ],
      "citation": [
        342,
        358
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "PROCESS-PF7-KEY",
      "summary": null,
      "purpose": "Handles backward page navigation (PF7). Consumes CDEMO-CPVS-PAGE-NUM and PAUKEY-PREV-PG array from commarea. Produces updated page num, WS-AUTH-KEY-SAVE from prev key, refreshed list via PROCESS-PAGE-FORWARD. Business logic decrements page if >1, loads prev key, calls GET-AUTH-SUMMARY and PROCESS-PAGE-FORWARD; else error message. Sets SEND-ERASE-NO and NEXT-PAGE-YES. Calls GET-AUTH-SUMMARY, INITIALIZE-AUTH-DATA, PROCESS-PAGE-FORWARD.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [
        "GET-AUTH-SUMMARY",
        "INITIALIZE-AUTH-DATA",
        "PROCESS-PAGE-FORWARD"
      ],
      "citation": [
        362,
        385
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "PROCESS-PF8-KEY",
      "summary": null,
      "purpose": "Handles forward page navigation to next page (PF8). Consumes CDEMO-CPVS-PAUKEY-LAST from commarea. Produces repositioned auth list via REPOSITION-AUTHORIZATIONS and PROCESS-PAGE-FORWARD. Business logic uses last key for GNP reposition if valid, sets NEXT-PAGE-YES/NO based on further read; error if at end. Sets SEND-ERASE-NO. Calls GET-AUTH-SUMMARY, REPOSITION-AUTHORIZATIONS, INITIALIZE-AUTH-DATA, PROCESS-PAGE-FORWARD.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [
        "GET-AUTH-SUMMARY",
        "REPOSITION-AUTHORIZATIONS",
        "INITIALIZE-AUTH-DATA",
        "PROCESS-PAGE-FORWARD"
      ],
      "citation": [
        388,
        412
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "PROCESS-PAGE-FORWARD",
      "summary": null,
      "purpose": "Fills the current page with up to 5 authorization details by sequential GNP reads. Consumes current IMS position/WS-AUTH-KEY-SAVE. Produces CDEMO-CPVS-AUTH-KEYS(1-5), PAUKEY-LAST/PREV-PG, map fields TRNIDxxI/PDATExxI etc via POPULATE-AUTH-LIST, sets NEXT-PAGE-YES if more. Business logic loops WS-IDX 1-5 calling GET-AUTHORIZATIONS or REPOSITION for first, populates if no EOF/error, peeks one extra for next flag. Handles PF7 reposition special case. Calls REPOSITION-AUTHORIZATIONS, GET-AUTHORIZATIONS, POPULATE-AUTH-LIST.",
      "called_by": [
        "GATHER-DETAILS",
        "PROCESS-PF7-KEY",
        "PROCESS-PF8-KEY"
      ],
      "calls": [
        "REPOSITION-AUTHORIZATIONS",
        "GET-AUTHORIZATIONS",
        "POPULATE-AUTH-LIST"
      ],
      "citation": [
        415,
        454
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "GET-AUTHORIZATIONS",
      "summary": null,
      "purpose": "Performs IMS GNP to fetch next PAUTDTL1 detail segment. Consumes current PCB position. Produces PENDING-AUTH-DETAILS populated. Business logic executes DLI GNP PAUTDTL1, evaluates IMS-RETURN-CODE: OK continues, GE/GB sets EOF, others error with message and SEND. No subordinate calls.",
      "called_by": [
        "PROCESS-PAGE-FORWARD"
      ],
      "calls": [],
      "citation": [
        458,
        486
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "REPOSITION-AUTHORIZATIONS",
      "summary": null,
      "purpose": "Repositions IMS cursor to specific authorization key for paging. Consumes WS-AUTH-KEY-SAVE moved to PA-AUTHORIZATION-KEY. Produces PENDING-AUTH-DETAILS at key. Business logic DLI GNP PAUTDTL1 WHERE PAUT9CTS=KEY, evaluates code: OK/AUTHS-NOT-EOF, GE/GB EOF, other error/SEND. No calls.",
      "called_by": [
        "PROCESS-PF8-KEY",
        "PROCESS-PAGE-FORWARD"
      ],
      "calls": [],
      "citation": [
        488,
        518
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "POPULATE-AUTH-LIST",
      "summary": null,
      "purpose": "Transforms and maps current detail segment to screen list fields for current WS-IDX (1-5). Consumes PENDING-AUTH-DETAILS fields like PA-APPROVED-AMT, dates, resp code. Produces map fields TRNIDxxI, PAMTxxI, CDEMO-CPVS-AUTH-KEYS(WS-IDX). Business logic formats time/date, sets status A/D, EVALUATE WS-IDX to assign specific map fields and unprotected attrs. No errors or calls.",
      "called_by": [
        "PROCESS-PAGE-FORWARD"
      ],
      "calls": [],
      "citation": [
        522,
        605
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "INITIALIZE-AUTH-DATA",
      "summary": null,
      "purpose": "Clears the 5 authorization list fields in map to protected blanks before population. Consumes nothing specific. Produces SPACES in TRNIDxxI/PDATE etc, DFHBMPRO in SEL000xA. Business logic VARYING WS-IDX 1-5 EVALUATE to set each group of fields. No errors/calls.",
      "called_by": [
        "GATHER-DETAILS",
        "PROCESS-PF7-KEY",
        "PROCESS-PF8-KEY"
      ],
      "calls": [],
      "citation": [
        608,
        662
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "RETURN-TO-PREV-SCREEN",
      "summary": null,
      "purpose": "Prepares XCTL to previous or menu program on PF3. Consumes CDEMO-TO-PROGRAM (defaults COSGN00C). Produces updated commarea context flags. Business logic sets from/to programs, context 0, XCTL PROGRAM. No errors.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [],
      "citation": [
        665,
        677
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "SEND-PAULST-SCREEN",
      "summary": null,
      "purpose": "Sends the populated map to terminal with optional ERASE. Consumes fully populated COPAU0AO incl message/header. Produces screen display. Business logic syncpoint if PSB scheduled, calls POPULATE-HEADER-INFO, SEND MAP COPAU0A ERASE if flag or CURSOR only. No errors.",
      "called_by": [
        "MAIN-PARA",
        "PROCESS-ENTER-KEY",
        "GETCARDXREF-BYACCT",
        "GET-AUTH-SUMMARY"
      ],
      "calls": [
        "POPULATE-HEADER-INFO"
      ],
      "citation": [
        681,
        709
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "RECEIVE-PAULST-SCREEN",
      "summary": null,
      "purpose": "Receives user input from map into COPAU0AI with resp codes. Consumes screen data. Produces COPAU0AI fields populated, WS-RESP-CD/REAS. Business logic CICS RECEIVE MAP. No further logic.",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [],
      "citation": [
        712,
        722
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "POPULATE-HEADER-INFO",
      "summary": null,
      "purpose": "Fills static header fields with titles, tran/prog names, current date/time. Consumes FUNCTION CURRENT-DATE. Produces TITLE01O-02O, TRNNAMEO, PGMNAMEO, CURDATEO, CURTIMEO in map. Business logic formats date/time from WS-CURDATE-*, moves constants. No errors/calls.",
      "called_by": [
        "SEND-PAULST-SCREEN"
      ],
      "calls": [],
      "citation": [
        726,
        747
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "GATHER-ACCOUNT-DETAILS",
      "summary": null,
      "purpose": "Retrieves and displays account/customer summary info from VSAM files and IMS summary. Consumes WS-ACCT-ID. Produces map fields CNAMEO, ADDR001O-002O, CREDLIMO, APPRCNTO etc from records/IMS. Business logic calls file reads, formats name/address, moves limits/balances/counts if summary found else zeros. Calls GET-AUTH-SUMMARY.",
      "called_by": [
        "GATHER-DETAILS"
      ],
      "calls": [
        "GETCARDXREF-BYACCT",
        "GETACCTDATA-BYACCT",
        "GETCUSTDATA-BYCUST",
        "GET-AUTH-SUMMARY"
      ],
      "citation": [
        750,
        807
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "GETCARDXREF-BYACCT",
      "summary": null,
      "purpose": "Reads card xref VSAM via alt index for cust/card nums. Consumes WS-ACCT-ID to RID. Produces CARD-XREF-RECORD, CDEMO-CUST-ID/CARD-NUM. Business logic CICS READ, NORMAL moves fields, NOTFND/OTHER error message/SEND.",
      "called_by": [
        "GATHER-ACCOUNT-DETAILS"
      ],
      "calls": [
        "SEND-PAULST-SCREEN"
      ],
      "citation": [
        812,
        862
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "GETACCTDATA-BYACCT",
      "summary": null,
      "purpose": "Reads account VSAM by acct ID from xref. Consumes XREF-ACCT-ID to RID. Produces ACCOUNT-RECORD. Business logic CICS READ, NORMAL continue, NOTFND/OTHER error/SEND.",
      "called_by": [
        "GATHER-ACCOUNT-DETAILS"
      ],
      "calls": [
        "SEND-PAULST-SCREEN"
      ],
      "citation": [
        865,
        912
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "GETCUSTDATA-BYCUST",
      "summary": null,
      "purpose": "Reads customer VSAM by cust ID from xref. Consumes XREF-CUST-ID to RID. Produces CUSTOMER-RECORD. Business logic CICS READ, NORMAL continue, NOTFND/OTHER error/SEND.",
      "called_by": [
        "GATHER-ACCOUNT-DETAILS"
      ],
      "calls": [
        "SEND-PAULST-SCREEN"
      ],
      "citation": [
        915,
        963
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "GET-AUTH-SUMMARY",
      "summary": null,
      "purpose": "Schedules PSB and GU IMS summary segment by acct ID. Consumes CDEMO-ACCT-ID to PA-ACCT-ID. Produces PENDING-AUTH-SUMMARY if found, sets FOUND-PAUT-SMRY-SEG flag. Business logic SCHEDULE-PSB, DLI GU WHERE ACCNTID=, OK found, GE notfound, other error/SEND.",
      "called_by": [
        "PROCESS-PF7-KEY",
        "PROCESS-PF8-KEY",
        "GATHER-ACCOUNT-DETAILS"
      ],
      "calls": [
        "SCHEDULE-PSB",
        "SEND-PAULST-SCREEN"
      ],
      "citation": [
        966,
        996
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "SCHEDULE-PSB",
      "summary": null,
      "purpose": "Schedules IMS PSB 'PSBPAUTB' handling duplicates. Consumes PSB-NAME. Produces scheduled PCB, sets IMS-PSB-SCHD flag. Business logic DLI SCHD NODHABEND, if TC TERM+SCHD again, OK set flag else error/SEND.",
      "called_by": [
        "GET-AUTH-SUMMARY"
      ],
      "calls": [
        "SEND-PAULST-SCREEN"
      ],
      "citation": [
        1001,
        1031
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    }
  ],
  "error_handling": [
    {
      "condition": "CICS READ RESP NOT NORMAL (e.g. NOTFND)",
      "action": "Set WS-MESSAGE with resp/reason, MOVE -1 to ACCTIDL, PERFORM SEND-PAULST-SCREEN",
      "citation": [
        828,
        846
      ]
    },
    {
      "condition": "IMS DLI GNP/REPOSITION STATUS NOT OK/GE/GB",
      "action": "Set WS-ERR-FLG 'Y', build WS-MESSAGE with IMS-RETURN-CODE, MOVE -1 ACCTIDL, SEND-PAULST-SCREEN",
      "citation": [
        467,
        474
      ]
    },
    {
      "condition": "Invalid EIBAID (OTHER)",
      "action": "Set WS-ERR-FLG 'Y', MOVE -1 ACCTIDL, CCDA-MSG-INVALID-KEY to WS-MESSAGE, SEND",
      "citation": [
        246
      ]
    },
    {
      "condition": "PSB schedule failure (NOT STATUS-OK)",
      "action": "WS-ERR-FLG 'Y', message with code, SEND",
      "citation": [
        1017
      ]
    }
  ],
  "sql_operations": [],
  "cics_operations": [
    {
      "command": "RECEIVE MAP",
      "resource": "COPAU0A/COPAU00",
      "purpose": "Capture user input account ID and selections",
      "citation": 715
    },
    {
      "command": "SEND MAP",
      "resource": "COPAU0A/COPAU00",
      "purpose": "Display populated summary screen with cursor/erase",
      "citation": 695
    },
    {
      "command": "XCTL PROGRAM",
      "resource": "COPAUS1C/COMEN01C/etc",
      "purpose": "Transfer to detail or menu program preserving commarea",
      "citation": 323
    },
    {
      "command": "RETURN TRANSID",
      "resource": "CPVS",
      "purpose": "Return control keeping transaction active with updated commarea",
      "citation": 254
    },
    {
      "command": "READ DATASET",
      "resource": "CXACAIX/ACCTDAT/CUSTDAT",
      "purpose": "Retrieve VSAM records by RIDFLD",
      "citation": 818
    },
    {
      "command": "SYNCPOINT",
      "resource": "",
      "purpose": "Commit before SEND if PSB scheduled",
      "citation": 686
    }
  ],
  "open_questions": [
    {
      "question": "Exact field layouts and meanings in copybooks like CIPAUSMY, CVACT01Y",
      "context": "Copybooks not provided in source; inferred from usage but precise types/sizes unknown",
      "suggestion": "Provide copybook sources for field-level accuracy"
    },
    {
      "question": "Calling programs and full navigation flow (e.g. who calls CPVS)",
      "context": "No self-references; commarea suggests from menu like COMEN01C",
      "suggestion": "Analyze caller programs or JCL/TDQs"
    }
  ]
}