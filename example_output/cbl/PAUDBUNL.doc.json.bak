{
  "header": {
    "program_id": "PAUDBUNL",
    "file_name": "cbl/PAUDBUNL.CBL",
    "file_type": "COBOL",
    "analyzed_by": "WAR_RIG",
    "analyzed_at": "2026-01-25T18:32:07.681911",
    "iteration_count": 1,
    "final_status": null
  },
  "purpose": {
    "summary": "This program unloads data from an IMS hierarchical database by reading root segments named PAUTSUM0 (Pending Authorization Summary) using GN calls and writing them to sequential file OPFILE1. For each valid root segment with numeric PA-ACCT-ID, it reads associated child segments PAUTDTL1 (Pending Authorization Details) using GNP calls and writes them to OPFILE2 prefixed with the root PA-ACCT-ID as ROOT-SEG-KEY. It processes until end of database (GB status) and handles errors by abending.",
    "business_context": "Utility for unloading Pending Authorization IMS database segments, likely for archiving, migration, or batch processing.",
    "program_type": "UTILITY",
    "citations": [
      18,
      157,
      212,
      227,
      233,
      257,
      270,
      271
    ]
  },
  "inputs": [
    {
      "name": "PAUTSUM0",
      "io_type": "IMS_SEGMENT",
      "description": "Root segment containing Pending Authorization Summary data defined by PENDING-AUTH-SUMMARY",
      "copybook": "CIPAUSMY",
      "citation": [
        212,
        215,
        227
      ]
    },
    {
      "name": "PAUTDTL1",
      "io_type": "IMS_SEGMENT",
      "description": "Child segment containing Pending Authorization Details data defined by PENDING-AUTH-DETAILS",
      "copybook": "CIPAUDTY",
      "citation": [
        258,
        259,
        270
      ]
    }
  ],
  "outputs": [
    {
      "name": "OPFILE1",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Sequential file containing unloaded root summary segments (OPFIL1-REC PIC X(100))",
      "copybook": null,
      "citation": [
        26,
        186,
        227,
        233
      ]
    },
    {
      "name": "OPFILE2",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Sequential file containing unloaded child detail segments prefixed with root segment key (ROOT-SEG-KEY PIC S9(11) COMP-3 + CHILD-SEG-REC PIC X(200))",
      "copybook": null,
      "citation": [
        32,
        194,
        230,
        271
      ]
    }
  ],
  "called_programs": [],
  "calling_context": {
    "called_by": [],
    "entry_points": [],
    "linkage_section": [
      "PAUTBPCB"
    ]
  },
  "business_rules": [
    {
      "rule_id": "BR001",
      "description": "Only write root summary record and process child details if PA-ACCT-ID is numeric",
      "logic_summary": "IF PA-ACCT-ID IS NUMERIC then WRITE OPFIL1-REC and PERFORM child read loop",
      "conditions": [
        "PA-ACCT-ID IS NUMERIC"
      ],
      "citation": [
        232,
        233,
        235
      ]
    },
    {
      "rule_id": "BR002",
      "description": "Increment counters for every root and child segment read successfully from IMS",
      "logic_summary": "ADD 1 TO WS-NO-SUMRY-READ and WS-AUTH-SMRY-PROC-CNT on successful GN and GNP",
      "conditions": [
        "PAUT-PCB-STATUS = SPACES"
      ],
      "citation": [
        223,
        225,
        266,
        268
      ]
    }
  ],
  "data_flow": {
    "reads_from": [
      {
        "source": "PAUTSUM0",
        "fields_used": [
          "PA-ACCT-ID"
        ],
        "citation": [
          212,
          230
        ]
      },
      {
        "source": "PAUTDTL1",
        "fields_used": [],
        "citation": [
          258
        ]
      }
    ],
    "writes_to": [
      {
        "destination": "OPFILE1",
        "fields_written": [
          "OPFIL1-REC"
        ],
        "citation": [
          233
        ]
      },
      {
        "destination": "OPFILE2",
        "fields_written": [
          "ROOT-SEG-KEY",
          "CHILD-SEG-REC"
        ],
        "citation": [
          271
        ]
      }
    ],
    "transforms": [
      {
        "input_field": "PENDING-AUTH-SUMMARY",
        "output_field": "OPFIL1-REC",
        "transformation_description": "Direct move of entire summary segment to output record",
        "citation": [
          227
        ]
      },
      {
        "input_field": "PA-ACCT-ID",
        "output_field": "ROOT-SEG-KEY",
        "transformation_description": "Move root account ID to prefix field in detail output record",
        "citation": [
          230
        ]
      },
      {
        "input_field": "PENDING-AUTH-DETAILS",
        "output_field": "CHILD-SEG-REC",
        "transformation_description": "Direct move of entire detail segment to output record",
        "citation": [
          270
        ]
      }
    ]
  },
  "copybooks_used": [
    {
      "copybook_name": "IMSFUNCS",
      "purpose": "Defines IMS DL/I function codes such as FUNC-GN and FUNC-GNP",
      "location": "WORKING_STORAGE",
      "citation": 132
    },
    {
      "copybook_name": "CIPAUSMY",
      "purpose": "Defines layout of PENDING-AUTH-SUMMARY root IMS segment",
      "location": "WORKING_STORAGE",
      "citation": 139
    },
    {
      "copybook_name": "CIPAUDTY",
      "purpose": "Defines layout of PENDING-AUTH-DETAILS child IMS segment",
      "location": "WORKING_STORAGE",
      "citation": 143
    },
    {
      "copybook_name": "PAUTBPCB",
      "purpose": "Defines IMS PCB masks passed in linkage for database access",
      "location": "LINKAGE",
      "citation": 150
    }
  ],
  "paragraphs": [
    {
      "paragraph_name": "MAIN-PARA",
      "summary": null,
      "purpose": "Main control logic: initialize, loop over root segments until end, close files",
      "called_by": [],
      "calls": [
        "1000-INITIALIZE",
        "2000-FIND-NEXT-AUTH-SUMMARY",
        "4000-FILE-CLOSE"
      ],
      "citation": [
        157,
        170
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "1000-INITIALIZE",
      "summary": null,
      "purpose": "Accept dates, display startup info, open output files OPFILE1 and OPFILE2",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [],
      "citation": [
        173,
        204
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "2000-FIND-NEXT-AUTH-SUMMARY",
      "summary": null,
      "purpose": "Perform IMS GN call to read next root summary segment, write to OPFILE1 if valid numeric acct ID, read children",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [
        "3000-FIND-NEXT-AUTH-DTL",
        "9999-ABEND"
      ],
      "citation": [
        207,
        249
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "3000-FIND-NEXT-AUTH-DTL",
      "summary": null,
      "purpose": "Perform IMS GNP call to read next child detail segment under current root, write to OPFILE2",
      "called_by": [
        "2000-FIND-NEXT-AUTH-SUMMARY"
      ],
      "calls": [
        "9999-ABEND"
      ],
      "citation": [
        253,
        286
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "4000-FILE-CLOSE",
      "summary": null,
      "purpose": "Close output files OPFILE1 and OPFILE2",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [],
      "citation": [
        289,
        306
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    },
    {
      "paragraph_name": "9999-ABEND",
      "summary": null,
      "purpose": "Display abend message and terminate with RETURN-CODE 16",
      "called_by": [
        "1000-INITIALIZE",
        "2000-FIND-NEXT-AUTH-SUMMARY",
        "3000-FIND-NEXT-AUTH-DTL",
        "4000-FILE-CLOSE"
      ],
      "calls": [],
      "citation": [
        308,
        317
      ],
      "outgoing_calls": [],
      "incoming_calls": [],
      "metadata": null
    }
  ],
  "error_handling": [
    {
      "condition": "WS-OUTFL1-STATUS NOT = '00' or SPACES after OPEN OPFILE1",
      "action": "DISPLAY error and PERFORM 9999-ABEND",
      "citation": [
        187,
        190
      ]
    },
    {
      "condition": "WS-OUTFL2-STATUS NOT = '00' or SPACES after OPEN OPFILE2",
      "action": "DISPLAY error and PERFORM 9999-ABEND",
      "citation": [
        195,
        198
      ]
    },
    {
      "condition": "PAUT-PCB-STATUS NOT = SPACES and NOT 'GB' after GN root call",
      "action": "DISPLAY error details and PERFORM 9999-ABEND",
      "citation": [
        243,
        244
      ]
    },
    {
      "condition": "PAUT-PCB-STATUS NOT = SPACES and NOT 'GE' after GNP child call",
      "action": "DISPLAY error details and PERFORM 9999-ABEND",
      "citation": [
        279,
        280
      ]
    },
    {
      "condition": "WS-OUTFL1-STATUS NOT = '00' or SPACES after CLOSE OPFILE1",
      "action": "DISPLAY error",
      "citation": [
        293,
        296
      ]
    },
    {
      "condition": "WS-OUTFL2-STATUS NOT = '00' or SPACES after CLOSE OPFILE2",
      "action": "DISPLAY error",
      "citation": [
        300,
        303
      ]
    }
  ],
  "sql_operations": [],
  "cics_operations": [],
  "open_questions": [
    {
      "question": "Contents and field definitions of copybooks CIPAUSMY, CIPAUDTY, PAUTBPCB, IMSFUNCS",
      "context": "Not provided in source; only referenced via COPY statements",
      "suggestion": "Provide copybook source files for field-level analysis"
    },
    {
      "question": "Exact field definition and position of PA-ACCT-ID",
      "context": "Referenced in move and numeric check but defined in unprovided copybook CIPAUSMY",
      "suggestion": "Analyze CIPAUSMY copybook"
    },
    {
      "question": "Purpose of unused variables like WS-EXPIRY-DAYS, WS-NO-DTL-READ, WS-NO-SUMRY-DELETED",
      "context": "Defined in WS but no usage in provided code; counters like WS-NO-SUMRY-READ incremented in child logic possibly erroneously",
      "suggestion": "Check for conditional compilation or review full execution traces"
    },
    {
      "question": "Calling context and how PAUTBPCB is populated",
      "context": "Passed via linkage and ENTRY 'DLITCBL'; no caller specified",
      "suggestion": "Trace JCL or calling program"
    }
  ]
}