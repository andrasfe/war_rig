{
  "header": {
    "program_id": "CBEXPORT",
    "file_name": "CBEXPORT.cbl",
    "file_type": "COBOL",
    "analyzed_by": "WAR_RIG",
    "analyzed_at": "2026-01-18T17:35:36.076535",
    "iteration_count": 2,
    "final_status": null
  },
  "purpose": {
    "summary": "Batch COBOL program that reads all records sequentially from five indexed input files (customers, accounts, xrefs, transactions, cards) until EOF and writes them as fixed 500-character multi-record export file with type-specific layouts ('C','A','X','T','D'). Adds common header fields including record type, formatted current timestamp, incrementing sequence number, branch ID '0001', region 'NORTH'; maps input fields directly; tracks and displays export statistics.",
    "business_context": "CardDemo branch migration: exports normalized data files into single multi-record format for data migration to new branch",
    "program_type": "BATCH",
    "citations": [
      5,
      6,
      7,
      8,
      27,
      28,
      29,
      30,
      149,
      243,
      312,
      376,
      431,
      496
    ]
  },
  "inputs": [
    {
      "name": "CUSTOMER-INPUT",
      "io_type": "FILE_VSAM",
      "description": "Indexed sequential VSAM customer master file containing customer profiles: ID, names, addresses, phones, SSN, govt ID, DOB, EFT account ID, primary card holder ind, FICO score",
      "copybook": "CVCUS01Y",
      "citation": [
        260
      ]
    },
    {
      "name": "ACCOUNT-INPUT",
      "io_type": "FILE_VSAM",
      "description": "Indexed sequential VSAM account master file: account ID, active status, current balance, credit/cash limits, open/expiration/reissue dates, current cycle credit/debit, address ZIP, group ID",
      "copybook": "CVACT01Y",
      "citation": [
        329
      ]
    },
    {
      "name": "XREF-INPUT",
      "io_type": "FILE_VSAM",
      "description": "Indexed sequential VSAM cross-reference file linking card number to customer ID and account ID",
      "copybook": "CVACT03Y",
      "citation": [
        393
      ]
    },
    {
      "name": "TRANSACTION-INPUT",
      "io_type": "FILE_VSAM",
      "description": "Indexed sequential VSAM transaction file: transaction ID, type/cat codes, source, description, amount, merchant ID/name/city/ZIP, card number, original/process timestamps",
      "copybook": "CVTRA05Y",
      "citation": [
        448
      ]
    },
    {
      "name": "CARD-INPUT",
      "io_type": "FILE_VSAM",
      "description": "Indexed sequential VSAM card master file: card number, account ID, CVV code, embossed name, expiration date, active status",
      "copybook": "CVACT02Y",
      "citation": [
        513
      ]
    }
  ],
  "outputs": [
    {
      "name": "EXPORT-OUTPUT",
      "io_type": "FILE_VSAM",
      "description": "Indexed sequential VSAM output file of fixed 500-char records; multi-record types 'C'(customer), 'A'(account), 'X'(xref), 'T'(transaction), 'D'(card); common prefix: rec-type, timestamp(YYYY-MM-DD HH:MM:SS.00), sequence num, branch '0001', region 'NORTH'; followed by type-specific fields directly mapped from inputs",
      "copybook": "CVEXPORT",
      "citation": [
        301,
        364,
        419,
        484,
        542
      ]
    }
  ],
  "called_programs": [
    {
      "program_name": "CEE3ABD",
      "call_type": "STATIC_CALL",
      "purpose": "Language Environment abend routine to terminate program abnormally",
      "parameters": [],
      "citation": 579
    }
  ],
  "calling_context": {
    "called_by": [],
    "entry_points": [],
    "linkage_section": []
  },
  "business_rules": [
    {
      "rule_id": "BR001",
      "description": "Export every input record without filtering or selection criteria; process all sequentially from start to EOF",
      "logic_summary": "Initial READ then PERFORM UNTIL <FILE>-EOF alternating CREATE-EXP-REC and READ",
      "conditions": [
        "WS-CUSTOMER-EOF",
        "WS-ACCOUNT-EOF",
        "WS-XREF-EOF",
        "WS-TRANSACTION-EOF",
        "WS-CARD-EOF"
      ],
      "citation": [
        249,
        318,
        382,
        437,
        502
      ]
    },
    {
      "rule_id": "BR002",
      "description": "Populate common export header for every record: type-specific rec-type ('C/A/X/T/D'), current formatted timestamp, incrementing sequence counter starting from 0, fixed branch '0001', region 'NORTH'",
      "logic_summary": "INITIALIZE EXPORT-RECORD then MOVE literals/computed values before input field MOVEs; ADD 1 TO WS-SEQUENCE-COUNTER per record",
      "conditions": [
        "Always executed in each CREATE-*-EXP-REC paragraph"
      ],
      "citation": [
        274,
        275,
        276,
        278,
        279,
        343,
        344,
        345,
        347,
        348,
        406,
        407,
        409,
        411,
        412,
        462,
        463,
        464,
        466,
        467,
        527,
        528,
        529,
        531,
        532
      ]
    },
    {
      "rule_id": "BR003",
      "description": "Strict file error handling: abend immediately on any non-zero/non-EOF file status during OPEN, READ (non-EOF), or WRITE",
      "logic_summary": "IF NOT <FILE>-OK [AND NOT EOF for READ] then DISPLAY error status and PERFORM 9999-ABEND-PROGRAM",
      "conditions": [
        "NOT WS-*-OK",
        "NOT WS-*-EOF (for READ)"
      ],
      "citation": [
        201,
        262,
        303,
        208,
        331,
        366,
        215,
        395,
        421,
        222,
        450,
        486,
        229,
        515,
        544,
        236
      ]
    },
    {
      "rule_id": "BR004",
      "description": "Generate formatted current timestamp for export headers: date YYYY-MM-DD, time HH:MM:SS.00",
      "logic_summary": "ACCEPT DATE/TIME YYYYMMDD/HHMMSSHH then STRING with delimiters",
      "conditions": [
        "Executed once in 1050-GENERATE-TIMESTAMP"
      ],
      "citation": [
        175,
        176,
        179,
        184,
        191
      ]
    },
    {
      "rule_id": "BR005",
      "description": "Track and report export statistics: per-type record counts and grand total, displayed at start/process/end",
      "logic_summary": "Increment counters ADD 1 TO WS-*-RECORDS-EXPORTED and WS-TOTAL-RECORDS-EXPORTED after each successful WRITE; DISPLAY in loops and FINALIZE",
      "conditions": [
        "After each successful export record write"
      ],
      "citation": [
        309,
        372,
        427,
        492,
        550,
        255,
        324,
        388,
        443,
        508,
        564,
        566,
        568,
        569,
        571,
        573
      ]
    }
  ],
  "data_flow": {
    "reads_from": [
      {
        "source": "CUSTOMER-INPUT",
        "fields_used": [
          "CUST-ID",
          "CUST-FIRST-NAME",
          "CUST-MIDDLE-NAME",
          "CUST-LAST-NAME",
          "CUST-ADDR-LINE-1",
          "CUST-ADDR-LINE-2",
          "CUST-ADDR-LINE-3",
          "CUST-ADDR-STATE-CD",
          "CUST-ADDR-COUNTRY-CD",
          "CUST-ADDR-ZIP",
          "CUST-PHONE-NUM-1",
          "CUST-PHONE-NUM-2",
          "CUST-SSN",
          "CUST-GOVT-ISSUED-ID",
          "CUST-DOB-YYYY-MM-DD",
          "CUST-EFT-ACCOUNT-ID",
          "CUST-PRI-CARD-HOLDER-IND",
          "CUST-FICO-CREDIT-SCORE"
        ],
        "citation": [
          260,
          282,
          283,
          284,
          285,
          286,
          287,
          288,
          289,
          290,
          291,
          292,
          293,
          294,
          295,
          296,
          297,
          298,
          299,
          300
        ]
      },
      {
        "source": "ACCOUNT-INPUT",
        "fields_used": [
          "ACCT-ID",
          "ACCT-ACTIVE-STATUS",
          "ACCT-CURR-BAL",
          "ACCT-CREDIT-LIMIT",
          "ACCT-CASH-CREDIT-LIMIT",
          "ACCT-OPEN-DATE",
          "ACCT-EXPIRAION-DATE",
          "ACCT-REISSUE-DATE",
          "ACCT-CURR-CYC-CREDIT",
          "ACCT-CURR-CYC-DEBIT",
          "ACCT-ADDR-ZIP",
          "ACCT-GROUP-ID"
        ],
        "citation": [
          329,
          351,
          352,
          353,
          354,
          355,
          356,
          357,
          358,
          359,
          360,
          361,
          362
        ]
      },
      {
        "source": "XREF-INPUT",
        "fields_used": [
          "XREF-CARD-NUM",
          "XREF-CUST-ID",
          "XREF-ACCT-ID"
        ],
        "citation": [
          393,
          415,
          416,
          417
        ]
      },
      {
        "source": "TRANSACTION-INPUT",
        "fields_used": [
          "TRAN-ID",
          "TRAN-TYPE-CD",
          "TRAN-CAT-CD",
          "TRAN-SOURCE",
          "TRAN-DESC",
          "TRAN-AMT",
          "TRAN-MERCHANT-ID",
          "TRAN-MERCHANT-NAME",
          "TRAN-MERCHANT-CITY",
          "TRAN-MERCHANT-ZIP",
          "TRAN-CARD-NUM",
          "TRAN-ORIG-TS",
          "TRAN-PROC-TS"
        ],
        "citation": [
          448,
          470,
          471,
          472,
          473,
          474,
          475,
          476,
          477,
          478,
          479,
          480,
          481,
          482,
          483
        ]
      },
      {
        "source": "CARD-INPUT",
        "fields_used": [
          "CARD-NUM",
          "CARD-ACCT-ID",
          "CARD-CVV-CD",
          "CARD-EMBOSSED-NAME",
          "CARD-EXPIRAION-DATE",
          "CARD-ACTIVE-STATUS"
        ],
        "citation": [
          513,
          535,
          536,
          537,
          538,
          539,
          540,
          541
        ]
      }
    ],
    "writes_to": [
      {
        "destination": "EXPORT-OUTPUT",
        "fields_written": [
          "EXPORT-REC-TYPE",
          "EXPORT-TIMESTAMP",
          "EXPORT-SEQUENCE-NUM",
          "EXPORT-BRANCH-ID",
          "EXPORT-REGION-CODE",
          "EXP-CUST-*",
          "EXP-ACCT-*",
          "EXP-XREF-*",
          "EXP-TRAN-*",
          "EXP-CARD-*"
        ],
        "citation": [
          301,
          364,
          419,
          484,
          542
        ]
      }
    ],
    "transforms": [
      {
        "input_field": "WS-CURRENT-DATE",
        "output_field": "WS-EXPORT-DATE",
        "transformation_description": "ACCEPT FROM DATE YYYYMMDD then STRING YYYY-MM-DD delimited by '-'",
        "citation": [
          175,
          179
        ]
      },
      {
        "input_field": "WS-CURRENT-TIME",
        "output_field": "WS-EXPORT-TIME",
        "transformation_description": "ACCEPT FROM TIME then STRING HH:MM:SS delimited by ':'",
        "citation": [
          176,
          184
        ]
      },
      {
        "input_field": "WS-EXPORT-DATE WS-EXPORT-TIME",
        "output_field": "WS-FORMATTED-TIMESTAMP",
        "transformation_description": "STRING date space time .00 into 26-char timestamp",
        "citation": [
          191
        ]
      },
      {
        "input_field": "CUST-ID",
        "output_field": "EXP-CUST-ID",
        "transformation_description": "Direct MOVE from input record",
        "citation": [
          282
        ]
      },
      {
        "input_field": "ACCT-ID",
        "output_field": "EXP-ACCT-ID",
        "transformation_description": "Direct MOVE from input record",
        "citation": [
          351
        ]
      },
      {
        "input_field": "TRAN-ID",
        "output_field": "EXP-TRAN-ID",
        "transformation_description": "Direct MOVE from input record",
        "citation": [
          470
        ]
      }
    ]
  },
  "copybooks_used": [
    {
      "copybook_name": "CVCUS01Y",
      "purpose": "Customer input record layout for CUSTOMER-INPUT FD",
      "location": "FILE_SECTION",
      "citation": 75
    },
    {
      "copybook_name": "CVACT01Y",
      "purpose": "Account input record layout for ACCOUNT-INPUT FD",
      "location": "FILE_SECTION",
      "citation": 78
    },
    {
      "copybook_name": "CVACT03Y",
      "purpose": "XREF input record layout for XREF-INPUT FD",
      "location": "FILE_SECTION",
      "citation": 81
    },
    {
      "copybook_name": "CVTRA05Y",
      "purpose": "Transaction input record layout for TRANSACTION-INPUT FD",
      "location": "FILE_SECTION",
      "citation": 84
    },
    {
      "copybook_name": "CVACT02Y",
      "purpose": "Card input record layout for CARD-INPUT FD",
      "location": "FILE_SECTION",
      "citation": 87
    },
    {
      "copybook_name": "CVEXPORT",
      "purpose": "Export record layout, file status areas, control vars, timestamps, statistics counters in WORKING-STORAGE",
      "location": "WORKING_STORAGE",
      "citation": 96
    }
  ],
  "paragraphs": [
    {
      "paragraph_name": "0000-MAIN-PROCESSING",
      "purpose": "Orchestrates entire process: initialize, export each entity type in sequence, finalize, GOBACK",
      "called_by": [],
      "calls": [
        "1000-INITIALIZE",
        "2000-EXPORT-CUSTOMERS",
        "3000-EXPORT-ACCOUNTS",
        "4000-EXPORT-XREFS",
        "5000-EXPORT-TRANSACTIONS",
        "5500-EXPORT-CARDS",
        "6000-FINALIZE"
      ],
      "citation": [
        149,
        158
      ]
    },
    {
      "paragraph_name": "1000-INITIALIZE",
      "purpose": "Display start message, generate timestamp, open all input/output files with error checks",
      "called_by": [
        "0000-MAIN-PROCESSING"
      ],
      "calls": [
        "1050-GENERATE-TIMESTAMP",
        "1100-OPEN-FILES"
      ],
      "citation": [
        161,
        170
      ]
    },
    {
      "paragraph_name": "1050-GENERATE-TIMESTAMP",
      "purpose": "ACCEPT current DATE/TIME, format into export-ready strings (YYYY-MM-DD, HH:MM:SS, full timestamp)",
      "called_by": [
        "1000-INITIALIZE"
      ],
      "calls": [],
      "citation": [
        172,
        195
      ]
    },
    {
      "paragraph_name": "1100-OPEN-FILES",
      "purpose": "OPEN INPUT all five files and OUTPUT EXPORT-OUTPUT; abend on any open failure",
      "called_by": [
        "1000-INITIALIZE"
      ],
      "calls": [
        "9999-ABEND-PROGRAM"
      ],
      "citation": [
        198,
        240
      ]
    },
    {
      "paragraph_name": "2000-EXPORT-CUSTOMERS",
      "purpose": "Initial read then loop until EOF: create customer export rec then read next",
      "called_by": [
        "0000-MAIN-PROCESSING"
      ],
      "calls": [
        "2100-READ-CUSTOMER-RECORD",
        "2200-CREATE-CUSTOMER-EXP-REC"
      ],
      "citation": [
        243,
        255
      ]
    },
    {
      "paragraph_name": "2100-READ-CUSTOMER-RECORD",
      "purpose": "READ NEXT sequential; abend if status not OK or EOF",
      "called_by": [
        "2000-EXPORT-CUSTOMERS"
      ],
      "calls": [
        "9999-ABEND-PROGRAM"
      ],
      "citation": [
        258,
        266
      ]
    },
    {
      "paragraph_name": "2200-CREATE-CUSTOMER-EXP-REC",
      "purpose": "Initialize, set headers, MOVE all customer fields, WRITE, check status/abend/increment counters",
      "called_by": [
        "2000-EXPORT-CUSTOMERS"
      ],
      "calls": [
        "9999-ABEND-PROGRAM"
      ],
      "citation": [
        269,
        310
      ]
    },
    {
      "paragraph_name": "3000-EXPORT-ACCOUNTS",
      "purpose": "Initial read then loop until EOF: create account export rec then read next; display count",
      "called_by": [
        "0000-MAIN-PROCESSING"
      ],
      "calls": [
        "3100-READ-ACCOUNT-RECORD",
        "3200-CREATE-ACCOUNT-EXP-REC"
      ],
      "citation": [
        312,
        324
      ]
    },
    {
      "paragraph_name": "4000-EXPORT-XREFS",
      "purpose": "Initial read then loop until EOF: create xref export rec then read next; display count",
      "called_by": [
        "0000-MAIN-PROCESSING"
      ],
      "calls": [
        "4100-READ-XREF-RECORD",
        "4200-CREATE-XREF-EXPORT-RECORD"
      ],
      "citation": [
        376,
        388
      ]
    },
    {
      "paragraph_name": "5000-EXPORT-TRANSACTIONS",
      "purpose": "Initial read then loop until EOF: create transaction export rec then read next; display count",
      "called_by": [
        "0000-MAIN-PROCESSING"
      ],
      "calls": [
        "5100-READ-TRANSACTION-RECORD",
        "5200-CREATE-TRAN-EXP-REC"
      ],
      "citation": [
        431,
        443
      ]
    },
    {
      "paragraph_name": "5500-EXPORT-CARDS",
      "purpose": "Initial read then loop until EOF: create card export rec then read next; display count",
      "called_by": [
        "0000-MAIN-PROCESSING"
      ],
      "calls": [
        "5600-READ-CARD-RECORD",
        "5700-CREATE-CARD-EXPORT-RECORD"
      ],
      "citation": [
        496,
        508
      ]
    },
    {
      "paragraph_name": "6000-FINALIZE",
      "purpose": "CLOSE all files; display completion message and all statistics",
      "called_by": [
        "0000-MAIN-PROCESSING"
      ],
      "calls": [],
      "citation": [
        554,
        573
      ]
    },
    {
      "paragraph_name": "9999-ABEND-PROGRAM",
      "purpose": "Display 'ABENDING PROGRAM' and static CALL CEE3ABD to terminate",
      "called_by": [
        "1100-OPEN-FILES",
        "2100-READ-CUSTOMER-RECORD",
        "2200-CREATE-CUSTOMER-EXP-REC",
        "3000-EXPORT-ACCOUNTS* similar"
      ],
      "calls": [],
      "citation": [
        576,
        579
      ]
    }
  ],
  "error_handling": [
    {
      "condition": "OPEN INPUT/OUTPUT file status NOT '00'",
      "action": "DISPLAY error with file name and status then PERFORM 9999-ABEND-PROGRAM",
      "citation": [
        202,
        209,
        216,
        223,
        230,
        237
      ]
    },
    {
      "condition": "READ file status NOT '00' AND NOT '10' (EOF)",
      "action": "DISPLAY error with file name and status then PERFORM 9999-ABEND-PROGRAM",
      "citation": [
        263,
        332,
        396,
        451,
        516
      ]
    },
    {
      "condition": "WRITE EXPORT-OUTPUT-RECORD status NOT '00'",
      "action": "DISPLAY error with status then PERFORM 9999-ABEND-PROGRAM",
      "citation": [
        304,
        367,
        422,
        487,
        545
      ]
    }
  ],
  "sql_operations": [],
  "cics_operations": [],
  "open_questions": [
    {
      "question": "Precise layouts and data types of all fields in copybooks (CVCUS01Y, CVACT01Y, etc., CVEXPORT)",
      "context": "Field names and usage clear from MOVEs, but exact PIC clauses, OCCURS, REDEFINES unknown without copybook source",
      "suggestion": "Obtain and analyze copybook source files"
    }
  ]
}