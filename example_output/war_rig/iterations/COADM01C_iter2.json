{
  "header": {
    "program_id": "COADM01C",
    "file_name": "COADM01C.cbl",
    "file_type": "COBOL",
    "analyzed_by": "WAR_RIG",
    "analyzed_at": "2026-01-18T17:20:00.572072",
    "iteration_count": 2,
    "final_status": null
  },
  "purpose": {
    "summary": "COADM01C is a pseudoconversational CICS program that presents an admin menu screen (COADM1A) listing up to 10 configurable admin options from the CDEMO-ADMIN-OPT table. On first invocation (EIBCALEN=0) or PF3, it XCTLs back to signon program COSGN00C; otherwise receives user input, processes ENTER key by validating numeric option (1 to CDEMO-ADMIN-OPT-COUNT), and XCTLs to the selected program if not starting with 'DUMMY'; invalid inputs or uninstalled programs display error messages and redisplay the menu.",
    "business_context": "Provides menu-driven access to administrative functions in the CardDemo application for users with admin privileges.",
    "program_type": "ONLINE_CICS",
    "citations": [
      5,
      37,
      75,
      86,
      98,
      100,
      141,
      146
    ]
  },
  "inputs": [
    {
      "name": "COADM1AI",
      "io_type": "CICS_MAP",
      "description": "Input fields from BMS map COADM1A, primarily OPTIONI containing user-selected menu option number",
      "copybook": "COADM01",
      "citation": [
        194,
        121
      ]
    },
    {
      "name": "CARDDEMO-COMMAREA",
      "io_type": "CICS_COMMAREA",
      "description": "Passed from prior invocation or caller, used to check CDEMO-PGM-REENTER flag and pass context to XCTL targets",
      "copybook": "COADM01",
      "citation": [
        90,
        91
      ]
    },
    {
      "name": "EIBAID",
      "io_type": "OTHER",
      "description": "CICS attention identifier key for ENTER (DFHENTER) or PF3 (DFHPF3) processing",
      "copybook": "DFHAID",
      "citation": [
        97
      ]
    },
    {
      "name": "EIBCALEN",
      "io_type": "OTHER",
      "description": "Commarea length to distinguish first invocation from subsequent pseudoconversational receives",
      "copybook": null,
      "citation": [
        86
      ]
    }
  ],
  "outputs": [
    {
      "name": "COADM1AO",
      "io_type": "CICS_MAP",
      "description": "Output fields for BMS map COADM1A including header (titles, tran/program/date/time), dynamically built menu options (OPTN001O-OPTN010O), selected option echo (OPTIONO), and error message (ERRMSGO)",
      "copybook": "COADM01",
      "citation": [
        182
      ]
    },
    {
      "name": "CARDDEMO-COMMAREA",
      "io_type": "CICS_COMMAREA",
      "description": "Updated commarea returned via CICS RETURN for next transaction start, including from-tran/program and context for XCTL chain",
      "copybook": "COADM01",
      "citation": [
        112
      ]
    }
  ],
  "called_programs": [
    {
      "program_name": "CDEMO-ADMIN-OPT-PGMNAME(WS-OPTION)",
      "call_type": "CICS_XCTL",
      "purpose": "Transfer control to user-selected admin option program (if not 'DUMMY') with commarea",
      "parameters": [
        "CARDDEMO-COMMAREA"
      ],
      "citation": 146
    },
    {
      "program_name": "CDEMO-TO-PROGRAM",
      "call_type": "CICS_XCTL",
      "purpose": "Return control to signon program (COSGN00C) on PF3 or initial call",
      "parameters": [],
      "citation": 169
    },
    {
      "program_name": "COSGN00C",
      "call_type": "CICS_XCTL",
      "purpose": "Default XCTL target for signon screen on first invocation or PF3 exit",
      "parameters": [],
      "citation": 88
    }
  ],
  "calling_context": {
    "called_by": [],
    "entry_points": [
      "CA00"
    ],
    "linkage_section": [
      "DFHCOMMAREA"
    ]
  },
  "business_rules": [
    {
      "rule_id": "BR001",
      "description": "Validate selected menu option is numeric, greater than zero, and within valid count",
      "logic_summary": "Trim trailing spaces from OPTIONI, INSPECT REPLACING spaces with zeros, move to WS-OPTION, check NUMERIC, > CDEMO-ADMIN-OPT-COUNT, = ZEROS",
      "conditions": [
        "WS-OPTION IS NOT NUMERIC",
        "WS-OPTION > CDEMO-ADMIN-OPT-COUNT",
        "WS-OPTION = ZEROS"
      ],
      "citation": [
        121,
        131
      ]
    },
    {
      "rule_id": "BR002",
      "description": "Only XCTL to admin program if its name does not start with 'DUMMY'",
      "logic_summary": "IF CDEMO-ADMIN-OPT-PGMNAME(WS-OPTION)(1:5) NOT = 'DUMMY' then XCTL",
      "conditions": [
        "CDEMO-ADMIN-OPT-PGMNAME(WS-OPTION)(1:5) NOT = 'DUMMY'"
      ],
      "citation": [
        141
      ]
    },
    {
      "rule_id": "BR003",
      "description": "On PF3 attention key, XCTL back to signon screen",
      "logic_summary": "EVALUATE EIBAID WHEN DFHPF3: MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM, PERFORM RETURN-TO-SIGNON-SCREEN",
      "conditions": [
        "EIBAID = DFHPF3"
      ],
      "citation": [
        100,
        101
      ]
    },
    {
      "rule_id": "BR004",
      "description": "On first invocation (EIBCALEN=0), XCTL to signon screen",
      "logic_summary": "MOVE 'COSGN00C' TO CDEMO-FROM-PROGRAM, PERFORM RETURN-TO-SIGNON-SCREEN",
      "conditions": [
        "EIBCALEN = 0"
      ],
      "citation": [
        86,
        88
      ]
    },
    {
      "rule_id": "BR005",
      "description": "On invalid attention key (neither ENTER nor PF3), display invalid key error and redisplay menu",
      "logic_summary": "EVALUATE EIBAID WHEN OTHER: MOVE 'Y' TO WS-ERR-FLG, MOVE CCDA-MSG-INVALID-KEY TO WS-MESSAGE, PERFORM SEND-MENU-SCREEN",
      "conditions": [
        "EIBAID = OTHER"
      ],
      "citation": [
        103,
        104
      ]
    }
  ],
  "data_flow": {
    "reads_from": [
      {
        "source": "COADM1AI",
        "fields_used": [
          "OPTIONI"
        ],
        "citation": [
          121
        ]
      },
      {
        "source": "CARDDEMO-COMMAREA",
        "fields_used": [
          "CDEMO-PGM-REENTER"
        ],
        "citation": [
          91
        ]
      },
      {
        "source": "EIBAID",
        "fields_used": [
          "DFHENTER",
          "DFHPF3"
        ],
        "citation": [
          97
        ]
      },
      {
        "source": "CDEMO-ADMIN-OPT-*",
        "fields_used": [
          "CDEMO-ADMIN-OPT-COUNT",
          "CDEMO-ADMIN-OPT-NUM(*)",
          "CDEMO-ADMIN-OPT-NAME(*)",
          "CDEMO-ADMIN-OPT-PGMNAME(*)"
        ],
        "citation": [
          132,
          231,
          141
        ]
      }
    ],
    "writes_to": [
      {
        "destination": "COADM1AO",
        "fields_written": [
          "ERRMSGO",
          "TITLE01O",
          "TITLE02O",
          "TRNNAMEO",
          "PGMNAMEO",
          "CURDATEO",
          "CURTIMEO",
          "OPTN001O-OPTN010O",
          "OPTIONO",
          "ERRMSGC"
        ],
        "citation": [
          180
        ]
      },
      {
        "destination": "CARDDEMO-COMMAREA",
        "fields_written": [
          "CDEMO-FROM-TRANID",
          "CDEMO-FROM-PROGRAM",
          "CDEMO-PGM-CONTEXT",
          "CDEMO-TO-PROGRAM",
          "CDEMO-PGM-REENTER"
        ],
        "citation": [
          142,
          113
        ]
      }
    ],
    "transforms": [
      {
        "input_field": "OPTIONI OF COADM1AI",
        "output_field": "WS-OPTION / OPTIONO OF COADM1AO",
        "transformation_description": "VARYING trim trailing spaces, INSPECT REPLACING ALL ' ' BY '0', move to numeric WS-OPTION and echo to output",
        "citation": [
          121,
          127
        ]
      },
      {
        "input_field": "CDEMO-ADMIN-OPT-NUM(WS-IDX) / CDEMO-ADMIN-OPT-NAME(WS-IDX)",
        "output_field": "OPTNnnnO OF COADM1AO (e.g. OPTN001O)",
        "transformation_description": "VARYING WS-IDX 1 to CDEMO-ADMIN-OPT-COUNT: STRING num '. ' name INTO WS-ADMIN-OPT-TXT, EVALUATE WS-IDX to move to specific OPTN field",
        "citation": [
          231,
          236
        ]
      },
      {
        "input_field": "FUNCTION CURRENT-DATE",
        "output_field": "CURDATEO / CURTIMEO OF COADM1AO",
        "transformation_description": "MOVE to WS-CURDATE-DATA (from CSDAT01Y), reformat components to MM-DD-YY and HH:MM:SS",
        "citation": [
          207,
          218
        ]
      },
      {
        "input_field": "CCDA-TITLE01 / CCDA-TITLE02 (from COTTL01Y)",
        "output_field": "TITLE01O / TITLE02O OF COADM1AO",
        "transformation_description": "Direct MOVE of title literals to header fields",
        "citation": [
          209
        ]
      },
      {
        "input_field": "WS-TRANID / WS-PGMNAME",
        "output_field": "TRNNAMEO / PGMNAMEO OF COADM1AO",
        "transformation_description": "Direct MOVE of static transaction/program names to header",
        "citation": [
          211
        ]
      }
    ]
  },
  "copybooks_used": [
    {
      "copybook_name": "COCOM01Y",
      "purpose": "Common variables or constants (usage not visible in source; possibly WS-VARIABLES related)",
      "location": "WORKING_STORAGE",
      "citation": 50
    },
    {
      "copybook_name": "COADM02Y",
      "purpose": "Admin menu configuration or additional structures (possibly defines CDEMO-ADMIN-OPT-* tables; usage inferred)",
      "location": "WORKING_STORAGE",
      "citation": 51
    },
    {
      "copybook_name": "COADM01",
      "purpose": "Defines BMS communication area for map COADM1A (COADM1AI/COADM1AO with fields like OPTIONI/O, OPTNnnnO, ERRMSGO/C), CARDDEMO-COMMAREA, and admin option table (CDEMO-ADMIN-OPT-COUNT/NUM/NAME/PGMNAME)",
      "location": "WORKING_STORAGE",
      "citation": 53
    },
    {
      "copybook_name": "COTTL01Y",
      "purpose": "Title literals (CCDA-TITLE01/02 used for screen headers)",
      "location": "WORKING_STORAGE",
      "citation": 55
    },
    {
      "copybook_name": "CSDAT01Y",
      "purpose": "Date/time working storage structures (WS-CURDATE-DATA and components for formatting)",
      "location": "WORKING_STORAGE",
      "citation": 56
    },
    {
      "copybook_name": "CSMSG01Y",
      "purpose": "Error message constants (CCDA-MSG-INVALID-KEY)",
      "location": "WORKING_STORAGE",
      "citation": 57
    },
    {
      "copybook_name": "CSUSR01Y",
      "purpose": "User security or profile structures (WS-USRSEC-FILE suggests usage; not directly visible)",
      "location": "WORKING_STORAGE",
      "citation": 58
    },
    {
      "copybook_name": "DFHAID",
      "purpose": "Standard CICS AID constants (DFHENTER, DFHPF3 for EIBAID evaluation)",
      "location": "WORKING_STORAGE",
      "citation": 60
    },
    {
      "copybook_name": "DFHBMSCA",
      "purpose": "Standard CICS BMS attribute constants (DFHGREEN for error message color)",
      "location": "WORKING_STORAGE",
      "citation": 61
    }
  ],
  "paragraphs": [
    {
      "paragraph_name": "MAIN-PARA",
      "purpose": "Main control: handle condition, clear errors, branch on EIBCALEN=0 or reenter, receive map, evaluate AID (ENTER/PF3/OTHER)",
      "called_by": [],
      "calls": [
        "RETURN-TO-SIGNON-SCREEN",
        "SEND-MENU-SCREEN",
        "RECEIVE-MENU-SCREEN",
        "PROCESS-ENTER-KEY"
      ],
      "citation": [
        75,
        113
      ]
    },
    {
      "paragraph_name": "PROCESS-ENTER-KEY",
      "purpose": "Parse/validate option input, XCTL if valid/non-DUMMY or error/redisplay",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [
        "SEND-MENU-SCREEN"
      ],
      "citation": [
        119,
        158
      ]
    },
    {
      "paragraph_name": "RETURN-TO-SIGNON-SCREEN",
      "purpose": "Default/set CDEMO-TO-PROGRAM to COSGN00C and XCTL",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [],
      "citation": [
        163,
        170
      ]
    },
    {
      "paragraph_name": "SEND-MENU-SCREEN",
      "purpose": "Build/populate map output and EXEC CICS SEND MAP ERASE",
      "called_by": [
        "MAIN-PARA",
        "PROCESS-ENTER-KEY",
        "PGMIDERR-ERR-PARA"
      ],
      "calls": [
        "POPULATE-HEADER-INFO",
        "BUILD-MENU-OPTIONS"
      ],
      "citation": [
        175,
        187
      ]
    },
    {
      "paragraph_name": "RECEIVE-MENU-SCREEN",
      "purpose": "EXEC CICS RECEIVE MAP INTO COADM1AI with RESP codes",
      "called_by": [
        "MAIN-PARA"
      ],
      "calls": [],
      "citation": [
        192,
        200
      ]
    },
    {
      "paragraph_name": "POPULATE-HEADER-INFO",
      "purpose": "Format current date/time, move titles/tran/pgm to header output fields",
      "called_by": [
        "SEND-MENU-SCREEN"
      ],
      "calls": [],
      "citation": [
        205,
        224
      ]
    },
    {
      "paragraph_name": "BUILD-MENU-OPTIONS",
      "purpose": "VARYING loop to STRING and EVALUATE move admin opt table to OPTNnnnO fields",
      "called_by": [
        "SEND-MENU-SCREEN"
      ],
      "calls": [],
      "citation": [
        229,
        266
      ]
    },
    {
      "paragraph_name": "PGMIDERR-ERR-PARA",
      "purpose": "Handle XCTL PGMIDERR: set 'not installed' message, send screen, RETURN",
      "called_by": [],
      "calls": [
        "SEND-MENU-SCREEN"
      ],
      "citation": [
        270,
        283
      ]
    }
  ],
  "error_handling": [
    {
      "condition": "PGMIDERR (XCTL target program not found)",
      "action": "Invoke PGMIDERR-ERR-PARA: message 'This option is not installed', send menu, RETURN to loop",
      "citation": [
        78,
        270
      ]
    },
    {
      "condition": "Invalid AID key (not ENTER/PF3)",
      "action": "WS-ERR-FLG='Y', WS-MESSAGE=CCDA-MSG-INVALID-KEY, SEND-MENU-SCREEN",
      "citation": [
        103
      ]
    },
    {
      "condition": "Invalid menu option (non-numeric/zero/out-of-range)",
      "action": "WS-ERR-FLG='Y', WS-MESSAGE='Please enter a valid option number...', SEND-MENU-SCREEN",
      "citation": [
        134
      ]
    }
  ],
  "sql_operations": [],
  "cics_operations": [
    {
      "command": "HANDLE CONDITION",
      "resource": "PGMIDERR(PGMIDERR-ERR-PARA)",
      "purpose": "Catch XCTL program-id errors and handle gracefully",
      "citation": 78
    },
    {
      "command": "SEND",
      "resource": "MAP('COADM1A') MAPSET('COADM01') FROM(COADM1AO) ERASE",
      "purpose": "Erase and display populated admin menu to user",
      "citation": 182
    },
    {
      "command": "RECEIVE",
      "resource": "MAP('COADM1A') MAPSET('COADM01') INTO(COADM1AI) RESP(WS-RESP-CD) RESP2(WS-REAS-CD)",
      "purpose": "Receive user map input with response codes",
      "citation": 194
    },
    {
      "command": "XCTL PROGRAM",
      "resource": "CDEMO-ADMIN-OPT-PGMNAME(WS-OPTION) COMMAREA(CARDDEMO-COMMAREA)",
      "purpose": "No-return transfer to selected admin program",
      "citation": 146
    },
    {
      "command": "XCTL PROGRAM",
      "resource": "CDEMO-TO-PROGRAM COMMAREA(CARDDEMO-COMMAREA)",
      "purpose": "No-return transfer to signon/exit program",
      "citation": 169
    },
    {
      "command": "RETURN",
      "resource": "TRANSID(WS-TRANID='CA00') COMMAREA(CARDDEMO-COMMAREA)",
      "purpose": "End pseudoconversational cycle, schedule next CA00 invocation",
      "citation": 111
    }
  ],
  "open_questions": [
    {
      "question": "Exact values/content of CDEMO-ADMIN-OPT-COUNT, -NUM(*), -NAME(*), -PGMNAME(*)",
      "context": "Defined in copybook COADM01; determines displayed options and XCTL targets (some marked 'DUMMY')",
      "suggestion": "Expand/analyze copybook COADM01"
    },
    {
      "question": "Full field layouts of CARDDEMO-COMMAREA, COADM1AI, COADM1AO",
      "context": "Defined in COADM01; critical for data flow but details absent",
      "suggestion": "Expand/analyze copybook COADM01"
    },
    {
      "question": "Purpose/usage of COCOM01Y, COADM02Y, CSUSR01Y",
      "context": "Copied but no direct field references visible in source",
      "suggestion": "Expand copybooks and check for indirect usage"
    },
    {
      "question": "Programs/transactions that invoke CA00 or set initial CDEMO-TO-PROGRAM",
      "context": "Not evident from this source alone",
      "suggestion": "Review CICS transaction definitions or caller programs like COSGN00C"
    }
  ]
}