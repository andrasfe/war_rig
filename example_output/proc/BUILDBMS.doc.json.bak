{
  "header": {
    "program_id": "BUILDBMS",
    "file_name": "proc/BUILDBMS.prc",
    "file_type": "PROC",
    "analyzed_by": "WAR_RIG",
    "analyzed_at": "2026-01-24T18:30:15.086912",
    "iteration_count": 5,
    "final_status": null
  },
  "purpose": {
    "summary": "This JCL procedure (PROC) compiles a specified BMS map into a load module and generates a corresponding DSECT copybook. It performs sequential steps: PRINT copies the BMS source to a temporary dataset; MAP assembles it into a punch deck; LKED link-edits the deck into the load library; DSECT assembles for DSECT and punches to copybook dataset; DISPLIST routes the listing to SYSOUT; DELTEMP cleans up the temporary dataset.",
    "business_context": "Build procedure for compiling BMS maps in the CARDDEMO CICS demonstration application, producing load modules for LOADLIB and DSECT copybooks for CPY datasets to support CICS map processing in demo programs.",
    "program_type": "BATCH",
    "citations": [
      2,
      23,
      25,
      26,
      27,
      28,
      29,
      32,
      36,
      49,
      68,
      78,
      96,
      103
    ]
  },
  "inputs": [
    {
      "name": "MAPNAME",
      "io_type": "PARAMETER",
      "description": "Symbolic parameter specifying the BMS map member name to compile.",
      "copybook": null,
      "citation": [
        23
      ]
    },
    {
      "name": "HLQ",
      "io_type": "PARAMETER",
      "description": "High-level qualifier for dataset names used in the procedure.",
      "copybook": null,
      "citation": [
        24
      ]
    },
    {
      "name": "SRCCODE",
      "io_type": "PARAMETER",
      "description": "Dataset containing BMS source members.",
      "copybook": null,
      "citation": [
        25
      ]
    },
    {
      "name": "LOADLIB",
      "io_type": "PARAMETER",
      "description": "Load library dataset qualifying the target for the compiled map module.",
      "copybook": null,
      "citation": [
        26
      ]
    },
    {
      "name": "CPYBKS",
      "io_type": "PARAMETER",
      "description": "Copybook dataset qualifying the target for the generated DSECT member.",
      "copybook": null,
      "citation": [
        27
      ]
    },
    {
      "name": "CICSMAC",
      "io_type": "PARAMETER",
      "description": "CICS macro library (SDFHMAC) for BMS assembly.",
      "copybook": null,
      "citation": [
        28
      ]
    },
    {
      "name": "LISTING",
      "io_type": "PARAMETER",
      "description": "Dataset qualifying the assembly listing member.",
      "copybook": null,
      "citation": [
        29
      ]
    },
    {
      "name": "&SRCCODE(&MAPNAME)",
      "io_type": "FILE_SEQUENTIAL",
      "description": "BMS map source code member read in PRINT step SYSUT1, DISP=SHR.",
      "copybook": null,
      "citation": [
        42,
        43
      ]
    },
    {
      "name": "&CICSMAC",
      "io_type": "FILE_SEQUENTIAL",
      "description": "CICS SDFHMAC macro library used in SYSLIB for MAP and DSECT assembly steps, DISP=SHR.",
      "copybook": null,
      "citation": [
        28,
        52,
        82
      ]
    },
    {
      "name": "SYS1.MACLIB",
      "io_type": "FILE_SEQUENTIAL",
      "description": "System macro library concatenated in SYSLIB for assembly steps, DISP=SHR.",
      "copybook": null,
      "citation": [
        53,
        83
      ]
    },
    {
      "name": "CEE.SCEEMAC",
      "io_type": "FILE_SEQUENTIAL",
      "description": "CEE macro library concatenated in SYSLIB for assembly steps, DISP=SHR.",
      "copybook": null,
      "citation": [
        54,
        84
      ]
    },
    {
      "name": "&&TEMPM",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Temporary dataset read in MAP, DSECT (SYSIN DISP=(OLD,PASS)), and DELTEMP steps.",
      "copybook": null,
      "citation": [
        61,
        91,
        104
      ]
    },
    {
      "name": "&&MAP",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Temporary MAP deck read in LKED step SYSLIN, DISP=(OLD,DELETE).",
      "copybook": null,
      "citation": [
        72
      ]
    },
    {
      "name": "&LISTING(&MAPNAME)",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Assembly listing dataset read in DSECT SYSPRINT (DISP=SHR) and DISPLIST SYSUT1 (DISP=SHR).",
      "copybook": null,
      "citation": [
        81,
        98
      ]
    }
  ],
  "outputs": [
    {
      "name": "&&TEMPM",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Temporary dataset written by PRINT step SYSUT2, UNIT=3390, DISP=(,PASS), DCB=(RECFM=FB,LRECL=80,BLKSIZE=400), SPACE=(400,(50,50)), passed to subsequent steps.",
      "copybook": null,
      "citation": [
        38,
        39,
        40
      ]
    },
    {
      "name": "&&MAP",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Assembled MAP deck punched by MAP step SYSPUNCH, UNIT=3390, DISP=(,PASS), DCB=(RECFM=FB,LRECL=80,BLKSIZE=400), SPACE=(400,(50,50)), passed to LKED.",
      "copybook": null,
      "citation": [
        58,
        59,
        60
      ]
    },
    {
      "name": "&LOADLIB(&MAPNAME)",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Link-edited BMS map load module written by LKED step SYSLMOD, DISP=SHR.",
      "copybook": null,
      "citation": [
        70
      ]
    },
    {
      "name": "&CPYBKS(&MAPNAME)",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Generated DSECT copybook member punched by DSECT step SYSPUNCH, DISP=OLD, DCB=(RECFM=FB,LRECL=80,BLKSIZE=400), SPACE=(400,(50,50)), UNIT=3390.",
      "copybook": null,
      "citation": [
        88,
        89,
        90
      ]
    },
    {
      "name": "&LISTING(&MAPNAME)",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Assembly listing written by DSECT step SYSPRINT, DISP=SHR.",
      "copybook": null,
      "citation": [
        81
      ]
    }
  ],
  "called_programs": [
    {
      "program_name": "IEBGENER",
      "call_type": "STATIC_CALL",
      "purpose": "Copies BMS map source to temporary dataset for subsequent assembly steps.",
      "parameters": [],
      "citation": 36
    },
    {
      "program_name": "ASMA90",
      "call_type": "STATIC_CALL",
      "purpose": "Assembles BMS map source into MAP punch deck using CICS macros.",
      "parameters": [
        "SYSPARM(MAP),DECK,NOLOAD"
      ],
      "citation": 49
    },
    {
      "program_name": "HEWL",
      "call_type": "STATIC_CALL",
      "purpose": "Link-edits the assembled MAP deck into a load module in the target LOADLIB.",
      "parameters": [
        "LIST,LET,XREF"
      ],
      "citation": 68
    },
    {
      "program_name": "ASMA90",
      "call_type": "STATIC_CALL",
      "purpose": "Assembles BMS map source into DSECT for copybook generation using CICS macros.",
      "parameters": [
        "SYSPARM(DSECT),DECK,NOLOAD"
      ],
      "citation": 78
    },
    {
      "program_name": "IEBGENER",
      "call_type": "STATIC_CALL",
      "purpose": "Copies assembly listing dataset to SYSOUT for display.",
      "parameters": [],
      "citation": 96
    },
    {
      "program_name": "IEFBR14",
      "call_type": "STATIC_CALL",
      "purpose": "Deletes the remaining temporary dataset after processing.",
      "parameters": [],
      "citation": 103
    }
  ],
  "calling_context": {
    "called_by": [],
    "entry_points": [],
    "linkage_section": []
  },
  "business_rules": [
    {
      "rule_id": "BR001",
      "description": "Overwrites existing DSECT copybook member if present.",
      "logic_summary": "DSECT SYSPUNCH DD specifies DISP=OLD.",
      "conditions": [],
      "citation": [
        88
      ]
    },
    {
      "rule_id": "BR002",
      "description": "Deletes temporary datasets after use.",
      "logic_summary": "MAP SYSPUNCH DISP=(,PASS), LKED SYSLIN DISP=(OLD,DELETE), DELTEMP DISP=(OLD,DELETE).",
      "conditions": [],
      "citation": [
        58,
        72,
        104
      ]
    }
  ],
  "data_flow": {
    "reads_from": [
      {
        "source": "&SRCCODE(&MAPNAME)",
        "fields_used": [
          "BMS map source code"
        ],
        "citation": [
          42
        ]
      },
      {
        "source": "&&TEMPM",
        "fields_used": [
          "copied BMS source"
        ],
        "citation": [
          61,
          91
        ]
      },
      {
        "source": "&&MAP",
        "fields_used": [
          "assembled MAP deck"
        ],
        "citation": [
          72
        ]
      },
      {
        "source": "&CICSMAC",
        "fields_used": [
          "SDFHMAC macros"
        ],
        "citation": [
          52,
          82
        ]
      },
      {
        "source": "SYS1.MACLIB",
        "fields_used": [
          "system macros"
        ],
        "citation": [
          53,
          83
        ]
      },
      {
        "source": "CEE.SCEEMAC",
        "fields_used": [
          "CEE macros"
        ],
        "citation": [
          54,
          84
        ]
      },
      {
        "source": "&LISTING(&MAPNAME)",
        "fields_used": [
          "assembly listing"
        ],
        "citation": [
          98
        ]
      }
    ],
    "writes_to": [
      {
        "destination": "&&TEMPM",
        "fields_written": [
          "copied BMS source"
        ],
        "citation": [
          38
        ]
      },
      {
        "destination": "&&MAP",
        "fields_written": [
          "MAP punch deck"
        ],
        "citation": [
          58
        ]
      },
      {
        "destination": "&LOADLIB(&MAPNAME)",
        "fields_written": [
          "compiled BMS map load module"
        ],
        "citation": [
          70
        ]
      },
      {
        "destination": "&CPYBKS(&MAPNAME)",
        "fields_written": [
          "DSECT copybook"
        ],
        "citation": [
          88
        ]
      },
      {
        "destination": "&LISTING(&MAPNAME)",
        "fields_written": [
          "assembly listing"
        ],
        "citation": [
          81
        ]
      }
    ],
    "transforms": [
      {
        "input_field": "BMS source from &SRCCODE(&MAPNAME)",
        "output_field": "MAP load module in &LOADLIB(&MAPNAME)",
        "transformation_description": "PRINT copies source to &&TEMPM; MAP assembles &&TEMPM to punch &&MAP deck; LKED link-edits &&MAP to load module. Traces complete flow from BMS source input to compiled load module output.",
        "citation": [
          36,
          49,
          68
        ]
      },
      {
        "input_field": "BMS source from &&TEMPM",
        "output_field": "DSECT copybook in &CPYBKS(&MAPNAME)",
        "transformation_description": "DSECT assembles &&TEMPM with SYSPARM(DSECT) and punches to copybook dataset. Parallel flow from same source input to DSECT output.",
        "citation": [
          78
        ]
      },
      {
        "input_field": "assembly listing in &LISTING(&MAPNAME)",
        "output_field": "SYSOUT listing",
        "transformation_description": "DISPLIST copies listing dataset to SYSOUT. Traces listing generation from DSECT step to console output.",
        "citation": [
          96
        ]
      }
    ]
  },
  "copybooks_used": [],
  "paragraphs": [
    {
      "paragraph_name": "PRINT",
      "purpose": "EXEC PGM=IEBGENER (line 36) copies BMS source from &SRCCODE(&MAPNAME) SYSUT1 (DSN=&SRCCODE(&MAPNAME), DISP=SHR lines 42-43) to temporary dataset &&TEMPM SYSUT2 (UNIT=3390 line 38, DISP=(,PASS) line 38, DCB=(RECFM=FB,LRECL=80,BLKSIZE=400) lines 39, SPACE=(400,(50,50)) line 40); SYSIN DUMMY line 41; SYSPRINT SYSOUT=* line 37. First step in BMS compile job flow.",
      "called_by": [],
      "calls": [
        "MAP"
      ],
      "citation": [
        36,
        43
      ]
    },
    {
      "paragraph_name": "MAP",
      "purpose": "EXEC PGM=ASMA90,PARM='SYSPARM(MAP),DECK,NOLOAD' line 49 assembles BMS source from &&TEMPM SYSIN (DISP=(OLD,PASS) line 61) using SYSLIB=&CICSMAC (DISP=SHR line 52), SYS1.MACLIB (DISP=SHR line 53), CEE.SCEEMAC (DISP=SHR line 54); punches assembled deck to &&MAP SYSPUNCH (UNIT=3390 line 58, DISP=(,PASS) line 58, DCB=(RECFM=FB,LRECL=80,BLKSIZE=400) lines 59, SPACE=(400,(50,50)) line 60); SYSLIN DUMMY line 62; SYSPRINT SYSOUT=* line 50; SYSUT1/2/3 temporary space lines 55-57.",
      "called_by": [
        "PRINT"
      ],
      "calls": [
        "LKED"
      ],
      "citation": [
        49,
        62
      ]
    },
    {
      "paragraph_name": "LKED",
      "purpose": "EXEC PGM=HEWL,PARM='LIST,LET,XREF' line 68 link-edits MAP deck from &&MAP SYSLIN (DISP=(OLD,DELETE) line 72) into load module &LOADLIB(&MAPNAME) SYSLMOD (DISP=SHR line 70); SYSUT1 temporary space line 71 (UNIT=3390,SPACE=(1024,(20,20))); SYSPRINT SYSOUT=* line 69.",
      "called_by": [
        "MAP"
      ],
      "calls": [
        "DSECT"
      ],
      "citation": [
        68,
        72
      ]
    },
    {
      "paragraph_name": "DSECT",
      "purpose": "EXEC PGM=ASMA90,PARM='SYSPARM(DSECT),DECK,NOLOAD' line 78 assembles BMS source from &&TEMPM SYSIN (DISP=(OLD,PASS) line 91) using SYSLIB=&CICSMAC (DISP=SHR line 82), SYS1.MACLIB (DISP=SHR line 83), CEE.SCEEMAC (DISP=SHR line 84) for DSECT generation; writes SYSPRINT to &LISTING(&MAPNAME) (DISP=SHR line 81); punches to &CPYBKS(&MAPNAME) SYSPUNCH (DISP=OLD line 88, DCB=(RECFM=FB,LRECL=80,BLKSIZE=400) line 89, SPACE=(400,(50,50)) line 90, UNIT=3390 line 90); SYSLIN DUMMY line 92; SYSUT1/2/3 temporary space lines 85-87.",
      "called_by": [
        "LKED"
      ],
      "calls": [
        "DISPLIST"
      ],
      "citation": [
        78,
        92
      ]
    },
    {
      "paragraph_name": "DISPLIST",
      "purpose": "EXEC PGM=IEBGENER,REGION=0M line 96 copies assembly listing from &LISTING(&MAPNAME) SYSUT1 (DSN=&LISTING(&MAPNAME), DISP=SHR line 98) to SYSOUT=* SYSUT2 line 99; SYSPRINT SYSOUT=* lines 97,100; SYSIN DUMMY line 101. Routes listing to console output.",
      "called_by": [
        "DSECT"
      ],
      "calls": [
        "DELTEMP"
      ],
      "citation": [
        96,
        101
      ]
    },
    {
      "paragraph_name": "DELTEMP",
      "purpose": "EXEC PGM=IEFBR14 line 103 deletes remaining temporary dataset &&TEMPM TEMPM DD (DSN=&&TEMPM, DISP=(OLD,DELETE) line 104). Final cleanup step in sequential job flow.",
      "called_by": [
        "DISPLIST"
      ],
      "calls": [],
      "citation": [
        103,
        104
      ]
    }
  ],
  "error_handling": [],
  "sql_operations": [],
  "cics_operations": [],
  "open_questions": [
    {
      "question": "Details of CARDDEMO application",
      "context": "Dataset qualifiers reference CARDDEMO but no further code provided.",
      "suggestion": "Analyze other CARDDEMO.* datasets or programs."
    },
    {
      "question": "JCL jobs that invoke this PROC",
      "context": "No information on which JCL EXEC statements call BUILDBMS PROC.",
      "suggestion": "Search for JCL files containing '// EXEC PROC=BUILDBMS' or similar."
    },
    {
      "question": "No COPY statements present",
      "context": "JCL PROC contains no COPY statements; copybooks_used remains empty. Addresses Chrome ticket CHR-m-000322 as no COPY statements exist to document.",
      "suggestion": "Confirmed no COPY usage in source code (lines 1-106)."
    }
  ]
}