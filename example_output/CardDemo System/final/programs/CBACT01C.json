{
  "header": {
    "program_id": "CBACT01C",
    "file_name": "CBACT01C.cbl",
    "file_type": "COBOL",
    "analyzed_by": "WAR_RIG",
    "analyzed_at": "2026-01-18T17:46:49.089641",
    "iteration_count": 2,
    "final_status": "VALHALLA"
  },
  "purpose": {
    "summary": "Batch COBOL program reads sequential records from indexed VSAM ACCTFILE-FILE containing account data (from CVACT01Y), displays each record fields, transforms data by formatting reissue date via COBDATFT call (type '2'), overriding zero ACCT-CURR-CYC-DEBIT to 2525.00, populating ARRY-FILE with hardcoded balance/debit values for some array elements, generating two variable-length records per account for VBRC-FILE (12-byte ID+status and 39-byte ID+bal+limit+YYYY), and writing to three sequential output files until EOF on input.",
    "business_context": "CardDemo application account file processing, transformation, and export to multiple formats",
    "program_type": "BATCH",
    "citations": [
      2,
      3,
      4,
      5,
      141,
      147,
      166,
      236,
      231,
      255,
      288,
      303
    ]
  },
  "inputs": [
    {
      "name": "ACCTFILE-FILE",
      "io_type": "FILE_VSAM",
      "description": "Indexed VSAM file (ORGANIZATION INDEXED, ACCESS SEQUENTIAL, KEY FD-ACCT-ID) of account records read into ACCOUNT-RECORD from CVACT01Y",
      "copybook": "CVACT01Y",
      "citation": [
        29,
        30,
        31,
        32,
        166
      ]
    },
    {
      "name": "CODATECN-REC",
      "io_type": "PARAMETER",
      "description": "Date conversion fields from CODATECN copybook used for input/output date formatting via COBDATFT",
      "copybook": "CODATECN",
      "citation": [
        90,
        223,
        231
      ]
    }
  ],
  "outputs": [
    {
      "name": "OUT-FILE",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Sequential fixed-length account records (OUT-ACCT-REC inline FD lines 57-70) with transformed reissue date and conditional debit override",
      "copybook": "OUT-ACCT-REC (inline FD)",
      "citation": [
        243
      ]
    },
    {
      "name": "ARRY-FILE",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Sequential array records (ARR-ARRAY-REC inline FD lines 72-78) with account ID and 5 repeating balance/debit groups, some hardcoded",
      "copybook": "ARR-ARRAY-REC (inline FD)",
      "citation": [
        264
      ]
    },
    {
      "name": "VBRC-FILE",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Variable-length sequential records (VBR-REC inline FD lines 81-85, varying 10-80 via WS-RECD-LEN) with two types per account: short VB1 (12 bytes) and long VB2 (39 bytes)",
      "copybook": "VBR-REC (inline FD)",
      "citation": [
        290,
        305
      ]
    },
    {
      "name": "SYSPRINT",
      "io_type": "REPORT",
      "description": "Console output displaying execution start/end, account details per record, I/O error statuses",
      "copybook": null,
      "citation": [
        141,
        151,
        201,
        283,
        407,
        413
      ]
    }
  ],
  "called_programs": [
    {
      "program_name": "COBDATFT",
      "call_type": "STATIC_CALL",
      "purpose": "Assembler routine to format CODATECN-INP-DATE to CODATECN-OUT-DATE for account reissue date",
      "parameters": [
        "CODATECN-REC"
      ],
      "citation": 231
    },
    {
      "program_name": "CEE3ABD",
      "call_type": "STATIC_CALL",
      "purpose": "Abend the program with custom return code ABCODE on I/O errors",
      "parameters": [
        "ABCODE",
        "TIMING"
      ],
      "citation": 410
    }
  ],
  "calling_context": {
    "called_by": [],
    "entry_points": [],
    "linkage_section": []
  },
  "business_rules": [
    {
      "rule_id": "BR001",
      "description": "Override current cycle debit to 2525.00 if input is zero",
      "logic_summary": "IF ACCT-CURR-CYC-DEBIT EQUAL TO ZERO MOVE 2525.00 TO OUT-ACCT-CURR-CYC-DEBIT",
      "conditions": [
        "IF ACCT-CURR-CYC-DEBIT EQUAL TO ZERO"
      ],
      "citation": [
        236,
        237
      ]
    },
    {
      "rule_id": "BR002",
      "description": "Format reissue date using COBDATFT before writing to OUT-FILE",
      "logic_summary": "MOVE ACCT-REISSUE-DATE TO CODATECN-INP-DATE WS-REISSUE-DATE, set CODATECN-TYPE/OUTTYPE '2', CALL COBDATFT, MOVE CODATECN-OUT-DATE TO OUT-ACCT-REISSUE-DATE",
      "conditions": [
        "Always during populate"
      ],
      "citation": [
        223,
        224,
        225,
        226,
        231,
        233
      ]
    },
    {
      "rule_id": "BR003",
      "description": "Populate ARRY-FILE array with hardcoded values for balances/debits in elements 1-3",
      "logic_summary": "Copy ACCT-CURR-BAL to (1) and (2), hardcode CURR-CYC-DEBIT(1)=1005.00, (2)=1525.00; CURR-BAL(3)=-1025.00, DEBIT(3)=-2500.00",
      "conditions": [
        "Always during populate"
      ],
      "citation": [
        255,
        256,
        257,
        258,
        259,
        260
      ]
    },
    {
      "rule_id": "BR004",
      "description": "Generate two variable records per account for VBRC-FILE: VB1 (ID+status, len=12), VB2 (ID+bal+limit+reissue YYYY, len=39)",
      "logic_summary": "Populate VBRC-REC1/REC2 from account fields including WS-ACCT-REISSUE-YYYY, set WS-RECD-LEN, MOVE substring to VBR-REC(1:len), WRITE",
      "conditions": [
        "Always during process"
      ],
      "citation": [
        276,
        282,
        288,
        303
      ]
    },
    {
      "rule_id": "BR005",
      "description": "Detect end-of-file on ACCTFILE and stop processing loop",
      "logic_summary": "If READ status='10' set APPL-EOF (16), then if APPL-EOF MOVE 'Y' TO END-OF-FILE to exit UNTIL loop",
      "conditions": [
        "IF ACCTFILE-STATUS = '10'"
      ],
      "citation": [
        180,
        190
      ]
    },
    {
      "rule_id": "BR006",
      "description": "Display all account record fields to SYSPRINT for each processed record",
      "logic_summary": "DISPLAY each field (ID, status, balances, dates, etc.) with labels in 1100-DISPLAY-ACCT-RECORD",
      "conditions": [
        "After successful READ"
      ],
      "citation": [
        170,
        200,
        212
      ]
    }
  ],
  "data_flow": {
    "reads_from": [
      {
        "source": "ACCTFILE-FILE",
        "fields_used": [
          "ACCT-ID",
          "ACCT-ACTIVE-STATUS",
          "ACCT-CURR-BAL",
          "ACCT-CREDIT-LIMIT",
          "ACCT-CASH-CREDIT-LIMIT",
          "ACCT-OPEN-DATE",
          "ACCT-EXPIRAION-DATE",
          "ACCT-REISSUE-DATE",
          "ACCT-CURR-CYC-CREDIT",
          "ACCT-CURR-CYC-DEBIT",
          "ACCT-GROUP-ID"
        ],
        "citation": [
          166,
          201,
          216
        ]
      }
    ],
    "writes_to": [
      {
        "destination": "OUT-FILE",
        "fields_written": [
          "OUT-ACCT-ID",
          "OUT-ACCT-ACTIVE-STATUS",
          "OUT-ACCT-CURR-BAL",
          "OUT-ACCT-CREDIT-LIMIT",
          "OUT-ACCT-CASH-CREDIT-LIMIT",
          "OUT-ACCT-OPEN-DATE",
          "OUT-ACCT-EXPIRAION-DATE",
          "OUT-ACCT-REISSUE-DATE",
          "OUT-ACCT-CURR-CYC-CREDIT",
          "OUT-ACCT-CURR-CYC-DEBIT",
          "OUT-ACCT-GROUP-ID"
        ],
        "citation": [
          243
        ]
      },
      {
        "destination": "ARRY-FILE",
        "fields_written": [
          "ARR-ACCT-ID",
          "ARR-ACCT-CURR-BAL (1-3)",
          "ARR-ACCT-CURR-CYC-DEBIT (1-3)"
        ],
        "citation": [
          264
        ]
      },
      {
        "destination": "VBRC-FILE",
        "fields_written": [
          "VB1-ACCT-ID",
          "VB1-ACCT-ACTIVE-STATUS",
          "VB2-ACCT-ID",
          "VB2-ACCT-CURR-BAL",
          "VB2-ACCT-CREDIT-LIMIT",
          "VB2-ACCT-REISSUE-YYYY"
        ],
        "citation": [
          290,
          305
        ]
      },
      {
        "destination": "SYSPRINT",
        "fields_written": [
          "ACCT-ID",
          "ACCT-ACTIVE-STATUS",
          "ACCT-CURR-BAL",
          "ACCT-CREDIT-LIMIT",
          "ACCT-CASH-CREDIT-LIMIT",
          "ACCT-OPEN-DATE",
          "ACCT-EXPIRAION-DATE",
          "ACCT-REISSUE-DATE",
          "ACCT-CURR-CYC-CREDIT",
          "ACCT-CURR-CYC-DEBIT",
          "ACCT-GROUP-ID",
          "VBRC-REC1",
          "VBRC-REC2"
        ],
        "citation": [
          141,
          151,
          201,
          283
        ]
      }
    ],
    "transforms": [
      {
        "input_field": "ACCT-REISSUE-DATE",
        "output_field": "OUT-ACCT-REISSUE-DATE",
        "transformation_description": "Passed through CODATECN-INP-DATE and COBDATFT (type '2') to CODATECN-OUT-DATE",
        "citation": [
          223,
          231,
          233
        ]
      },
      {
        "input_field": "ACCT-CURR-CYC-DEBIT",
        "output_field": "OUT-ACCT-CURR-CYC-DEBIT",
        "transformation_description": "Direct copy unless zero, then overridden to 2525.00",
        "citation": [
          235,
          236,
          237
        ]
      },
      {
        "input_field": "ACCT-CURR-BAL",
        "output_field": "ARR-ACCT-CURR-BAL(1)",
        "transformation_description": "Direct copy to array index 1 (similarly index 2)",
        "citation": [
          255
        ]
      },
      {
        "input_field": "WS-ACCT-REISSUE-YYYY",
        "output_field": "VB2-ACCT-REISSUE-YYYY",
        "transformation_description": "Extracted YYYY portion after date formatting for VB2 record",
        "citation": [
          282
        ]
      }
    ]
  },
  "copybooks_used": [
    {
      "copybook_name": "CVACT01Y",
      "purpose": "Defines input ACCOUNT-RECORD structure with account fields (ACCT-ID etc.)",
      "location": "WORKING_STORAGE",
      "citation": 89
    },
    {
      "copybook_name": "CODATECN",
      "purpose": "Defines CODATECN-REC fields for date input/output and types used by COBDATFT",
      "location": "WORKING_STORAGE",
      "citation": 90
    },
    {
      "copybook_name": "OUT-ACCT-REC",
      "purpose": "Inline FD defines fixed sequential output record structure for OUT-FILE",
      "location": "FILE_SECTION",
      "citation": 57
    },
    {
      "copybook_name": "ARR-ARRAY-REC",
      "purpose": "Inline FD defines array output record with OCCURS 5 for ARRY-FILE",
      "location": "FILE_SECTION",
      "citation": 72
    },
    {
      "copybook_name": "VBR-REC",
      "purpose": "Inline FD defines variable-length PIC X(80) record for VBRC-FILE with RECD-LEN",
      "location": "FILE_SECTION",
      "citation": 85
    }
  ],
  "paragraphs": [
    {
      "paragraph_name": "1000-ACCTFILE-GET-NEXT",
      "purpose": "Core loop logic: READ input, check status/EOF, chain performs to display/populate/write all outputs or error/abend",
      "called_by": [],
      "calls": [
        "1100-DISPLAY-ACCT-RECORD",
        "1300-POPUL-ACCT-RECORD",
        "1350-WRITE-ACCT-RECORD",
        "1400-POPUL-ARRAY-RECORD",
        "1450-WRITE-ARRY-RECORD",
        "1500-POPUL-VBRC-RECORD",
        "1550-WRITE-VB1-RECORD",
        "1575-WRITE-VB2-RECORD",
        "9910-DISPLAY-IO-STATUS",
        "9999-ABEND-PROGRAM"
      ],
      "citation": [
        165,
        197
      ]
    },
    {
      "paragraph_name": "0000-ACCTFILE-OPEN",
      "purpose": "Open input ACCTFILE-FILE for sequential read, abend on error",
      "called_by": [],
      "calls": [
        "9910-DISPLAY-IO-STATUS",
        "9999-ABEND-PROGRAM"
      ],
      "citation": [
        317,
        332
      ]
    },
    {
      "paragraph_name": "2000-OUTFILE-OPEN",
      "purpose": "Open output OUT-FILE, abend on error",
      "called_by": [],
      "calls": [
        "9910-DISPLAY-IO-STATUS",
        "9999-ABEND-PROGRAM"
      ],
      "citation": [
        334,
        349
      ]
    },
    {
      "paragraph_name": "3000-ARRFILE-OPEN",
      "purpose": "Open output ARRY-FILE, abend on error",
      "called_by": [],
      "calls": [
        "9910-DISPLAY-IO-STATUS",
        "9999-ABEND-PROGRAM"
      ],
      "citation": [
        352,
        367
      ]
    },
    {
      "paragraph_name": "4000-VBRFILE-OPEN",
      "purpose": "Open output VBRC-FILE, abend on error",
      "called_by": [],
      "calls": [
        "9910-DISPLAY-IO-STATUS",
        "9999-ABEND-PROGRAM"
      ],
      "citation": [
        370,
        385
      ]
    },
    {
      "paragraph_name": "9000-ACCTFILE-CLOSE",
      "purpose": "Close input ACCTFILE-FILE, abend on error",
      "called_by": [],
      "calls": [
        "9910-DISPLAY-IO-STATUS",
        "9999-ABEND-PROGRAM"
      ],
      "citation": [
        388,
        403
      ]
    },
    {
      "paragraph_name": "9999-ABEND-PROGRAM",
      "purpose": "Terminate program via CEE3ABD call with abend code",
      "called_by": [],
      "calls": [],
      "citation": [
        406,
        412
      ]
    },
    {
      "paragraph_name": "9910-DISPLAY-IO-STATUS",
      "purpose": "Format and display file status code as numeric NNNN",
      "called_by": [],
      "calls": [],
      "citation": [
        413,
        425
      ]
    },
    {
      "paragraph_name": "1100-DISPLAY-ACCT-RECORD",
      "purpose": "Display all fields of current ACCOUNT-RECORD with labels",
      "called_by": [],
      "calls": [],
      "citation": [
        200,
        212
      ]
    }
  ],
  "error_handling": [
    {
      "condition": "ACCTFILE-STATUS NOT = '00' or '10' after READ",
      "action": "DISPLAY error, PERFORM 9910-DISPLAY-IO-STATUS then 9999-ABEND-PROGRAM",
      "citation": [
        192,
        194,
        195
      ]
    },
    {
      "condition": "OUTFILE-STATUS / ARRYFILE-STATUS / VBRCFILE-STATUS NOT = '00' AND NOT = '10' after WRITE",
      "action": "DISPLAY status, PERFORM 9910-DISPLAY-IO-STATUS then 9999-ABEND-PROGRAM",
      "citation": [
        245,
        248,
        249,
        266,
        271,
        272,
        292,
        297,
        298,
        307,
        312,
        313
      ]
    },
    {
      "condition": "File status NOT = '00' after OPEN / CLOSE",
      "action": "DISPLAY error message with status, PERFORM 9910-DISPLAY-IO-STATUS then 9999-ABEND-PROGRAM",
      "citation": [
        328,
        330,
        331,
        345,
        347,
        348,
        363,
        365,
        366,
        381,
        383,
        384,
        399,
        401,
        402
      ]
    }
  ],
  "sql_operations": [],
  "cics_operations": [],
  "open_questions": [
    {
      "question": "Exact field layouts in CVACT01Y copybook for ACCOUNT-RECORD",
      "context": "Fields like ACCT-ID referenced extensively but definitions not in source",
      "suggestion": "Obtain and analyze CVACT01Y source"
    },
    {
      "question": "Details of CODATECN copybook fields and COBDATFT input/output formats for type '2'",
      "context": "Fields like CODATECN-INP-DATE used but not defined here",
      "suggestion": "Review CODATECN copybook and COBDATFT specs"
    },
    {
      "question": "Business intent of hardcoded values in ARRY-FILE (1005.00, 1525.00, -1025.00, -2500.00)",
      "context": "No conditional logic; likely demo/test data",
      "suggestion": "Consult CardDemo requirements documentation"
    }
  ]
}