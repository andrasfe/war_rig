{
  "header": {
    "program_id": "CBIMPORT",
    "file_name": "CBIMPORT.cbl",
    "file_type": "COBOL",
    "analyzed_by": "WAR_RIG",
    "analyzed_at": "2026-01-18T18:06:09.292860",
    "iteration_count": 2,
    "final_status": "VALHALLA"
  },
  "purpose": {
    "summary": "CBIMPORT reads an indexed sequential export file containing mixed customer, account, xref, transaction, and card records distinguished by record type. It maps fields to normalized sequential output files per type, logs unknown records to error file, tracks statistics, and abends on file I/O failures. Performs placeholder validation and displays import statistics upon completion.",
    "business_context": "Branch Migration Import: imports customer profiles from multi-record export, normalizes to separate files, intended for data integrity validation via checksums (placeholder), generates statistics and error reports.",
    "program_type": "BATCH",
    "citations": [
      5,
      8,
      9,
      10,
      11,
      28,
      29,
      30,
      31,
      32,
      165
    ]
  },
  "inputs": [
    {
      "name": "EXPORT-INPUT",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Indexed sequential file (ORGANIZATION INDEXED, ACCESS SEQUENTIAL) with 500-character records holding mixed types identified by EXPORT-REC-TYPE (C=Customer, A=Account, X=XREF, T=Transaction, D=Card).",
      "copybook": "CVEXPORT",
      "citation": [
        37,
        38,
        39,
        40,
        76,
        77,
        78,
        79,
        113,
        261
      ]
    }
  ],
  "outputs": [
    {
      "name": "CUSTOMER-OUTPUT",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Sequential file receiving normalized 500-character customer records after field mapping from export.",
      "copybook": "CVCUS01Y",
      "citation": [
        43,
        44,
        45,
        46,
        81,
        82,
        83,
        84,
        312
      ]
    },
    {
      "name": "ACCOUNT-OUTPUT",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Sequential file receiving normalized 300-character account records after field mapping from export.",
      "copybook": "CVACT01Y",
      "citation": [
        48,
        49,
        50,
        51,
        86,
        87,
        88,
        89,
        341
      ]
    },
    {
      "name": "XREF-OUTPUT",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Sequential file receiving normalized 50-character card xref records after field mapping from export.",
      "copybook": "CVACT03Y",
      "citation": [
        53,
        54,
        55,
        56,
        91,
        92,
        93,
        94,
        361
      ]
    },
    {
      "name": "TRANSACTION-OUTPUT",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Sequential file receiving normalized 350-character transaction records after field mapping from export.",
      "copybook": "CVTRA05Y",
      "citation": [
        58,
        59,
        60,
        61,
        96,
        97,
        98,
        99,
        391
      ]
    },
    {
      "name": "CARD-OUTPUT",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Sequential file receiving normalized 150-character card records after field mapping from export.",
      "copybook": "CVACT02Y",
      "citation": [
        63,
        64,
        65,
        66,
        101,
        102,
        103,
        104,
        414
      ]
    },
    {
      "name": "ERROR-OUTPUT",
      "io_type": "FILE_SEQUENTIAL",
      "description": "Sequential file receiving 132-character error records for unknown record types, including timestamp, type, sequence, and message.",
      "copybook": null,
      "citation": [
        68,
        69,
        70,
        71,
        106,
        107,
        108,
        109,
        439
      ]
    }
  ],
  "called_programs": [
    {
      "program_name": "CEE3ABD",
      "call_type": "STATIC_CALL",
      "purpose": "Invoked to abend program on critical file I/O errors.",
      "parameters": [],
      "citation": 484
    }
  ],
  "calling_context": {
    "called_by": [],
    "entry_points": [],
    "linkage_section": []
  },
  "business_rules": [
    {
      "rule_id": "BR001",
      "description": "Route records by EXPORT-REC-TYPE to specific processing: 'C'=Customer, 'A'=Account, 'X'=XREF, 'T'=Transaction, 'D'=Card, OTHER=Unknown.",
      "logic_summary": "EVALUATE on EXPORT-REC-TYPE with PERFORM to typed paragraphs.",
      "conditions": [
        "WHEN 'C'",
        "WHEN 'A'",
        "WHEN 'X'",
        "WHEN 'T'",
        "WHEN 'D'",
        "WHEN OTHER"
      ],
      "citation": [
        272,
        273,
        274,
        275,
        276,
        277,
        278,
        279,
        280,
        281,
        282,
        283,
        284
      ]
    },
    {
      "rule_id": "BR002",
      "description": "Abend on file open/read/write failures (status not '00', excluding EOF on read).",
      "logic_summary": "Post-OPEN/READ/WRITE checks via 88-level conditions trigger DISPLAY error and PERFORM 9999-ABEND-PROGRAM.",
      "conditions": [
        "IF NOT WS-*-OK",
        "IF NOT WS-EXPORT-OK AND NOT WS-EXPORT-EOF"
      ],
      "citation": [
        199,
        206,
        213,
        220,
        227,
        234,
        241,
        263,
        314,
        343,
        363,
        393,
        416
      ]
    },
    {
      "rule_id": "BR003",
      "description": "Log unknown record types to ERROR-OUTPUT with current date timestamp, record type, sequence number, and fixed message.",
      "logic_summary": "Increment unknown count, populate/move to WS-ERROR-RECORD, perform WRITE.",
      "conditions": [
        "WHEN OTHER"
      ],
      "citation": [
        427,
        429,
        430,
        431,
        432,
        434,
        439
      ]
    },
    {
      "rule_id": "BR004",
      "description": "Accumulate statistics counters for total reads and records imported per type (customer, account, xref, transaction, card, errors, unknowns).",
      "logic_summary": "ADD 1 TO WS-TOTAL-RECORDS-READ on each loop iteration; ADD 1 TO type-specific counters after successful WRITE.",
      "conditions": [
        "ADD 1 TO WS-TOTAL-RECORDS-READ",
        "ADD 1 TO WS-*-RECORDS-IMPORTED"
      ],
      "citation": [
        252,
        320,
        349,
        369,
        399,
        422,
        427,
        446
      ]
    },
    {
      "rule_id": "BR005",
      "description": "Placeholder import validation: displays fixed completion messages without checks.",
      "logic_summary": "DISPLAY messages indicating completion and no errors detected (no actual logic).",
      "conditions": [],
      "citation": [
        451,
        452
      ]
    }
  ],
  "data_flow": {
    "reads_from": [
      {
        "source": "EXPORT-INPUT",
        "fields_used": [
          "EXPORT-REC-TYPE",
          "EXPORT-SEQUENCE-NUM",
          "EXP-CUST-ID",
          "EXP-CUST-FIRST-NAME",
          "EXP-CUST-MIDDLE-NAME",
          "EXP-CUST-LAST-NAME",
          "EXP-CUST-ADDR-LINE",
          "EXP-CUST-ADDR-STATE-CD",
          "EXP-CUST-ADDR-COUNTRY-CD",
          "EXP-CUST-ADDR-ZIP",
          "EXP-CUST-PHONE-NUM",
          "EXP-CUST-SSN",
          "EXP-CUST-GOVT-ISSUED-ID",
          "EXP-CUST-DOB-YYYY-MM-DD",
          "EXP-CUST-EFT-ACCOUNT-ID",
          "EXP-CUST-PRI-CARD-HOLDER-IND",
          "EXP-CUST-FICO-CREDIT-SCORE",
          "EXP-ACCT-ID",
          "EXP-ACCT-ACTIVE-STATUS",
          "EXP-ACCT-CURR-BAL",
          "EXP-ACCT-CREDIT-LIMIT",
          "EXP-ACCT-CASH-CREDIT-LIMIT",
          "EXP-ACCT-OPEN-DATE",
          "EXP-ACCT-EXPIRAION-DATE",
          "EXP-ACCT-REISSUE-DATE",
          "EXP-ACCT-CURR-CYC-CREDIT",
          "EXP-ACCT-CURR-CYC-DEBIT",
          "EXP-ACCT-ADDR-ZIP",
          "EXP-ACCT-GROUP-ID",
          "EXP-XREF-CARD-NUM",
          "EXP-XREF-CUST-ID",
          "EXP-XREF-ACCT-ID",
          "EXP-TRAN-ID",
          "EXP-TRAN-TYPE-CD",
          "EXP-TRAN-CAT-CD",
          "EXP-TRAN-SOURCE",
          "EXP-TRAN-DESC",
          "EXP-TRAN-AMT",
          "EXP-TRAN-MERCHANT-ID",
          "EXP-TRAN-MERCHANT-NAME",
          "EXP-TRAN-MERCHANT-CITY",
          "EXP-TRAN-MERCHANT-ZIP",
          "EXP-TRAN-CARD-NUM",
          "EXP-TRAN-ORIG-TS",
          "EXP-TRAN-PROC-TS",
          "EXP-CARD-NUM",
          "EXP-CARD-ACCT-ID",
          "EXP-CARD-CVV-CD",
          "EXP-CARD-EMBOSSED-NAME",
          "EXP-CARD-EXPIRAION-DATE",
          "EXP-CARD-ACTIVE-STATUS"
        ],
        "citation": [
          261,
          272,
          293,
          328,
          357,
          377,
          407
        ]
      }
    ],
    "writes_to": [
      {
        "destination": "CUSTOMER-OUTPUT",
        "fields_written": [
          "CUST-ID",
          "CUST-FIRST-NAME",
          "CUST-MIDDLE-NAME",
          "CUST-LAST-NAME",
          "CUST-ADDR-LINE-1",
          "CUST-ADDR-LINE-2",
          "CUST-ADDR-LINE-3",
          "CUST-ADDR-STATE-CD",
          "CUST-ADDR-COUNTRY-CD",
          "CUST-ADDR-ZIP",
          "CUST-PHONE-NUM-1",
          "CUST-PHONE-NUM-2",
          "CUST-SSN",
          "CUST-GOVT-ISSUED-ID",
          "CUST-DOB-YYYY-MM-DD",
          "CUST-EFT-ACCOUNT-ID",
          "CUST-PRI-CARD-HOLDER-IND",
          "CUST-FICO-CREDIT-SCORE"
        ],
        "citation": [
          312
        ]
      },
      {
        "destination": "ACCOUNT-OUTPUT",
        "fields_written": [
          "ACCT-ID",
          "ACCT-ACTIVE-STATUS",
          "ACCT-CURR-BAL",
          "ACCT-CREDIT-LIMIT",
          "ACCT-CASH-CREDIT-LIMIT",
          "ACCT-OPEN-DATE",
          "ACCT-EXPIRAION-DATE",
          "ACCT-REISSUE-DATE",
          "ACCT-CURR-CYC-CREDIT",
          "ACCT-CURR-CYC-DEBIT",
          "ACCT-ADDR-ZIP",
          "ACCT-GROUP-ID"
        ],
        "citation": [
          341
        ]
      },
      {
        "destination": "XREF-OUTPUT",
        "fields_written": [
          "XREF-CARD-NUM",
          "XREF-CUST-ID",
          "XREF-ACCT-ID"
        ],
        "citation": [
          361
        ]
      },
      {
        "destination": "TRANSACTION-OUTPUT",
        "fields_written": [
          "TRAN-ID",
          "TRAN-TYPE-CD",
          "TRAN-CAT-CD",
          "TRAN-SOURCE",
          "TRAN-DESC",
          "TRAN-AMT",
          "TRAN-MERCHANT-ID",
          "TRAN-MERCHANT-NAME",
          "TRAN-MERCHANT-CITY",
          "TRAN-MERCHANT-ZIP",
          "TRAN-CARD-NUM",
          "TRAN-ORIG-TS",
          "TRAN-PROC-TS"
        ],
        "citation": [
          391
        ]
      },
      {
        "destination": "CARD-OUTPUT",
        "fields_written": [
          "CARD-NUM",
          "CARD-ACCT-ID",
          "CARD-CVV-CD",
          "CARD-EMBOSSED-NAME",
          "CARD-EXPIRAION-DATE",
          "CARD-ACTIVE-STATUS"
        ],
        "citation": [
          414
        ]
      },
      {
        "destination": "ERROR-OUTPUT",
        "fields_written": [
          "ERR-TIMESTAMP",
          "ERR-RECORD-TYPE",
          "ERR-SEQUENCE",
          "ERR-MESSAGE"
        ],
        "citation": [
          439
        ]
      }
    ],
    "transforms": [
      {
        "input_field": "EXP-CUST-ID",
        "output_field": "CUST-ID",
        "transformation_description": "Direct MOVE after INITIALIZE CUSTOMER-RECORD.",
        "citation": [
          290,
          293
        ]
      },
      {
        "input_field": "EXP-ACCT-ID",
        "output_field": "ACCT-ID",
        "transformation_description": "Direct MOVE after INITIALIZE ACCOUNT-RECORD.",
        "citation": [
          325,
          328
        ]
      },
      {
        "input_field": "EXP-XREF-CARD-NUM",
        "output_field": "XREF-CARD-NUM",
        "transformation_description": "Direct MOVE after INITIALIZE CARD-XREF-RECORD.",
        "citation": [
          354,
          357
        ]
      },
      {
        "input_field": "EXP-TRAN-ID",
        "output_field": "TRAN-ID",
        "transformation_description": "Direct MOVE after INITIALIZE TRAN-RECORD.",
        "citation": [
          374,
          377
        ]
      },
      {
        "input_field": "EXP-CARD-NUM",
        "output_field": "CARD-NUM",
        "transformation_description": "Direct MOVE after INITIALIZE CARD-RECORD.",
        "citation": [
          404,
          407
        ]
      },
      {
        "input_field": "EXPORT-REC-TYPE",
        "output_field": "ERR-RECORD-TYPE",
        "transformation_description": "Direct MOVE to error record for unknown types; ERR-TIMESTAMP from FUNCTION CURRENT-DATE.",
        "citation": [
          429,
          430
        ]
      }
    ]
  },
  "copybooks_used": [
    {
      "copybook_name": "CVCUS01Y",
      "purpose": "Defines CUSTOMER-RECORD structure for customer output file.",
      "location": "FILE_SECTION",
      "citation": 84
    },
    {
      "copybook_name": "CVACT01Y",
      "purpose": "Defines ACCOUNT-RECORD structure for account output file.",
      "location": "FILE_SECTION",
      "citation": 89
    },
    {
      "copybook_name": "CVACT03Y",
      "purpose": "Defines CARD-XREF-RECORD structure for xref output file.",
      "location": "FILE_SECTION",
      "citation": 94
    },
    {
      "copybook_name": "CVTRA05Y",
      "purpose": "Defines TRAN-RECORD structure for transaction output file.",
      "location": "FILE_SECTION",
      "citation": 99
    },
    {
      "copybook_name": "CVACT02Y",
      "purpose": "Defines CARD-RECORD structure for card output file.",
      "location": "FILE_SECTION",
      "citation": 104
    },
    {
      "copybook_name": "CVEXPORT",
      "purpose": "Defines EXPORT-RECORD structure mapped from EXPORT-INPUT-RECORD for input processing.",
      "location": "WORKING_STORAGE",
      "citation": 113
    }
  ],
  "paragraphs": [
    {
      "paragraph_name": "0000-MAIN-PROCESSING",
      "purpose": "Orchestrates overall flow: initialize, process export, validate, finalize.",
      "called_by": [],
      "calls": [
        "1000-INITIALIZE",
        "2000-PROCESS-EXPORT-FILE",
        "3000-VALIDATE-IMPORT",
        "4000-FINALIZE"
      ],
      "citation": [
        165,
        173
      ]
    },
    {
      "paragraph_name": "1000-INITIALIZE",
      "purpose": "Formats and sets WS-IMPORT-DATE/TIME from CURRENT-DATE, displays start message, opens files.",
      "called_by": [
        "0000-MAIN-PROCESSING"
      ],
      "calls": [
        "1100-OPEN-FILES"
      ],
      "citation": [
        174,
        195
      ]
    },
    {
      "paragraph_name": "1100-OPEN-FILES",
      "purpose": "Opens all files (INPUT EXPORT-INPUT, OUTPUT others), abends on any failure.",
      "called_by": [
        "1000-INITIALIZE"
      ],
      "calls": [
        "9999-ABEND-PROGRAM"
      ],
      "citation": [
        196,
        245
      ]
    },
    {
      "paragraph_name": "2000-PROCESS-EXPORT-FILE",
      "purpose": "Main processing loop: read until EOF, increment total read count, process by type.",
      "called_by": [
        "0000-MAIN-PROCESSING"
      ],
      "calls": [
        "2100-READ-EXPORT-RECORD",
        "2200-PROCESS-RECORD-BY-TYPE"
      ],
      "citation": [
        248,
        256
      ]
    },
    {
      "paragraph_name": "2100-READ-EXPORT-RECORD",
      "purpose": "READs EXPORT-INPUT INTO EXPORT-RECORD, abends on non-EOF failure.",
      "called_by": [
        "2000-PROCESS-EXPORT-FILE"
      ],
      "calls": [
        "9999-ABEND-PROGRAM"
      ],
      "citation": [
        259,
        267
      ]
    },
    {
      "paragraph_name": "2200-PROCESS-RECORD-BY-TYPE",
      "purpose": "EVALUATEs EXPORT-REC-TYPE to dispatch to type-specific processing.",
      "called_by": [
        "2000-PROCESS-EXPORT-FILE"
      ],
      "calls": [
        "2300-PROCESS-CUSTOMER-RECORD",
        "2400-PROCESS-ACCOUNT-RECORD",
        "2500-PROCESS-XREF-RECORD",
        "2600-PROCESS-TRAN-RECORD",
        "2650-PROCESS-CARD-RECORD",
        "2700-PROCESS-UNKNOWN-RECORD"
      ],
      "citation": [
        270,
        285
      ]
    },
    {
      "paragraph_name": "2300-PROCESS-CUSTOMER-RECORD",
      "purpose": "INITIALIZEs and MOVE fields from EXP-CUST-* to CUSTOMER-RECORD, WRITEs, increments counter, abends on failure.",
      "called_by": [
        "2200-PROCESS-RECORD-BY-TYPE"
      ],
      "calls": [
        "9999-ABEND-PROGRAM"
      ],
      "citation": [
        288,
        322
      ]
    },
    {
      "paragraph_name": "2400-PROCESS-ACCOUNT-RECORD",
      "purpose": "INITIALIZEs and MOVE fields from EXP-ACCT-* to ACCOUNT-RECORD, WRITEs, increments counter, abends on failure.",
      "called_by": [
        "2200-PROCESS-RECORD-BY-TYPE"
      ],
      "calls": [
        "9999-ABEND-PROGRAM"
      ],
      "citation": [
        323,
        351
      ]
    },
    {
      "paragraph_name": "2500-PROCESS-XREF-RECORD",
      "purpose": "INITIALIZEs and MOVE EXP-XREF-* to CARD-XREF-RECORD, WRITEs, increments counter, abends on failure.",
      "called_by": [
        "2200-PROCESS-RECORD-BY-TYPE"
      ],
      "calls": [
        "9999-ABEND-PROGRAM"
      ],
      "citation": [
        352,
        371
      ]
    },
    {
      "paragraph_name": "2600-PROCESS-TRAN-RECORD",
      "purpose": "INITIALIZEs and MOVE EXP-TRAN-* to TRAN-RECORD, WRITEs, increments counter, abends on failure.",
      "called_by": [
        "2200-PROCESS-RECORD-BY-TYPE"
      ],
      "calls": [
        "9999-ABEND-PROGRAM"
      ],
      "citation": [
        372,
        401
      ]
    },
    {
      "paragraph_name": "2650-PROCESS-CARD-RECORD",
      "purpose": "INITIALIZEs and MOVE EXP-CARD-* to CARD-RECORD, WRITEs, increments counter, abends on failure.",
      "called_by": [
        "2200-PROCESS-RECORD-BY-TYPE"
      ],
      "calls": [
        "9999-ABEND-PROGRAM"
      ],
      "citation": [
        402,
        424
      ]
    },
    {
      "paragraph_name": "2700-PROCESS-UNKNOWN-RECORD",
      "purpose": "Increments unknown count, populates error record, performs write error.",
      "called_by": [
        "2200-PROCESS-RECORD-BY-TYPE"
      ],
      "calls": [
        "2750-WRITE-ERROR"
      ],
      "citation": [
        425,
        436
      ]
    },
    {
      "paragraph_name": "2750-WRITE-ERROR",
      "purpose": "WRITEs ERROR-OUTPUT-RECORD FROM WS-ERROR-RECORD, increments error count, displays status if fail but continues.",
      "called_by": [
        "2700-PROCESS-UNKNOWN-RECORD"
      ],
      "calls": [],
      "citation": [
        437,
        448
      ]
    },
    {
      "paragraph_name": "3000-VALIDATE-IMPORT",
      "purpose": "Placeholder: displays import validation completion messages.",
      "called_by": [
        "0000-MAIN-PROCESSING"
      ],
      "calls": [],
      "citation": [
        449,
        454
      ]
    },
    {
      "paragraph_name": "4000-FINALIZE",
      "purpose": "CLOSEs all files, displays all import statistics.",
      "called_by": [
        "0000-MAIN-PROCESSING"
      ],
      "calls": [],
      "citation": [
        455,
        478
      ]
    },
    {
      "paragraph_name": "9999-ABEND-PROGRAM",
      "purpose": "Displays abend message and CALLs CEE3ABD.",
      "called_by": [
        "1100-OPEN-FILES",
        "2100-READ-EXPORT-RECORD",
        "2300-PROCESS-CUSTOMER-RECORD",
        "2400-PROCESS-ACCOUNT-RECORD",
        "2500-PROCESS-XREF-RECORD",
        "2600-PROCESS-TRAN-RECORD",
        "2650-PROCESS-CARD-RECORD"
      ],
      "calls": [],
      "citation": [
        481,
        484
      ]
    }
  ],
  "error_handling": [
    {
      "condition": "OPEN fails for any file (NOT WS-*-OK)",
      "action": "DISPLAY file-specific error message with status, PERFORM 9999-ABEND-PROGRAM",
      "citation": [
        199,
        206,
        213,
        220,
        227,
        234,
        241
      ]
    },
    {
      "condition": "READ EXPORT-INPUT fails (NOT WS-EXPORT-OK AND NOT WS-EXPORT-EOF)",
      "action": "DISPLAY error message with status, PERFORM 9999-ABEND-PROGRAM",
      "citation": [
        263
      ]
    },
    {
      "condition": "WRITE fails for CUSTOMER/ACCOUNT/XREF/TRANSACTION/CARD-OUTPUT (NOT WS-*-OK)",
      "action": "DISPLAY file-specific error message with status, PERFORM 9999-ABEND-PROGRAM",
      "citation": [
        314,
        343,
        363,
        393,
        416
      ]
    },
    {
      "condition": "WRITE ERROR-OUTPUT fails (NOT WS-ERROR-OK)",
      "action": "DISPLAY error message with status, but continue processing (no abend)",
      "citation": [
        441
      ]
    }
  ],
  "sql_operations": [],
  "cics_operations": [],
  "open_questions": [
    {
      "question": "Precise field definitions and layouts in copybooks (CVCUS01Y, CVACT01Y, etc., CVEXPORT)",
      "context": "Referenced but source contents unavailable; fields inferred solely from MOVE statements.",
      "suggestion": "Obtain and analyze copybook source files."
    }
  ]
}