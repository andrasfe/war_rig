[
  {
    "caller": "MAIN-PARA",
    "callee": "RETURN-TO-PREV-SCREEN",
    "inputs": [
      "WS-CICS-TRANID",
      "WS-PGM-AUTH-DTL",
      "CDEMO-TO-PROGRAM"
    ],
    "outputs": [
      "CDEMO-FROM-TRANID",
      "CDEMO-FROM-PROGRAM",
      "CDEMO-PGM-CONTEXT",
      "CDEMO-PGM-ENTER"
    ],
    "purpose": "Returns control to the previous screen by XCTL'ing to the program specified in CDEMO-TO-PROGRAM with updated context and return information."
  },
  {
    "caller": "MAIN-PARA",
    "callee": "PROCESS-ENTER-KEY",
    "inputs": [
      "CDEMO-ACCT-ID",
      "CDEMO-CPVD-PAU-SELECTED"
    ],
    "outputs": [
      "WS-ACCT-ID",
      "WS-AUTH-KEY",
      "ERR-FLG",
      "COPAU1AO"
    ],
    "purpose": "Processes the ENTER key by validating input account and authorization key, reading the authorization record, and populating details if input is valid."
  },
  {
    "caller": "MAIN-PARA",
    "callee": "SEND-AUTHVIEW-SCREEN",
    "inputs": [
      "WS-MESSAGE",
      "SEND-ERASE-YES",
      "COPAU1AO"
    ],
    "outputs": [],
    "purpose": "Sends the COPAU1A map to the terminal, optionally erasing the screen, based on the message and erase flag settings."
  },
  {
    "caller": "MAIN-PARA",
    "callee": "RECEIVE-AUTHVIEW-SCREEN",
    "inputs": [],
    "outputs": [],
    "purpose": "Receives the COPAU1A map input from the terminal into the COPAU1AI structure without handling exceptions."
  },
  {
    "caller": "MAIN-PARA",
    "callee": "PROCESS-ENTER-KEY",
    "inputs": [
      "CDEMO-ACCT-ID",
      "CDEMO-CPVD-PAU-SELECTED"
    ],
    "outputs": [
      "WS-ACCT-ID",
      "WS-AUTH-KEY",
      "ERR-FLG",
      "COPAU1AO"
    ],
    "purpose": "Processes the ENTER key by validating input account and authorization key, reading the authorization record, and populating details if input is valid."
  },
  {
    "caller": "MAIN-PARA",
    "callee": "SEND-AUTHVIEW-SCREEN",
    "inputs": [
      "WS-MESSAGE",
      "SEND-ERASE-YES"
    ],
    "outputs": [],
    "purpose": "Sends the authorization view screen with optional erase based on the flag, displaying the current message and populating header information."
  },
  {
    "caller": "MAIN-PARA",
    "callee": "RETURN-TO-PREV-SCREEN",
    "inputs": [
      "WS-CICS-TRANID",
      "WS-PGM-AUTH-DTL",
      "CDEMO-TO-PROGRAM"
    ],
    "outputs": [
      "CDEMO-FROM-TRANID",
      "CDEMO-FROM-PROGRAM",
      "CDEMO-PGM-ENTER",
      "CDEMO-PGM-CONTEXT"
    ],
    "purpose": "Sets return context and XCTLs to the previous program specified in the communication area."
  },
  {
    "caller": "MAIN-PARA",
    "callee": "MARK-AUTH-FRAUD",
    "inputs": [
      "CDEMO-ACCT-ID",
      "CDEMO-CPVD-PAU-SELECTED",
      "CDEMO-CUST-ID"
    ],
    "outputs": [
      "WS-ACCT-ID",
      "WS-AUTH-KEY",
      "WS-FRAUD-AUTH-RECORD",
      "WS-FRD-ACCT-ID",
      "WS-FRD-CUST-ID",
      "WS-MESSAGE",
      "PA-FRAUD-CONFIRMED",
      "PA-FRAUD-REMOVED",
      "WS-REMOVE-FRAUD",
      "WS-REPORT-FRAUD",
      "WS-FRD-UPDT-SUCCESS",
      "WS-FRD-ACT-MSG"
    ],
    "purpose": "Marks the selected authorization as fraud or removes fraud flag by updating the record and linking to the fraud processing program."
  },
  {
    "caller": "MAIN-PARA",
    "callee": "SEND-AUTHVIEW-SCREEN",
    "inputs": [
      "WS-MESSAGE",
      "SEND-ERASE-YES"
    ],
    "outputs": [],
    "purpose": "Sends the authorization view screen with optional erase based on the flag, displaying the current message and populating header information."
  },
  {
    "caller": "MAIN-PARA",
    "callee": "PROCESS-PF8-KEY",
    "inputs": [
      "CDEMO-ACCT-ID",
      "CDEMO-CPVD-PAU-SELECTED"
    ],
    "outputs": [
      "WS-ACCT-ID",
      "WS-AUTH-KEY",
      "SEND-ERASE-NO",
      "WS-MESSAGE",
      "CDEMO-CPVD-PAU-SELECTED"
    ],
    "purpose": "Processes the PF8 key to navigate to the next authorization record for the account and updates screen data accordingly."
  },
  {
    "caller": "MAIN-PARA",
    "callee": "SEND-AUTHVIEW-SCREEN",
    "inputs": [
      "WS-MESSAGE",
      "SEND-ERASE-YES"
    ],
    "outputs": [],
    "purpose": "Sends the authorization view screen to the user, optionally erasing the screen based on the SEND-ERASE-YES flag."
  },
  {
    "caller": "MAIN-PARA",
    "callee": "PROCESS-ENTER-KEY",
    "inputs": [
      "CDEMO-ACCT-ID",
      "CDEMO-CPVD-PAU-SELECTED"
    ],
    "outputs": [
      "WS-ACCT-ID",
      "WS-AUTH-KEY",
      "ERR-FLG-ON"
    ],
    "purpose": "Processes the ENTER key by validating input data, setting up authorization keys, and reading the corresponding authorization record."
  },
  {
    "caller": "MAIN-PARA",
    "callee": "SEND-AUTHVIEW-SCREEN",
    "inputs": [
      "WS-MESSAGE",
      "SEND-ERASE-YES"
    ],
    "outputs": [],
    "purpose": "Sends the authorization view screen to the user, optionally erasing the screen based on the SEND-ERASE-YES flag."
  },
  {
    "caller": "PROCESS-ENTER-KEY",
    "callee": "READ-AUTH-RECORD",
    "inputs": [
      "WS-ACCT-ID",
      "WS-AUTH-KEY"
    ],
    "outputs": [
      "AUTHS-EOF",
      "WS-ERR-FLG",
      "WS-MESSAGE",
      "AUTHS-NOT-EOF"
    ],
    "purpose": "Reads the pending authorization summary and detail records from IMS using account ID and authorization key as input."
  },
  {
    "caller": "PROCESS-ENTER-KEY",
    "callee": "TAKE-SYNCPOINT",
    "inputs": [],
    "outputs": [],
    "purpose": "Performs a CICS syncpoint to commit the current unit of work if the IMS PSB was scheduled."
  },
  {
    "caller": "PROCESS-ENTER-KEY",
    "callee": "POPULATE-AUTH-DETAILS",
    "inputs": [
      "ERR-FLG-ON",
      "PA-CARD-NUM",
      "PA-AUTH-ORIG-DATE",
      "PA-AUTH-ORIG-TIME",
      "PA-APPROVED-AMT",
      "PA-AUTH-RESP-CODE",
      "PA-AUTH-RESP-REASON",
      "PA-PROCESSING-CODE",
      "PA-POS-ENTRY-MODE",
      "PA-MESSAGE-SOURCE",
      "PA-MERCHANT-CATAGORY-CODE",
      "PA-CARD-EXPIRY-DATE",
      "PA-AUTH-TYPE",
      "PA-TRANSACTION-ID",
      "PA-MATCH-STATUS",
      "PA-FRAUD-CONFIRMED",
      "PA-FRAUD-REMOVED",
      "PA-AUTH-FRAUD",
      "PA-FRAUD-RPT-DATE",
      "PA-MERCHANT-NAME",
      "PA-MERCHANT-ID",
      "PA-MERCHANT-CITY",
      "PA-MERCHANT-STATE",
      "PA-MERCHANT-ZIP"
    ],
    "outputs": [
      "WS-AUTH-DATE",
      "WS-AUTH-TIME",
      "WS-AUTH-AMT",
      "CARDNUMO",
      "AUTHDTO",
      "AUTHTMO",
      "AUTHAMTO",
      "AUTHRSPO",
      "AUTHRSPC",
      "AUTHRSNO",
      "AUTHCDO",
      "POSEMDO",
      "AUTHSRCO",
      "MCCCDO",
      "CRDEXPO",
      "AUTHTYPO",
      "TRNIDO",
      "AUTHMTCO",
      "AUTHFRDO",
      "MERNAMEO",
      "MERIDO",
      "MERCITYO",
      "MERSTO",
      "MERZIPO"
    ],
    "purpose": "Populates the authorization details screen output fields using data from the PAUTDTL1 segment if no error flag is set."
  },
  {
    "caller": "MARK-AUTH-FRAUD",
    "callee": "READ-AUTH-RECORD",
    "inputs": [
      "WS-ACCT-ID",
      "WS-AUTH-KEY"
    ],
    "outputs": [
      "PA-ACCT-ID",
      "PA-AUTHORIZATION-KEY",
      "PENDING-AUTH-SUMMARY",
      "PENDING-AUTH-DETAILS",
      "IMS-RETURN-CODE",
      "AUTHS-EOF",
      "AUTHS-NOT-EOF"
    ],
    "purpose": "Reads the pending authorization summary and detail records from IMS using the account ID and authorization key."
  },
  {
    "caller": "MARK-AUTH-FRAUD",
    "callee": "UPDATE-AUTH-DETAILS",
    "inputs": [
      "WS-FRAUD-AUTH-RECORD",
      "PA-FRAUD-RPT-DATE",
      "PA-FRAUD-REMOVED"
    ],
    "outputs": [
      "PENDING-AUTH-DETAILS",
      "WS-MESSAGE"
    ],
    "purpose": "Updates the authorization details segment in IMS with fraud status changes and issues a syncpoint or rollback based on success."
  },
  {
    "caller": "MARK-AUTH-FRAUD",
    "callee": "ROLL-BACK",
    "inputs": [],
    "outputs": [],
    "purpose": "Performs a CICS rollback to undo database changes due to an error in fraud update processing."
  },
  {
    "caller": "MARK-AUTH-FRAUD",
    "callee": "ROLL-BACK",
    "inputs": [],
    "outputs": [],
    "purpose": "Performs a CICS rollback to undo database changes due to an error in fraud update processing."
  },
  {
    "caller": "MARK-AUTH-FRAUD",
    "callee": "POPULATE-AUTH-DETAILS",
    "inputs": [
      "PA-CARD-NUM",
      "PA-AUTH-ORIG-DATE",
      "PA-AUTH-ORIG-TIME",
      "PA-APPROVED-AMT",
      "PA-AUTH-RESP-CODE",
      "PA-AUTH-RESP-REASON",
      "PA-PROCESSING-CODE",
      "PA-POS-ENTRY-MODE",
      "PA-MESSAGE-SOURCE",
      "PA-MERCHANT-CATAGORY-CODE",
      "PA-CARD-EXPIRY-DATE",
      "PA-AUTH-TYPE",
      "PA-TRANSACTION-ID",
      "PA-MATCH-STATUS",
      "PA-FRAUD-CONFIRMED",
      "PA-FRAUD-REMOVED",
      "PA-AUTH-FRAUD",
      "PA-FRAUD-RPT-DATE",
      "PA-MERCHANT-NAME",
      "PA-MERCHANT-ID",
      "PA-MERCHANT-CITY",
      "PA-MERCHANT-STATE",
      "PA-MERCHANT-ZIP",
      "ERR-FLG"
    ],
    "outputs": [
      "WS-AUTH-DATE",
      "WS-AUTH-AMT",
      "WS-AUTH-TIME"
    ],
    "purpose": "Populates the authorization details screen fields using data from the PAUT segment and working storage, conditionally formatting output based on response code and fraud status."
  },
  {
    "caller": "PROCESS-PF8-KEY",
    "callee": "READ-AUTH-RECORD",
    "inputs": [
      "WS-ACCT-ID",
      "WS-AUTH-KEY"
    ],
    "outputs": [
      "PA-ACCT-ID",
      "PA-AUTHORIZATION-KEY",
      "PENDING-AUTH-SUMMARY",
      "PENDING-AUTH-DETAILS",
      "IMS-RETURN-CODE",
      "AUTHS-EOF",
      "AUTHS-NOT-EOF",
      "WS-ERR-FLG",
      "WS-MESSAGE"
    ],
    "purpose": "Reads the authorization summary and detail records from IMS using the account ID and authorization key, setting EOF and error flags accordingly."
  },
  {
    "caller": "PROCESS-PF8-KEY",
    "callee": "READ-NEXT-AUTH-RECORD",
    "inputs": [],
    "outputs": [
      "PENDING-AUTH-DETAILS",
      "IMS-RETURN-CODE",
      "AUTHS-EOF",
      "AUTHS-NOT-EOF",
      "WS-ERR-FLG",
      "WS-MESSAGE"
    ],
    "purpose": "Reads the next authorization detail record from IMS in sequence, updating EOF and error status based on the result."
  },
  {
    "caller": "PROCESS-PF8-KEY",
    "callee": "TAKE-SYNCPOINT",
    "inputs": [],
    "outputs": [],
    "purpose": "Issues a CICS SYNCPOINT to commit the current unit of work if an IMS PSB was scheduled."
  },
  {
    "caller": "PROCESS-PF8-KEY",
    "callee": "POPULATE-AUTH-DETAILS",
    "inputs": [
      "PA-CARD-NUM",
      "PA-AUTH-ORIG-DATE",
      "PA-AUTH-ORIG-TIME",
      "PA-APPROVED-AMT",
      "PA-AUTH-RESP-CODE",
      "PA-AUTH-RESP-REASON",
      "PA-PROCESSING-CODE",
      "PA-POS-ENTRY-MODE",
      "PA-MESSAGE-SOURCE",
      "PA-MERCHANT-CATAGORY-CODE",
      "PA-CARD-EXPIRY-DATE",
      "PA-AUTH-TYPE",
      "PA-TRANSACTION-ID",
      "PA-MATCH-STATUS",
      "PA-FRAUD-CONFIRMED",
      "PA-FRAUD-REMOVED",
      "PA-AUTH-FRAUD",
      "PA-FRAUD-RPT-DATE",
      "PA-MERCHANT-NAME",
      "PA-MERCHANT-ID",
      "PA-MERCHANT-CITY",
      "PA-MERCHANT-STATE",
      "PA-MERCHANT-ZIP",
      "ERR-FLG"
    ],
    "outputs": [
      "WS-AUTH-DATE",
      "WS-AUTH-AMT",
      "WS-AUTH-TIME"
    ],
    "purpose": "Populates the authorization details screen fields using data from the PAUT segment and working storage, conditionally formatting output based on response code and fraud status."
  },
  {
    "caller": "SEND-AUTHVIEW-SCREEN",
    "callee": "POPULATE-HEADER-INFO",
    "inputs": [
      "WS-CICS-TRANID",
      "WS-PGM-AUTH-DTL"
    ],
    "outputs": [],
    "purpose": "Populates the screen header with current date, time, transaction name, and program name for the authorization view."
  },
  {
    "caller": "READ-AUTH-RECORD",
    "callee": "SCHEDULE-PSB",
    "inputs": [
      "PSB-NAME"
    ],
    "outputs": [
      "IMS-RETURN-CODE",
      "WS-ERR-FLG",
      "WS-IMS-PSB-SCHD-FLG"
    ],
    "purpose": "Schedules the IMS PSB for database access and handles errors if scheduling fails."
  },
  {
    "caller": "READ-AUTH-RECORD",
    "callee": "SEND-AUTHVIEW-SCREEN",
    "inputs": [
      "WS-MESSAGE",
      "SEND-ERASE-YES"
    ],
    "outputs": [],
    "purpose": "Displays the authorization screen with error message and header information when a database read fails."
  },
  {
    "caller": "READ-AUTH-RECORD",
    "callee": "SEND-AUTHVIEW-SCREEN",
    "inputs": [
      "WS-MESSAGE",
      "SEND-ERASE-YES"
    ],
    "outputs": [],
    "purpose": "Displays the authorization screen with error message and header information when a database read fails."
  },
  {
    "caller": "READ-NEXT-AUTH-RECORD",
    "callee": "SEND-AUTHVIEW-SCREEN",
    "inputs": [
      "WS-MESSAGE",
      "SEND-ERASE-YES"
    ],
    "outputs": [],
    "purpose": "Displays the authorization screen with error message and header information when reading the next authorization record fails."
  },
  {
    "caller": "UPDATE-AUTH-DETAILS",
    "callee": "TAKE-SYNCPOINT",
    "inputs": [],
    "outputs": [],
    "purpose": "Commits the current transaction unit of work to ensure data integrity after successfully updating the fraud authorization details."
  },
  {
    "caller": "UPDATE-AUTH-DETAILS",
    "callee": "ROLL-BACK",
    "inputs": [],
    "outputs": [],
    "purpose": "Aborts the current transaction and rolls back all changes due to an error during the fraud tagging update operation."
  },
  {
    "caller": "UPDATE-AUTH-DETAILS",
    "callee": "SEND-AUTHVIEW-SCREEN",
    "inputs": [
      "WS-MESSAGE",
      "SEND-ERASE-YES"
    ],
    "outputs": [],
    "purpose": "Sends an error message to the terminal screen after a failure in fraud tagging, using the message stored in WS-MESSAGE and applying screen erase logic based on SEND-ERASE-YES."
  },
  {
    "caller": "SCHEDULE-PSB",
    "callee": "SEND-AUTHVIEW-SCREEN",
    "inputs": [
      "WS-MESSAGE",
      "SEND-ERASE-YES"
    ],
    "outputs": [],
    "purpose": "Displays an error message on the terminal when PSB scheduling fails, using the message in WS-MESSAGE and respecting the SEND-ERASE-YES flag for screen rendering."
  }
]